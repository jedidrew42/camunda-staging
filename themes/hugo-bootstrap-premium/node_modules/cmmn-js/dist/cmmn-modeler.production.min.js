/*! cmmn-js - cmmn-modeler v0.18.1 | Copyright (c) 2014-present, camunda Services GmbH | bpmn.io/license */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CmmnJS=e()}}(function(){var e={};function t(e,t){return function(e,t){return!(!e||"function"!=typeof e.$instanceOf||!e.$instanceOf(t))}(n(e),t)}function n(e){return e&&e.businessObject?e.businessObject:e}function i(e){return t(e=n(e),"cmmn:Stage")&&e.$parent&&t(e.$parent,"cmmn:Case")}function r(e){var i=n(e);return t(e,"cmmn:PlanItemDefinition")||t(e,"cmmn:CaseFileItemDefinition")?i:i&&i.definitionRef}function o(e){var t=r(e);return t&&t.defaultControl}function a(e){return(e=n(e))&&e.itemControl}function s(e,t){var n=a(e),i=o(e);return n&&n[t]?n[t]:i&&i[t]}function c(e){if(t(e=n(e),"cmmn:CaseFileItem"))return["addChild","addReference","create","delete","removeChild","removeReference","replace","update"];if(t(e,"cmmn:PlanItem")||t(e,"cmmn:DiscretionaryItem")){var o=r(e);return t(o,"cmmn:EventListener")||t(o,"cmmn:Milestone")?["create","occur","resume","suspend","terminate"]:["complete","create","disable","enable","exit","fault","manualStart","parentResume","parentSuspend","reactivate","reenable","resume","start","suspend","terminate"]}return i(e)?["close","complete","create","fault","reactivate","suspend","terminate"]:[]}e.is=t,e.getBusinessObject=n,e.isCasePlanModel=i,e.getDefinition=r,e.getDefaultControl=o,e.getItemControl=a,e.isRequired=function(e){return!!s(e,"requiredRule")},e.isRepeatable=function(e){return!!s(e,"repetitionRule")},e.isManualActivation=function(e){return!!s(e,"manualActivationRule")},e.isAutoComplete=function(e){var t=r(e=n(e));return e.autoComplete||t&&t.autoComplete},e.hasPlanningTable=function(e){return(e=n(e)).planningTable||r(e)&&r(e).planningTable},e.getName=function(e){t(e=n(e),"cmmndi:CMMNEdge")&&e.cmmnElementRef&&(e=e.cmmnElementRef);var i=e.name;return i||e.definitionRef&&(i=e.definitionRef.name),i},e.getSentry=function(e){var i=n(e);return t(i,"cmmn:Sentry")?i:i&&i.sentryRef},e.getStandardEvent=function(e){return(e=n(e)).cmmnElementRef&&e.cmmnElementRef.standardEvent},e.getStandardEvents=function(e){return t(e,"cmmndi:CMMNEdge")&&(e=n(e).cmmnElementRef),t(e,"cmmn:OnPart")?t(e.exitCriterionRef,"cmmn:ExitCriterion")?["exit"]:c(e.sourceRef):[]};var u={};u="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var l={};Object.defineProperty(l,"__esModule",{value:!0});var d=Object.prototype.toString,p=Object.prototype.hasOwnProperty;function f(e){return void 0===e}function h(e){return"[object Array]"===d.call(e)}function m(e){return"[object Object]"===d.call(e)}function y(e){var t=d.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t||"[object GeneratorFunction]"===t||"[object AsyncGeneratorFunction]"===t||"[object Proxy]"===t}function v(e){if(!h(e))throw new Error("must supply array")}function g(e,t){return p.call(e,t)}function _(e,t){var n;return t=T(t),x(e,function(e,i){if(t(e,i))return n=e,!1}),n}function x(e,t){var n;if(!f(e)){var i=h(e)?A:k;for(var r in e)if(g(e,r)&&!1===t(n=e[r],i(r)))return n}}function b(e,t,n){return x(e,function(e,i){n=t(n,e,i)}),n}function E(e,t){return b(e,function(e,n,i){return e&&t(n,i)},!0)}function w(e,t){var n=[];return x(e,function(e,i){n.push(t(e,i))}),n}function M(e){return e&&Object.keys(e)||[]}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=R(t),x(e,function(e){var i=t(e)||"_",r=n[i];r||(r=n[i]=[]),r.push(e)}),n}function C(e){e=R(e);for(var t={},n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return x(i,function(n){return S(n,e,t)}),w(t,function(e,t){return e[0]})}var P=C;function R(e){return y(e)?e:function(t){return t[e]}}function T(e){return y(e)?e:function(t){return t===e}}function k(e){return e}function A(e){return Number(e)}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}l.flatten=function(e){return Array.prototype.concat.apply([],e)},l.find=_,l.findIndex=function(e,t){t=T(t);var n=h(e)?-1:void 0;return x(e,function(e,i){if(t(e,i))return n=i,!1}),n},l.filter=function(e,t){var n=[];return x(e,function(e,i){t(e,i)&&n.push(e)}),n},l.forEach=x,l.without=function(e,t){return f(e)?[]:(v(e),t=T(t),e.filter(function(e,n){return!t(e,n)}))},l.reduce=b,l.every=E,l.some=function(e,t){return!!_(e,t)},l.map=w,l.keys=M,l.size=function(e){return M(e).length},l.values=function(e){return w(e,function(e){return e})},l.groupBy=S,l.uniqueBy=C,l.unionBy=P,l.sortBy=function(e,t){t=R(t);var n=[];return x(e,function(e,i){for(var r=t(e,i),o={d:r,v:e},a=0;a<n.length;a++)if(r<n[a].d)return void n.splice(a,0,o);n.push(o)}),w(n,function(e){return e.v})},l.matchPattern=function(e){return function(t){return E(e,function(e,n){return t[n]===e})}},l.debounce=function(e,t){var n,i,r,o;function a(){var a=Date.now(),c=o+t-a;if(c>0)return s(c);e.apply(r,i),n=o=i=r=void 0}function s(e){n=setTimeout(a,e)}return function(){o=Date.now();for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];i=a,r=this,n||s(t)}},l.bind=function(e,t){return e.bind(t)},l.isUndefined=f,l.isDefined=function(e){return void 0!==e},l.isArray=h,l.isObject=m,l.isNumber=function(e){return"[object Number]"===d.call(e)},l.isFunction=y,l.isString=function(e){return"[object String]"===d.call(e)},l.assign=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return O.apply(void 0,[e].concat(n))},l.pick=function(e,t){var n={},i=Object(e);return x(t,function(t){t in i&&(n[t]=e[t])}),n},l.omit=function(e,t){var n={};return x(Object(e),function(e,i){-1===t.indexOf(i)&&(n[i]=e)}),n};var j={};function N(e,t,n){var i=j.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:i}),i.length&&i.forEach(function(i){e.set(i,t.inverse,n)})}function I(e,t){if(!(this instanceof I))return new I(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}j.extend=function(e,t,n,i){var r=n.inverse;return Object.defineProperty(e,"remove",{value:function(e){var n=this.indexOf(e);return-1!==n&&(this.splice(n,1),t.unset(e,r,i)),e}}),Object.defineProperty(e,"contains",{value:function(e){return-1!==this.indexOf(e)}}),Object.defineProperty(e,"add",{value:function(e,n){var o=this.indexOf(e);if(void 0===n){if(-1!==o)return;n=this.length}-1!==o&&this.splice(o,1),this.splice(n,0,e),-1===o&&t.set(e,r,i)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e},j.isExtended=function(e){return!0===e.__refs_collection},I.prototype.bind=function(e,t){if("string"==typeof t){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?N(this,t,e):function(e,t,n){var i=t.inverse,r=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return r},set:function(t){if(t!==r){var o=r;r=null,o&&e.unset(o,i,n),r=t,e.set(r,i,n)}}})}(this,t,e)},I.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return j.isExtended(n)||N(this,t,e),n},I.prototype.ensureBound=function(e,t){(function(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)})(e,t)||this.bind(e,t)},I.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)},I.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var D={};(D=I).Collection=j;var B={};Object.defineProperty(B,"__esModule",{value:!0}),B.Base=G,B.Label=Y,B.create=function(e,t){var n=Z[e];if(!n)throw new Error("unknown type: <"+e+">");return(0,l.assign)(new n,t)};var L=F(u),z=F(D);function F(e){return e&&e.__esModule?e:{default:e}}var $=new z.default({name:"children",enumerable:!0,collection:!0},{name:"parent"}),H=new z.default({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),U=new z.default({name:"attachers",collection:!0},{name:"host"}),W=new z.default({name:"outgoing",collection:!0},{name:"source"}),V=new z.default({name:"incoming",collection:!0},{name:"target"});function G(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),$.bind(this,"parent"),H.bind(this,"labels"),W.bind(this,"outgoing"),V.bind(this,"incoming")}function q(){G.call(this),$.bind(this,"children"),U.bind(this,"host"),U.bind(this,"attachers")}function K(){q.call(this)}function Y(){q.call(this),H.bind(this,"labelTarget")}function X(){G.call(this),W.bind(this,"source"),V.bind(this,"target")}(0,L.default)(q,G),(0,L.default)(K,q),(0,L.default)(Y,q),(0,L.default)(X,G);var Z={connection:X,shape:q,label:Y,root:K};var Q={},J=l.some,ee=e.is,te=e.getBusinessObject;function ne(e,t){return e===t}function ie(e){return re(te(e),"cmmn:Case")}function re(e,t){for("string"==typeof t&&(t=[t]);e=e.$parent||e.parent;){if(!t)return e;if(oe(e,t))return e}return null}function oe(e,t){return J(t,function(t){return ee(e,t)})}Q.isSame=ne,Q.isSameCase=function(e,t){return ne(ie(e),ie(t))},Q.getCase=ie,Q.getParents=function(e,t){var n=[];for("string"==typeof t&&(t=[t]);e;)(e=e.$parent||e.parent)&&(t?oe(e,t)&&n.push(e):n.push(e));return n},Q.getParent=re,Q.isAny=oe,Q.isLabel=function(e){return e instanceof B.Label};var ae=e.getDefinition,se=e.getSentry,ce=Q.isAny,ue=l.forEach,le=l.isArray;function de(e,t){this._items={},this._referencedBy={},this._elementRegistry=e,this._eventBus=t,this._init()}de.$inject=["elementRegistry","eventBus"];var pe=de;function fe(e){return ae(e)||se(e)}function he(e){return ce(e,["cmmn:PlanItemDefinition","cmmn:Sentry","cmmn:CaseFileItemDefinition"])}de.prototype._init=function(e){var t=this._eventBus;t.on("diagram.destroy",500,this._clear,this),t.on("diagram.clear",500,this._clear,this)},de.prototype._clear=function(){this._items={},this._referencedBy={}},de.prototype.add=function(e){var t=this._items,n=e.id,i=this._referencedBy,r=fe(e),o=r&&r.id;t[n]=e,r&&(i[o]=i[o]||[],-1===i[o].indexOf(e)&&i[o].push(e))},de.prototype.remove=function(e){var t=this._items,n=e.id,i=this._referencedBy,r=fe(e),o=r&&r.id;if(delete t[n],r){var a=i[o]||[],s=a.indexOf(e);-1!==s&&a.splice(s,1),a.length||delete i[o]}},de.prototype.updateId=function(e,t){var n,i;"string"==typeof e&&(e=this.get(e)),n=he(e)?this._referencedBy:this._items,e&&(i=n[e.id],delete n[e.id],n[t]=i)},de.prototype.updateReference=function(e,t){var n=this._referencedBy,i=fe(e),r=i&&i.id;if(i){var o=n[r]||[],a=o.indexOf(e);-1!==a&&o.splice(a,1),o.length||delete n[r]}if(t){var s=t.id;s&&(n[s]=n[s]||[],-1===n[s].indexOf(e)&&n[s].push(e))}},de.prototype.get=function(e){return this._items[e]},de.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t},de.prototype.getAll=function(){return this.filter(function(e){return e})},de.prototype.forEach=function(e){var t=this._items;ue(t,function(t){return e(t,fe(t))})},de.prototype.getReferences=function(e){var t=e.id||e;return(this._referencedBy[t]||[]).slice()},de.prototype.getShape=function(e){var t=e.id||e;return this._elementRegistry&&this._elementRegistry.get(t)},de.prototype.getShapes=function(e){var t=[],n=this;function i(e){e&&t.push(e)}if(le(e))ue(e,function(e){i(n.getShape(e))});else if(he(e)){var r=n.getReferences(e);ue(r,function(e){i(n.getShape(e))})}else i(n.getShape(e));return t};var me={},ye=e.is,ve=e.getBusinessObject,ge=e.isCasePlanModel;me.isCollapsed=function(e){if(!ge(e)){var t=(e=ve(e)).definitionRef;if(ye(t,"cmmn:PlanFragment"))return!!(e&&e.di&&e.di.isCollapsed)}return!1},me.isPlanningTableCollapsed=function(e){return e=ve(e),!!(ye(e,"cmmn:Stage")||e.definitionRef&&(ye(e.definitionRef,"cmmn:Stage")||ye(e.definitionRef,"cmmn:HumanTask")))&&(e.di&&e.di.isPlanningTableCollapsed)},me.isStandardEventVisible=function(e){var t=(e=ve(e)).cmmnElementRef;return!(!ye(t,"cmmn:OnPart")||!e.isStandardEventVisible)};var _e={};Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=be;var xe=1e3;function be(e,t){var n=this;t=t||xe,e.on(["render.shape","render.connection"],t,function(e,t){var i=e.type,r=t.element,o=t.gfx;if(n.canRender(r))return"render.shape"===i?n.drawShape(o,r):n.drawConnection(o,r)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(e,t){if(n.canRender(t))return"render.getShapePath"===e.type?n.getShapePath(t):n.getConnectionPath(t)})}be.prototype.canRender=function(){},be.prototype.drawShape=function(){},be.prototype.drawConnection=function(){},be.prototype.getShapePath=function(){},be.prototype.getConnectionPath=function(){};var Ee={};function we(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(e){}return e}function Me(e,t){return t.appendChild(we(e,t))}Object.defineProperty(Ee,"__esModule",{value:!0});var Se=2,Ce={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":Se,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":Se,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function Pe(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=Ce[i];r?(r===Se&&"number"==typeof n&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function Re(e,t,n){if("string"==typeof t){if(void 0===n)return function(e,t){return Ce[t]?e.style[t]:e.getAttributeNS(null,t)}(e,t);Pe(e,t,n)}else!function(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)Pe(e,i,t[i])}(e,t);return e}function Te(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var ke=/\s+/,Ae=Object.prototype.toString;function Oe(e){return void 0!==e}function je(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function Ne(e){var t=e.parentNode;return t&&t.removeChild(e),e}function Ie(e){for(var t;t=e.firstChild;)Ne(t);return e}je.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~Te(t,e)||t.push(e),Oe(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this},je.prototype.remove=function(e){if("[object RegExp]"===Ae.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=Te(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this},je.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},je.prototype.toggle=function(e,t){return this.list?(Oe(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(Oe(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},je.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(ke);return""===e[0]&&e.shift(),e},je.prototype.has=je.prototype.contains=function(e){return this.list?this.list.contains(e):!!~Te(this.array(),e)};var De={svg:"http://www.w3.org/2000/svg"},Be='<svg xmlns="'+De.svg+'"';function Le(e){var t=!1;"<svg"===e.substring(0,4)?-1===e.indexOf(De.svg)&&(e=Be+e.substring(4)):(e=Be+">"+e+"</svg>",t=!0);var n=function(e){var t;return(t=new DOMParser).async=!1,t.parseFromString(e,"text/xml")}(e);if(!t)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function ze(e,t){var n;return"<"===e.charAt(0)?(n=Le(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(De.svg,e),t&&Re(n,t),n}var Fe=ze("svg");function $e(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)e[i]=t[i];return e}var He=/([&<>]{1})/g,Ue=/([\n\r"]{1})/g,We={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Ve(e,t){return e.replace(t,function(e,t){return We[t]||t})}function Ge(e,t){var n,i,r,o,a;switch(e.nodeType){case 3:t.push(Ve(e.textContent,He));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(n=0,i=(r=e.attributes).length;n<i;++n)o=r.item(n),t.push(" ",o.name,'="',Ve(o.value,Ue),'"');if(e.hasChildNodes()){for(t.push(">"),n=0,i=(a=e.childNodes).length;n<i;++n)Ge(a.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("\x3c!--",Ve(e.nodeValue,He),"--\x3e");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function qe(e,t){var n=Le(t);if(Ie(e),t){"#document-fragment"!==n.nodeName&&(n=n.documentElement);for(var i,r=(i=n.childNodes,Array.prototype.slice.call(i)),o=0;o<r.length;o++)Me(r[o],e)}}function Ke(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}Ee.append=function(e,t){return Me(t,e),e},Ee.attr=Re,Ee.classes=function(e){return new je(e)},Ee.clear=Ie,Ee.clone=function(e){return e.cloneNode(!0)},Ee.create=ze,Ee.innerSVG=function(e,t){if(void 0!==t){try{qe(e,t)}catch(e){throw new Error("error parsing SVG: "+e.message)}return e}return function(e){for(var t=e.firstChild,n=[];t;)Ge(t,n),t=t.nextSibling;return n.join("")}(e)},Ee.remove=Ne,Ee.transform=function(e,t){var n=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),function(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(Ke(e,i))}(n,t)),n.consolidate()},Ee.createMatrix=function(e,t,n,i,r,o){var a=Fe.createSVGMatrix();switch(arguments.length){case 0:return a;case 1:return $e(a,e);case 6:return $e(a,{a:e,b:t,c:n,d:i,e:r,f:o})}},Ee.createTransform=function(e){return e?Fe.createSVGTransformFromMatrix(e):Fe.createSVGTransform()};var Ye={};function Xe(e){for(var t,n="",i=0;t=e[i];i++)n+=t.x+","+t.y+" ";return n}Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.componentsToPath=function(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")},Ye.createLine=function(e,t){var n=(0,Ee.create)("polyline");(0,Ee.attr)(n,{points:Xe(e)}),t&&(0,Ee.attr)(n,t);return n},Ye.updateLine=function(e,t){return(0,Ee.attr)(e,{points:Xe(t)}),e};var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.transform=function(e,t,n,i,r){var o=(0,Ee.createTransform)();o.setTranslate(t,n);var a=(0,Ee.createTransform)();a.setRotate(i,0,0);var s=(0,Ee.createTransform)();s.setScale(r||1,r||1),(0,Ee.transform)(e,[o,a,s])},Ze.translate=function(e,t,n){var i=(0,Ee.createTransform)();i.setTranslate(t,n),(0,Ee.transform)(e,i)},Ze.rotate=function(e,t){var n=(0,Ee.createTransform)();n.setRotate(t,0,0),(0,Ee.transform)(e,n)};var Qe={};Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=ot;var Je=0,et={width:150,height:50};function tt(e,t){var n;t.textContent=e;try{var i,r=""===e;return t.textContent=r?"dummy":e,i={width:(n=t.getBBox()).width+2*n.x,height:n.height},r&&(i.width=0),i}catch(e){return{width:0,height:0}}}function nt(e,t,n){for(var i,r=e.shift(),o=r;;){if((i=tt(o,n)).width=o?i.width:0," "===o||""===o||i.width<Math.round(t)||o.length<2)return it(e,o,r,i);o=rt(o,i.width,t)}}function it(e,t,n,i){if(t.length<n.length){var r=n.slice(t.length).trim();e.unshift(r)}return{width:i.width,height:i.height,text:t}}function rt(e,t,n){var i=Math.max(e.length*(n/t),1),r=function(e,t){var n,i=e.split(/(\s|-)/g),r=[],o=0;if(i.length>1)for(;n=i.shift();){if(!(n.length+o<t)){"-"===n&&r.pop();break}r.push(n),o+=n.length}return r.join("")}(e,i);return r||(r=e.slice(0,Math.max(Math.round(i-1),1))),r}function ot(e){this._config=(0,l.assign)({},{size:et,padding:Je,style:{},align:"center-top"},e||{})}ot.prototype.createText=function(e,t){return this.layoutText(e,t).element},ot.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},ot.prototype.layoutText=function(e,t){var n=(0,l.assign)({},this._config.size,t.box),i=(0,l.assign)({},this._config.style,t.style),r=function(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}(t.align||this._config.align),o=function(e){return(0,l.isObject)(e)?(0,l.assign)({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}(void 0!==t.padding?t.padding:this._config.padding),a=t.fitBox||!1,s=function(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}(i),c=e.split(/\r?\n/g),u=[],d=n.width-o.left-o.right,p=(0,Ee.create)("text");(0,Ee.attr)(p,{x:0,y:0}),(0,Ee.attr)(p,i);var f=function(){var e=document.getElementById("helper-svg");return e||(e=(0,Ee.create)("svg"),(0,Ee.attr)(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}();for((0,Ee.append)(f,p);c.length;)u.push(nt(c,d,p));"middle"===r.vertical&&(o.top=o.bottom=0);var h=(0,l.reduce)(u,function(e,t,n){return e+(s||t.height)},0)+o.top+o.bottom,m=(0,l.reduce)(u,function(e,t,n){return t.width>e?t.width:e},0),y=o.top;"middle"===r.vertical&&(y+=(n.height-h)/2),y-=(s||u[0].height)/4;var v=(0,Ee.create)("text");return(0,Ee.attr)(v,i),(0,l.forEach)(u,function(e){var t;switch(y+=s||e.height,r.horizontal){case"left":t=o.left;break;case"right":t=(a?m:d)-o.right-e.width;break;default:t=Math.max(((a?m:d)-e.width)/2+o.left,0)}var n=(0,Ee.create)("tspan");(0,Ee.attr)(n,{x:t,y:y}),n.textContent=e.text,(0,Ee.append)(v,n)}),(0,Ee.remove)(p),{dimensions:{width:m,height:h},element:v}};var at={};Object.defineProperty(at,"__esModule",{value:!0});var st=[].indexOf,ct=function(e,t){if(st)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},ut=/\s+/,lt=Object.prototype.toString;function dt(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}dt.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~ct(t,e)||t.push(e),this.el.className=t.join(" "),this},dt.prototype.remove=function(e){if("[object RegExp]"==lt.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=ct(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},dt.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},dt.prototype.toggle=function(e,t){return this.list?(void 0!==t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(void 0!==t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},dt.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(ut);return""===e[0]&&e.shift(),e},dt.prototype.has=dt.prototype.contains=function(e){return this.list?this.list.contains(e):!!~ct(this.array(),e)};var pt=Element.prototype,ft=pt.matchesSelector||pt.webkitMatchesSelector||pt.mozMatchesSelector||pt.msMatchesSelector||pt.oMatchesSelector,ht=function(e,t){if(ft)return ft.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;++i)if(n[i]==e)return!0;return!1};var mt,yt=function(e,t,n){for(var i=n?e:e.parentNode;i&&i!==document;){if(ht(i,t))return i;i=i.parentNode}},vt=window.addEventListener?"addEventListener":"attachEvent",gt=window.removeEventListener?"removeEventListener":"detachEvent",_t="addEventListener"!==vt?"on":"",xt={bind:function(e,t,n,i){return e[vt](_t+t,n,i||!1),n},unbind:function(e,t,n,i){return e[gt](_t+t,n,i||!1),n}},bt=["focus","blur"],Et={bind:function(e,t,n,i,r){return-1!==bt.indexOf(n)&&(r=!0),xt.bind(e,n,function(n){var r=n.target||n.srcElement;n.delegateTarget=yt(r,t,!0),n.delegateTarget&&i.call(e,n)},r)},unbind:function(e,t,n,i){-1!==bt.indexOf(t)&&(i=!0),xt.unbind(e,t,n,i)}},wt=function(e,t){if("string"!=typeof e)throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if("body"==i){var r=t.createElement("html");return r.innerHTML=e,r.removeChild(r.lastChild)}var o=St[i]||St._default,a=o[0],s=o[1],c=o[2];(r=t.createElement("div")).innerHTML=s+e+c;for(;a--;)r=r.lastChild;if(r.firstChild==r.lastChild)return r.removeChild(r.firstChild);var u=t.createDocumentFragment();for(;r.firstChild;)u.appendChild(r.removeChild(r.firstChild));return u},Mt=!1;"undefined"!=typeof document&&((mt=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Mt=!mt.getElementsByTagName("link").length,mt=void 0);var St={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Mt?[1,"X<div>","</div>"]:[0,"",""]};St.td=St.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],St.option=St.optgroup=[1,'<select multiple="multiple">',"</select>"],St.thead=St.tbody=St.colgroup=St.caption=St.tfoot=[1,"<table>","</table>"],St.polyline=St.ellipse=St.polygon=St.circle=St.text=St.line=St.path=St.rect=St.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var Ct="undefined"!=typeof Element?Element.prototype:{},Pt=Ct.matches||Ct.matchesSelector||Ct.webkitMatchesSelector||Ct.mozMatchesSelector||Ct.msMatchesSelector||Ct.oMatchesSelector,Rt=function(e,t){if(!e||1!==e.nodeType)return!1;if(Pt)return Pt.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1};at.attr=function(e,t,n){return 2==arguments.length?e.getAttribute(t):null===n?e.removeAttribute(t):(e.setAttribute(t,n),e)},at.classes=function(e){return new dt(e)},at.clear=function(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e},at.closest=yt,at.delegate=Et,at.domify=wt,at.event=xt,at.matches=Rt,at.query=function(e,t){return(t=t||document).querySelector(e)},at.queryAll=function(e,t){return(t=t||document).querySelectorAll(e)},at.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var Tt=l.isArray,kt=l.isObject,At=l.assign,Ot=_e.default,jt=Qe.default,Nt=me.isStandardEventVisible,It=me.isPlanningTableCollapsed,Dt=me.isCollapsed,Bt=e.isCasePlanModel,Lt=e.getBusinessObject,zt=e.getDefinition,Ft=e.isRequired,$t=e.isRepeatable,Ht=e.isManualActivation,Ut=e.isAutoComplete,Wt=e.hasPlanningTable,Vt=e.getName,Gt=e.is,qt=e.getStandardEvent,Kt=at.query,Yt=Ee.append,Xt=Ee.attr,Zt=Ee.classes,Qt=Ee.create,Jt=Ze.translate,en=Ye.createLine;function tn(e,t,n){Ot.call(this,e);var i=20,r=new jt({style:{fontFamily:"Arial, sans-serif",fontSize:"12px"},size:{width:100}}),o={};function a(e){return o[e]}function s(e){function t(t,n){var i=At({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},n.attrs),r=n.ref||{x:0,y:0},a=n.scale||1;"none"===i.strokeDasharray&&(i.strokeDasharray=[1e4,1]);var s=Qt("marker");Xt(n.element,i),Yt(s,n.element),Xt(s,{id:t,viewBox:"0 0 20 20",refX:r.x,refY:r.y,markerWidth:20*a,markerHeight:20*a,orient:"auto"});var c=Kt("defs",e);return c||(c=Qt("defs"),Yt(e,c)),Yt(c,s),function(e,t){o[e]=t}(t,s)}var n=Qt("path");Xt(n,{d:"M 11 5 L 1 10 L 11 15"}),t("association-start",{element:n,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:1,y:10},scale:.5});var i=Qt("path");Xt(i,{d:"M 1 5 L 11 10 L 1 15"}),t("association-end",{element:i,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}function c(e,n,i){return Tt(n)||(i=n,n=[]),t.style(n||[],At(i,e||{}))}function u(e,t,n,i,r){kt(i)&&(r=i,i=0),i=i||0,r=c(r,{stroke:"black",strokeWidth:2,fill:"white"});var o=t/2,a=n/2,s=Qt("circle");return Xt(s,{cx:o,cy:a,r:Math.round((t+n)/4-i)}),Xt(s,r),Yt(e,s),s}function l(e,t,n,i,r,o){kt(r)&&(o=r,r=0),r=r||0,o=c(o,{stroke:"black",strokeWidth:2,fill:"white"});var a=Qt("rect");return Xt(a,{x:r,y:r,width:t-2*r,height:n-2*r,rx:i,ry:i}),Xt(a,o),Yt(e,a),a}function d(e,t,n,i){var r=t/2,o=n/2,a=[{x:r,y:0},{x:t,y:o},{x:r,y:n},{x:0,y:o}].map(function(e){return e.x+","+e.y}).join(" ");i=c(i,{stroke:"black",strokeWidth:2,fill:"white"});var s=Qt("polygon");return Xt(s,{points:a}),Xt(s,i),Yt(e,s),s}function p(e,t,n){n=c(n,["no-fill"],{strokeWidth:2,stroke:"black"});var i=Qt("path");return Xt(i,{d:t}),Xt(i,n),Yt(e,i),i}function f(e,t,n){var i=t.map(function(e){return e.x+","+e.y}).join(" "),r=Qt("polygon");return Xt(r,{points:i}),Xt(r,n),Yt(e,r),r}function h(e){for(var t=e.waypoints,n="m  "+t[0].x+","+t[0].y,i=1;i<t.length;i++)n+="L"+t[i].x+","+t[i].y+" ";return n}function m(e,t,n){var i=r.createText(t||"",n);return Zt(i).add("djs-label"),Yt(e,i),i}function y(e,t,n){return m(e,Vt(t),{box:t,align:n,padding:5})}function v(e){return g[e]}var g={"cmmn:PlanItem":function(e,t){return v(zt(t).$type)(e,t)},"cmmn:DiscretionaryItem":function(e,t){var n=zt(t),i={strokeDasharray:"10, 12"};return Gt(n,"cmmn:Task")&&At(i,{strokeDasharray:"12, 12.4",strokeDashoffset:13.6}),v(n.$type)(e,t,i)},"cmmn:Stage":function(e,t,n){var r;return n=At({fillOpacity:.95},n),Bt(t)?g["cmmn:CasePlanModel"](e,t):(r=function(e,t,n,i,r){var o=[{x:i=i||20,y:n},{x:0,y:n-i},{x:0,y:i},{x:i,y:0},{x:t-i,y:0},{x:t,y:i},{x:t,y:n-i},{x:t-i,y:n}];return(r=r||{}).fill="white",r.stroke="black",r.strokeWidth=2,f(e,o,r)}(e,t.width,t.height,i,n),Dt(t)?y(e,t,"center-middle"):function(e,t,n){var r=m(e,Vt(t),{box:t,align:n,padding:5});Jt(r,i,0)}(e,t,"left-top"),b(e,t),x(e,t),r)},"cmmn:PlanFragment":function(e,t,n){var i=l(e,t.width,t.height,10,{strokeDasharray:"10, 12",fillOpacity:.95});return y(e,t,Dt(t)?"center-middle":"left-top"),x(e,t),i},"cmmn:CasePlanModel":function(e,t){var n=l(e,t.width,t.height,0,{fillOpacity:.95});return function(e,t){var n=Lt(t),i=t.width/2-60,r=m(e,n.name,{box:{height:18,width:i},align:"left-top"}),o=r.getBBox().width,a=o+40;o<60&&(a=100);var s=f(e,[{x:10,y:0},{x:20,y:-18},{x:a,y:-18},{x:a+10,y:0}],{fill:"white",stroke:"black",strokeWidth:2,fillOpacity:.95,"pointer-events":"all"});r.parentNode.insertBefore(s,r),Jt(r,25,-13)}(e,t),b(e,t),function(e,t){var n=Lt(t);Ut(n)&&E("AutoCompleteMarker",e,t,-7)}(e,t),n},"cmmn:Milestone":function(e,t,n){var i=l(e,t.width,t.height,24,n);return y(e,t,"center-middle"),_(e,t),i},"cmmn:EventListener":function(e,t,n){var i=u(e,t.width,t.height,n);return(n=n||{}).strokeWidth=2,u(e,t.width,t.height,.1*t.height,n),i},"cmmn:TimerEventListener":function(e,t,i){var r=v("cmmn:EventListener")(e,t,i);p(e,n.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square"});for(var o=0;o<12;o++){var a=n.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),s=t.width/2;p(e,a,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*o+","+t.height/2+","+s+")"})}return r},"cmmn:UserEventListener":function(e,t,i){var r=v("cmmn:EventListener")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"black"}),r},"cmmn:Task":function(e,t,n){var i=l(e,t.width,t.height,10,n);return y(e,t,"center-middle"),_(e,t),i},"cmmn:HumanTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);if(t.businessObject.definitionRef.isBlocking){p(e,n.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"black"})}else{p(e,n.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:1.25,fill:"white",stroke:"black"})}return b(e,t),r},"cmmn:CaseTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_FOLDER",{abspos:{x:7,y:7}}),{strokeWidth:1.25,fill:"white",stroke:"black"}),r},"cmmn:ProcessTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_CHEVRON",{abspos:{x:5,y:5}}),{strokeWidth:1.25,fill:"white",stroke:"black"}),r},"cmmn:DecisionTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),{strokeWidth:1,fill:"000"}),p(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),{strokeWidth:1}),r},"cmmn:CaseFileItem":function(e,t,i){return p(e,n.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:"white"})},"cmmn:TextAnnotation":function(e,t){var i=l(e,t.width,t.height,0,0,{fill:"none",stroke:"none"});return p(e,n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:0}})),m(e,Lt(t).text||"",{box:t,align:"left-middle",padding:5}),i},"cmmn:Association":function(e,t,n){var i=Lt(t);return n=At({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round"},n||{}),"One"!==i.associationDirection&&"Both"!==i.associationDirection||(n.markerEnd=a("association-end")),"Both"===i.associationDirection&&(n.markerStart=a("association-start")),function(e,t,n){n=c(n,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var i=en(t,n);return Yt(e,i),i}(e,t.waypoints,n)},StageMarker:function(e,t){var i=l(e,14,14,0,{strokeWidth:1,stroke:"black"});Jt(i,t.width/2-7,t.height-17);var r=Dt(t)?"MARKER_STAGE_COLLAPSED":"MARKER_STAGE_EXPANDED";p(e,n.getScaledPath(r,{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7)/t.width,my:(t.height-17)/t.height}}))},RequiredMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_REQUIRED",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}),{strokeWidth:3})},AutoCompleteMarker:function(e,t,n){var i=l(e,11,14,0,{strokeWidth:1,stroke:"black",fill:"black"});Jt(i,t.width/2+n+2,t.height-17)},ManualActivationMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_MANUAL_ACTIVATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}),{strokeWidth:1})},RepetitionMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_REPEATABLE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}))},PlanningTableMarker:function(e,t,i){var r=l(e,30,24,0,{strokeWidth:1.5,stroke:"black"});Jt(r,t.width/2-15,-17);var o=It(t)?"MARKER_PLANNING_TABLE_COLLAPSED":"MARKER_PLANNING_TABLE_EXPANDED";p(e,n.getScaledPath(o,{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-15)/t.width,my:-17/t.height}}),{strokeWidth:1.5})},"cmmn:OnPart":function(e,t){return p(e,h(t),{strokeDasharray:"10, 5, 2, 5, 2, 5",strokeWidth:1.5})},"cmmn:PlanItemOnPart":function(e,t){return v("cmmn:OnPart")(e,t)},"cmmn:CaseFileItemOnPart":function(e,t){return v("cmmn:OnPart")(e,t)},"cmmn:EntryCriterion":function(e,t){return d(e,t.width,t.height,{fill:"white"})},"cmmn:ExitCriterion":function(e,t){return d(e,t.width,t.height,{fill:"black"})},"cmmndi:CMMNEdge":function(e,t){var n=Lt(t);return n.cmmnElementRef?v(n.cmmnElementRef.$type)(e,t):p(e,h(t),{strokeDasharray:"3, 5",strokeWidth:1})},label:function(e,t){var n,i=function(e,t){var n=Vt(t),i=!1,r=qt(t);if(r){var o=Nt(t);r="["+r+"]",n?o&&(n=n+" "+r):(n=r,t.hidden=i=!o)}var a={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return t.hidden=t.labelTarget.hidden||i||!n,m(e,n,{box:a,style:{fontSize:"11px"}})}(e,t);try{n=i.getBBox()}catch(e){n={width:0,height:0,x:0}}return t.x=Math.ceil(t.x+t.width/2)-Math.ceil(n.width/2),t.width=Math.ceil(n.width),t.height=Math.ceil(n.height),Xt(i,{transform:"translate("+-1*n.x+",0)"}),i}};function _(e,t){var n=Lt(t),i=[];Ft(n)&&i.push({marker:"RequiredMarker",width:1}),Ht(n)&&i.push({marker:"ManualActivationMarker",width:14}),$t(n)&&i.push({marker:"RepetitionMarker",width:14}),i.length&&(1===i.length?E(i[0].marker,e,t,i[0].width/2*-1):2===i.length?(E(i[0].marker,e,t,-1*i[0].width-3),E(i[1].marker,e,t,3)):3===i.length&&(E(i[1].marker,e,t,i[1].width/2*-1),E(i[0].marker,e,t,i[1].width/2*-1-6-i[0].width),E(i[2].marker,e,t,i[1].width/2+6)))}function x(e,t,n){var i=Lt(t);E("StageMarker",e,t,-7);var r=[];Ft(i)&&r.push({marker:"RequiredMarker",width:1}),Ut(i)&&r.push({marker:"AutoCompleteMarker",width:14}),r.length&&(1===r.length?E(r[0].marker,e,t,-1*r[0].width-7-6):2===r.length&&(E(r[0].marker,e,t,-1*r[1].width-7-6- -1*r[0].width-6),E(r[1].marker,e,t,-1*r[1].width-7-6)));var o=[];Ht(i)&&o.push({marker:"ManualActivationMarker",width:14}),$t(i)&&o.push({marker:"RepetitionMarker",width:14}),o.length&&(1===o.length?E(o[0].marker,e,t,13):2===o.length&&(E(o[0].marker,e,t,13),E(o[1].marker,e,t,13+o[0].width+6)))}function b(e,t){Wt(t)&&E("PlanningTableMarker",e,t)}function E(e,t,n,i){v(e)(t,n,i)}this.canRender=function(e){return Gt(e,"cmmn:CMMNElement")||Gt(e,"cmmndi:CMMNEdge")},this.drawShape=function(e,t){var n=g[t.type];return n?n(e,t):Ot.prototype.drawShape.apply(this,[e,t])},this.drawConnection=function(e,t){var n=t.type,i=g[n];return i?i(e,t):Ot.prototype.drawConnection.apply(this,[e,t])},e.on("canvas.init",function(e){s(e.svg)})}u(tn,Ot),tn.$inject=["eventBus","styles","pathMap"];var nn=function(){var e="m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5",t="m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005",n="m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z";this.pathMap={TASK_TYPE_FOLDER:{d:"m {mx},{my} l18,0 l0,12 l-18,0 l0,-12 m 2,0 l3,-4 l5,0 l3,4"},TASK_TYPE_CHEVRON:{d:"m {mx},{my} l15,0 l6,6 l-6,6 l-15,0 l6,-6 l-6,-6"},TASK_TYPE_USER_1:{d:e},TASK_TYPE_USER_2:{d:t},TASK_TYPE_USER_3:{d:n},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_USER_1:{d:e,height:36,width:36,heightElements:[],widthElements:[]},EVENT_USER_2:{d:t,height:36,width:36,heightElements:[],widthElements:[]},EVENT_USER_3:{d:n,height:36,width:36,heightElements:[],widthElements:[]},MARKER_STAGE_EXPANDED:{d:"m{mx},{my} m 2,7 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_STAGE_COLLAPSED:{d:"m{mx},{my} m 2,7 l 10,0 m -5,-5 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_REQUIRED:{d:"m{mx},{my} l 0,9 m 0,2 l0,3",height:14,width:3,heightElements:[],widthElements:[]},MARKER_MANUAL_ACTIVATION:{d:"m{mx}, {my} l 14,7 l -14,7 l 0,-14 z",height:14,width:14,heightElements:[],widthElements:[]},MARKER_REPEATABLE:{d:"m{mx},{my} m 3,0 l 0,14 m 6,-14 l 0,14 m -10,-10 l 14,0 m -14,6 l 14,0",height:14,width:14,heightElements:[],widthElements:[]},MARKER_PLANNING_TABLE_EXPANDED:{d:"m{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0",height:24,width:30,heightElements:[],widthElements:[]},MARKER_PLANNING_TABLE_COLLAPSED:{d:"m{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0 m -5, -6 l 0,12",height:10,width:10,heightElements:[],widthElements:[]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,i,r=this.pathMap[e];t.abspos?(n=t.abspos.x,i=t.abspos.y):(n=t.containerWidth*t.position.mx,i=t.containerHeight*t.position.my);var o,a,s={};if(t.position){for(var c=t.containerHeight/r.height*t.yScaleFactor,u=t.containerWidth/r.width*t.xScaleFactor,l=0;l<r.heightElements.length;l++)s["y"+l]=r.heightElements[l]*c;for(var d=0;d<r.widthElements.length;d++)s["x"+d]=r.widthElements[d]*u}return o=r.d,a={mx:n,my:i,e:s},String(o).replace(rn,function(e,t){return function(e,t,n){var i=n;return t.replace(on,function(e,t,n,r,o){t=t||r,i&&(t in i&&(i=i[t]),"function"==typeof i&&o&&(i=i()))}),i=(null==i||i==n?e:i)+""}(e,t,a)})}},rn=/\{([^}]+)\}/g,on=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;var an={__init__:["cmmnRenderer"],cmmnRenderer:["type",tn],pathMap:["type",nn]},sn={elementToString:function(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}},cn={},un=e.is,ln=l.assign,dn=cn.DEFAULT_LABEL_SIZE={width:90,height:20};cn.hasExternalLabel=function(e){return(un(e,"cmmn:PlanItem")||un(e,"cmmn:DiscretionaryItem"))&&(e=e.definitionRef),un(e,"cmmndi:CMMNEdge")&&e.cmmnElementRef&&un(e.cmmnElementRef,"cmmn:OnPart")&&(e=e.cmmnElementRef),un(e,"cmmn:EventListener")||un(e,"cmmn:OnPart")||un(e,"cmmn:CaseFileItem")};var pn=cn.getExternalLabelMid=function(e){var t,n,i,r,o=e.businessObject,a=o.di;return!a&&un(o,"cmmndi:CMMNEdge")&&o.cmmnElementRef&&(a=o),o&&a&&a.waypoint?(t=a.waypoint,n=t.length/2-1,i=t[Math.floor(n)],r=t[Math.ceil(n+.01)],{x:i.x+(r.x-i.x)/2,y:i.y+(r.y-i.y)/2}):{x:e.x+e.width/2,y:e.y+e.height+dn.height/2}};cn.getExternalLabelBounds=function(e,t){var n,i,r,o=(e.di||e).label;return o&&o.bounds?(r=o.bounds,i={width:Math.max(dn.width,r.width),height:r.height},n={x:r.x+r.width/2,y:r.y+r.height/2}):(n=pn(t),i=dn),ln({x:n.x-i.width/2,y:n.y-i.height/2},i)};var fn=l.assign,hn=l.map,mn=e.is,yn=cn.hasExternalLabel,vn=cn.getExternalLabelBounds,gn=me.isCollapsed,_n=sn.elementToString;function xn(e,t){return fn({id:e.id,type:e.$type,businessObject:e},t)}function bn(e,t,n){return new Error("element "+_n(t)+" referenced by "+_n(e)+"#"+n+" not yet drawn")}function En(e,t,n,i){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i}En.$inject=["eventBus","canvas","elementFactory","elementRegistry"];var wn=En;En.prototype.root=function(e){var t=this._elementFactory.createRoot(xn(e));return this._canvas.setRootElement(t),t},En.prototype.add=function(e,t){var n,i,r,o=e.di;if(o&&mn(o,"cmmndi:CMMNShape")&&!this._getElement(e)){var a=gn(e);i=t&&(t.hidden||t.collapsed);var s=e.di.bounds;n=this._elementFactory.createShape(xn(e,{collapsed:a,hidden:i,x:Math.round(s.x),y:Math.round(s.y),width:Math.round(s.width),height:Math.round(s.height)})),mn(e,"cmmn:Criterion")&&this._attachCriterion(e,n),this._canvas.addShape(n,t)}else{if(!(o&&mn(o,"cmmndi:CMMNEdge")||mn(e,"cmmndi:CMMNEdge")))throw new Error("unknown di "+_n(o)+" for element "+_n(e));var c=this._getSource(e),u=this._getTarget(e);i=t&&(t.hidden||t.collapsed)||c&&c.hidden||u&&u.hidden;var l=(e.di||{}).waypoint||e.waypoint;n=this._elementFactory.createConnection(xn(e,{hidden:i,source:c,target:u,waypoints:(r=l,hn(r,function(e){return{x:e.x,y:e.y}}))})),this._canvas.addConnection(n,t)}return yn(e)&&this.addLabel(e,n),this._eventBus.fire("cmmnElement.added",{element:n}),n},En.prototype._attachCriterion=function(e,t){var n=e.$parent;if(!n)throw new Error("missing "+_n(e)+"$parent");var i=this._elementRegistry.get(n.id),r=i&&i.attachers;if(!i)throw bn(e,n,"criterion");t.host=i,r||(i.attachers=r=[]),-1===r.indexOf(t)&&r.push(t)},En.prototype.addLabel=function(e,t){var n=vn(e,t),i=this._elementFactory.createLabel(xn(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden,x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)}));return this._canvas.addShape(i,t.parent)},En.prototype._getSource=function(e){var t=e.cmmnElementRef;if(t){if(mn(t,"cmmn:OnPart"))return t.exitCriterionRef?this._getEnd(t,"exitCriterionRef"):this._getEnd(t,"sourceRef");if(mn(t,"cmmn:Association"))return this._getEnd(t,"sourceRef")}if(mn(e,"cmmndi:CMMNEdge"))return this._getEnd(e,"sourceCMMNElementRef")},En.prototype._getTarget=function(e){var t=e.cmmnElementRef;return t&&mn(t,"cmmn:Association")?this._getEnd(t,"targetRef"):this._getEnd(e,"targetCMMNElementRef")},En.prototype._getEnd=function(e,t){var n=e[t],i=n&&this._getElement(n);if(i)return i;throw n?bn(e,n,t):new Error(_n(e)+"#"+t+"Ref not specified")},En.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};var Mn={__depends__:[an,{cmmnImporter:["type",wn]}],itemRegistry:["type",pe]},Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.remove=function(e,t){if(!e||!t)return-1;var n=e.indexOf(t);-1!==n&&e.splice(n,1);return n},Sn.add=function(e,t,n){if(!e||!t)return;"number"!=typeof n&&(n=-1);var i=e.indexOf(t);if(-1!==i){if(i===n)return;if(-1===n)return;e.splice(i,1)}-1!==n?e.splice(n,0,t):e.push(t)},Sn.indexOf=function(e,t){if(!e||!t)return-1;return e.indexOf(t)};var Cn=l.forEach,Pn=l.filter,Rn=sn.elementToString,Tn=e.is,kn=new D({name:"cmmnElement",enumerable:!0},{name:"di"});var An=function(e){var t=[],n=[],i={},r=[],o={},a=[],s=[];function c(t,n){return e.element(t,n)}function u(t,n){try{return e.addItem(t),t.di&&c(t,n)}catch(e){l(e.message,{element:t,error:e}),console.error("failed to import "+Rn(t)),console.error(e)}}function l(t,n){e.error(t,n)}function d(e,t){return function(n){e(n,t)}}function p(e){var t,o=e.cmmnElementRef;if(o&&!Tn(e,"cmmndi:CMMNEdge"))if(o.di)l("multiple DI elements defined for "+Rn(o),{element:o});else{var u=function(e){for(;e&&!Tn(e,"cmmn:Case");)e=e.$parent;return e}(o);u&&-1===r.indexOf(u)&&r.push(u),(Tn(o,"cmmn:TextAnnotation")||Tn(o,"cmmn:CaseFileItem"))&&a.push(o),kn.bind(o,"di"),o.di=e}else if(Tn(e,"cmmndi:CMMNEdge")){var d=!0;if((Tn((t=e).cmmnElementRef,"cmmn:Association")?!!t.cmmnElementRef.targetRef:!!t.targetCMMNElementRef)||(d=!1,l("no target referenced in "+Rn(e),{element:e})),function(e){return Tn(e.cmmnElementRef,"cmmn:OnPart")?!(!e.cmmnElementRef.exitCriterionRef&&!e.cmmnElementRef.sourceRef):Tn(e.cmmnElementRef,"cmmn:Association")?!!e.cmmnElementRef.sourceRef:!!e.sourceCMMNElementRef}(e)||(d=!1,l("no source referenced in "+Rn(e),{element:e})),d)if(Tn(o,"cmmn:Association"))s.push(e);else if(o)n.push(function(t){c(e,t)});else{var p=e.sourceCMMNElementRef;i[p.id]=i[p.id]||[],i[p.id].push(e)}}else l("no cmmnElement referenced in "+Rn(e),{element:e})}function f(e){var t;t=e.diagramElements,Cn(t,h)}function h(e){p(e)}function m(e,t){!function(e,t){Cn(e,d(v,t))}(e.planItems,t),Tn(e,"cmmn:Stage")&&function(e,t){y(e.planningTable,t)}(e,t)}function y(e,t){e&&Cn(e.tableItems,function(e){Tn(e,"cmmn:DiscretionaryItem")?function(e,t){o[e.id]||(function(e){o[e.id]=e}(e),v(e,t))}(e,t):Tn(e,"cmmn:PlanningTable")&&y(e,t)})}function v(e,t){var n=u(e,t);Cn(e.exitCriteria,d(g,t)),Cn(e.entryCriteria,d(g,t));var r=e.definitionRef;if(Tn(r,"cmmn:PlanFragment"))m(r,n),_(e,n);else if(Tn(r,"cmmn:HumanTask")){y(r.planningTable,t);var o=i[e.id];Cn(o,d(E,t)),delete i[e.id]}}function g(e,n){t.unshift(function(){u(e,n)})}function _(e,t){if(e.di&&e.di.bounds){var n=function(e,t){var n=t.di.bounds;return Pn(e,function(e){return e.di.bounds.x>n.x&&e.di.bounds.x<n.x+n.width&&e.di.bounds.y>n.y&&e.di.bounds.y<n.y+n.height})}(a,e);Cn(n,function(e){Sn.remove(a,e),x(e,t)})}}function x(e,t){Tn(e,"cmmn:TextAnnotation")?function(e,t){u(e,t)}(e,t):Tn(e,"cmmn:CaseFileItem")&&function(e,t){u(e,t)}(e,t)}function b(e,t){c(e,t)}function E(e,n){t.push(function(){c(e,n)})}return{handleDefinitions:function(i,o){var c=i.CMMNDI;if(c){var l=c.diagrams;if(o&&-1===l.indexOf(o))throw new Error("diagram not part of cmmn:Definitions");!o&&l&&l.length&&(o=l[0]),f(o);var p=function(t,n){return e.root(t,n)}(o,o);!function(e,i){Cn(e,function(e){!function(e,i){var r,o=e.casePlanModel;o&&(r=function(e,t){var n=u(e,t);return Cn(e.exitCriteria,d(g,n)),m(e,n),_(e,n),n}(o,i)),function(e){Cn(e,function(e){e()})}(t),Cn(n,function(e){e(r)})}(e,i),t=[],n=[]})}(r,p),Cn(a,d(x)),Cn(s,d(b))}}}},On={};On.importCmmnDiagram=function(e,t,n){var i,r=e.get("cmmnImporter"),o=e.get("eventBus"),a=e.get("itemRegistry"),s=[];o.fire("import.render.start",{definitions:t});try{!function(e){new An({root:function(e){return r.root(e)},element:function(e,t){return r.add(e,t)},error:function(e,t){s.push({message:e,context:t})},addItem:function(e){a.add(e)}}).handleDefinitions(e)}(t)}catch(e){i=e}o.fire("import.render.complete",{error:i,warnings:s}),n(i,s)};var jn={},Nn=at.domify,In=at.delegate,Dn='<img width="52" height="52" src="'+("data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 960"><path fill="#fff" d="M960 60v839c0 33-27 61-60 61H60c-33 0-60-27-60-60V60C0 27 27 0 60 0h839c34 0 61 27 61 60z"/><path fill="#52b415" d="M217 548a205 205 0 0 0-144 58 202 202 0 0 0-4 286 202 202 0 0 0 285 3 200 200 0 0 0 48-219 203 203 0 0 0-185-128zM752 6a206 206 0 0 0-192 285 206 206 0 0 0 269 111 207 207 0 0 0 111-260A204 204 0 0 0 752 6zM62 0A62 62 0 0 0 0 62v398l60 46a259 259 0 0 1 89-36c5-28 10-57 14-85l99 2 12 85a246 246 0 0 1 88 38l70-52 69 71-52 68c17 30 29 58 35 90l86 14-2 100-86 12a240 240 0 0 1-38 89l43 58h413c37 0 60-27 60-61V407a220 220 0 0 1-44 40l21 85-93 39-45-76a258 258 0 0 1-98 1l-45 76-94-39 22-85a298 298 0 0 1-70-69l-86 22-38-94 76-45a258 258 0 0 1-1-98l-76-45 40-94 85 22a271 271 0 0 1 41-47z"/></svg>'))+'" />';function Bn(e){return e.join(";")}var Ln,zn='<div class="bjs-powered-by-lightbox" style="'+Bn(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+Bn(["width: 100%","height: 100%","background: rgba(0,0,0,0.2)"])+'"></div><div class="notice" style="'+Bn(["position: absolute","left: 50%","top: 40%","margin: 0 -130px","width: 260px","padding: 10px","background: white","border: solid 1px #AAA","border-radius: 3px","font-family: Helvetica, Arial, sans-serif","font-size: 14px","line-height: 1.2em"])+'"><a href="http://bpmn.io" target="_blank" style="float: left; margin-right: 10px">'+Dn+'</a>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="http://bpmn.io" target="_blank">bpmn.io</a>.</div></div>';jn.open=function(){Ln||(Ln=Nn(zn),In.bind(Ln,".backdrop","click",function(e){document.body.removeChild(Ln)})),document.body.appendChild(Ln)},jn.BPMNIO_IMG=Dn;var Fn={};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.hasLowerCaseAlias=function(e){return e.xml&&"lowerCase"===e.xml.tagAlias},Fn.serializeAsType=function(e){return Hn(e)===$n},Fn.serializeAsProperty=function(e){return"property"===Hn(e)};Fn.DEFAULT_NS_MAP={xsi:"http://www.w3.org/2001/XMLSchema-instance"};var $n=Fn.XSI_TYPE="xsi:type";function Hn(e){return e.xml&&e.xml.serialize}var Un={};function Wn(){}Object.defineProperty(Un,"__esModule",{value:!0}),Un.default=Wn,Wn.prototype.get=function(e){return this.$model.properties.get(this,e)},Wn.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};var Vn={};Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.default=Kn;var Gn,qn=(Gn=Un)&&Gn.__esModule?Gn:{default:Gn};function Kn(e,t){this.model=e,this.properties=t}Kn.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(qn.default.prototype);(0,l.forEach)(e.properties,function(e){e.isMany||void 0===e.default||(i[e.name]=e.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var r=e.ns.name;function o(e){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),(0,l.forEach)(e,(0,l.bind)(function(e,t){this.set(t,e)},this))}return o.prototype=i,o.hasType=i.$instanceOf=this.model.hasType,n.defineModel(o,t),n.defineDescriptor(o,e),o};var Yn={};Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.parseName=function(e,t){var n,i,r=e.split(/:/);if(1===r.length)n=e,i=t;else{if(2!==r.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);n=r[1],i=r[0]}return{name:e=(i?i+":":"")+n,prefix:i,localName:n}};var Xn={};function Zn(e){this.model=e}function Qn(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.default=Zn,Zn.prototype.set=function(e,t,n){var i=this.model.getPropertyDescriptor(e,t),r=i&&i.name;void 0===n?i?delete e[r]:delete e.$attrs[t]:i?r in e?e[r]=n:Qn(e,i,n):e.$attrs[t]=n},Zn.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&Qn(e,n,[]),e[i]},Zn.prototype.define=function(e,t,n){Object.defineProperty(e,t,n)},Zn.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},Zn.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};var Jn={};function ei(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.default=ei,ei.prototype.build=function(){return(0,l.pick)(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},ei.prototype.addProperty=function(e,t,n){"boolean"==typeof t&&(n=t,t=void 0),this.addNamedProperty(e,!1!==n);var i=this.properties;void 0!==t?i.splice(t,0,e):i.push(e)},ei.prototype.replaceProperty=function(e,t,n){var i=e.ns,r=this.properties,o=this.propertiesByName,a=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=r.indexOf(e);if(-1===s)throw new Error("property <"+i.name+"> not found in property list");r.splice(s,1),this.addProperty(t,n?void 0:s,a),o[i.name]=o[i.localName]=t},ei.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,r=t.split("#"),o=(0,Yn.parseName)(r[0],i),a=(0,Yn.parseName)(r[1],o.prefix).name,s=this.propertiesByName[a];if(!s)throw new Error("refined property <"+a+"> not found");this.replaceProperty(s,e,n),delete e.redefines},ei.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e},ei.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]},ei.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},ei.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},ei.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},ei.prototype.hasProperty=function(e){return this.propertiesByName[e]},ei.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,r=e.name;r in n||((0,l.forEach)(e.properties,(0,l.bind)(function(n){n=(0,l.assign)({},n,{name:n.ns.localName,inherited:t}),Object.defineProperty(n,"definedBy",{value:e});var i=n.replaces,r=n.redefines;i||r?this.redefineProperty(n,i||r,i):(n.isBody&&this.setBodyProperty(n),n.isId&&this.setIdProperty(n),this.addProperty(n))},this)),i.push(e),n[r]=e)};var ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.coerceType=function(e,t){var n=ii[e];return n?n(t):t},ti.isBuiltIn=function(e){return!!ni[e]},ti.isSimple=function(e){return!!ii[e]};var ni={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},ii={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e,10)}};var ri={};Object.defineProperty(ri,"__esModule",{value:!0}),ri.default=ai;var oi=function(e){return e&&e.__esModule?e:{default:e}}(Jn);function ai(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,(0,l.forEach)(e,(0,l.bind)(this.registerPackage,this))}function si(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}ai.prototype.getPackage=function(e){return this.packageMap[e]},ai.prototype.getPackages=function(){return this.packages},ai.prototype.registerPackage=function(e){e=(0,l.assign)({},e);var t=this.packageMap;si(t,e,"prefix"),si(t,e,"uri"),(0,l.forEach)(e.types,(0,l.bind)(function(t){this.registerType(t,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)},ai.prototype.registerType=function(e,t){e=(0,l.assign)({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:(0,l.assign)(e.meta||{})});var n=(0,Yn.parseName)(e.name,t.prefix),i=n.name,r={};(0,l.forEach)(e.properties,(0,l.bind)(function(e){var t=(0,Yn.parseName)(e.name,n.prefix),i=t.name;(0,ti.isBuiltIn)(e.type)||(e.type=(0,Yn.parseName)(e.type,t.prefix).name),(0,l.assign)(e,{ns:t,name:i}),r[i]=e},this)),(0,l.assign)(e,{ns:n,name:i,propertiesByName:r}),(0,l.forEach)(e.extends,(0,l.bind)(function(e){var t=this.typeMap[e];t.traits=t.traits||[],t.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e},ai.prototype.mapTypes=function(e,t,n){var i=(0,ti.isBuiltIn)(e.name)?{name:e.name}:this.typeMap[e.name],r=this;function o(e){return a(e,!0)}function a(n,i){var o=(0,Yn.parseName)(n,(0,ti.isBuiltIn)(n)?"":e.prefix);r.mapTypes(o,t,i)}if(!i)throw new Error("unknown type <"+e.name+">");(0,l.forEach)(i.superClass,n?o:a),t(i,!n),(0,l.forEach)(i.traits,o)},ai.prototype.getEffectiveDescriptor=function(e){var t=(0,Yn.parseName)(e),n=new oi.default(t);this.mapTypes(t,function(e,t){n.addTrait(e,t)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i},ai.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};var ci={};Object.defineProperty(ci,"__esModule",{value:!0}),ci.default=fi;var ui=pi(Vn),li=pi(ri),di=pi(Xn);function pi(e){return e&&e.__esModule?e:{default:e}}function fi(e){this.properties=new di.default(this),this.factory=new ui.default(this,this.properties),this.registry=new li.default(e,this.properties),this.typeCache={}}fi.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)},fi.prototype.getType=function(e){var t=this.typeCache,n=(0,l.isString)(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i},fi.prototype.createAny=function(e,t,n){var i=(0,Yn.parseName)(e),r={$type:e,$instanceOf:function(e){return e===this.$type}},o={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(r,o),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),(0,l.forEach)(n,function(e,t){(0,l.isObject)(e)&&void 0!==e.value?r[e.name]=e.value:r[t]=e}),r},fi.prototype.getPackage=function(e){return this.registry.getPackage(e)},fi.prototype.getPackages=function(){return this.registry.getPackages()},fi.prototype.getElementDescriptor=function(e){return e.$descriptor},fi.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},fi.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},fi.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var hi={};Object.defineProperty(hi,"__esModule",{value:!0}),Object.defineProperty(hi,"default",{enumerable:!0,get:function(){return(e=ci,e&&e.__esModule?e:{default:e}).default;var e}});var mi={},yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(mi,"__esModule",{value:!0});var vi=String.fromCharCode,gi=Object.prototype.hasOwnProperty,_i=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,xi={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function bi(e,t,n,i){return i?gi.call(xi,i)?xi[i]:"&"+i+";":vi(t||parseInt(n,16))}function Ei(e){return e.length>3&&-1!==e.indexOf("&")?e.replace(_i,bi):e}Object.keys(xi).forEach(function(e){xi[e.toUpperCase()]=xi[e]});var wi="http://www.w3.org/2001/XMLSchema-instance",Mi="xsi",Si="xsi:type",Ci="non-whitespace outside of root node";function Pi(e){return new Error(e)}function Ri(e){return"missing namespace for prefix <"+e+">"}function Ti(e){return{get:e,enumerable:!0}}function ki(e){var t,n={};for(t in e)n[t]=e[t];return n}function Ai(e){return e+"$uri"}function Oi(){return{line:0,column:0}}function ji(e){throw e}mi.Parser=function e(t){if(!this)return new e(t);var n,i,r,o,a,s,c,u,l,d=t&&t.proxy,p=ji,f=Oi,h=!1,m=!1,y=null,v=!1;function g(e){e instanceof Error||(e=Pi(e)),y=e,p(e,f)}function _(e){a&&(e instanceof Error||(e=Pi(e)),a(e,f))}this.on=function(e,t){if("function"!=typeof t)throw Pi("required args <name, cb>");switch(e){case"openTag":i=t;break;case"text":n=t;break;case"closeTag":r=t;break;case"error":p=t;break;case"warn":a=t;break;case"cdata":o=t;break;case"attention":u=t;break;case"question":c=t;break;case"comment":s=t;break;default:throw Pi("unsupported event: "+e)}return this},this.ns=function(e){if(void 0===e&&(e={}),"object"!==(void 0===e?"undefined":yi(e)))throw Pi("required args <nsMap={}>");var t,n={};for(t in e)n[t]=e[t];return n[wi]=Mi,m=!0,l=n,this},this.parse=function(e){if("string"!=typeof e)throw Pi("required args <xml=string>");return y=null,function(e){var t,a,p,y,x,b,E,w,M,S,C=m?[]:null,P=m?function(e){var t,n,i={};for(t in e)i[n=e[t]]=n,i[Ai(n)]=t;return i}(l):null,R=[],T=0,k=!1,A=!1,O=0,j=0,N="",I=0;function D(){if(null!==S)return S;var e,t,n,i,r,o,a,s,c,u,d,p=m&&P.xmlns,f=m&&h?[]:null,y=I,v=N,g=v.length,x={},b={};e:for(;y<g;y++)if(c=!1,!(32===(u=v.charCodeAt(y))||u<14&&u>8)){for((u<65||u>122||u>90&&u<97)&&95!==u&&58!==u&&(_("illegal first char attribute name"),c=!0),d=y+1;d<g;d++)if(!((u=v.charCodeAt(d))>96&&u<123||u>64&&u<91||u>47&&u<59||46===u||45===u||95===u)){if(32===u||u<14&&u>8){_("missing attribute value"),y=d;continue e}if(61===u)break;_("illegal attribute name char"),c=!0}if("xmlns:xmlns"===(s=v.substring(y,d))&&(_("illegal declaration of xmlns"),c=!0),34===(u=v.charCodeAt(d+1)))-1===(d=v.indexOf('"',y=d+2))&&-1!==(d=v.indexOf("'",y))&&(_("attribute value quote missmatch"),c=!0);else if(39===u)-1===(d=v.indexOf("'",y=d+2))&&-1!==(d=v.indexOf('"',y))&&(_("attribute value quote missmatch"),c=!0);else for(_("missing attribute value quotes"),c=!0,d+=1;d<g&&!(32===(u=v.charCodeAt(d+1))||u<14&&u>8);d++);for(-1===d&&(_("missing closing quotes"),d=g,c=!0),c||(o=v.substring(y,d)),y=d;d+1<g&&!(32===(u=v.charCodeAt(d+1))||u<14&&u>8);d++)y===d&&(_("illegal character after attribute end"),c=!0);if(y=d+1,!c)if(s in b)_("attribute <"+s+"> already defined");else if(b[s]=!0,m)if(h){if(null!==(r="xmlns"===s?"xmlns":120===s.charCodeAt(0)&&"xmlns:"===s.substr(0,6)?s.substr(6):null)){if(e=Ei(o),t=Ai(r),!(a=l[e])){if("xmlns"===r||t in P&&P[t]!==e)do{a="ns"+T++}while(void 0!==P[a]);else a=r;l[e]=a}P[r]!==a&&(i||(P=ki(P),i=!0),P[r]=a,"xmlns"===r&&(P[Ai(a)]=e,p=a),P[t]=e),x[s]=o;continue}f.push(s,o)}else-1!==(u=s.indexOf(":"))?(n=P[s.substring(0,u)])?((s=p===n?s.substr(u+1):n+s.substr(u))===Si&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),n=P[n]||n,o=n+o.substring(u)):o=p+":"+o),x[s]=o):_(Ri(s.substring(0,u))):x[s]=o;else x[s]=o}if(h)for(y=0,g=f.length;y<g;y++){if(s=f[y++],o=f[y],-1!==(u=s.indexOf(":"))){if(!(n=P[s.substring(0,u)])){_(Ri(s.substring(0,u)));continue}(s=p===n?s.substr(u+1):n+s.substr(u))===Si&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),n=P[n]||n,o=n+o.substring(u)):o=p+":"+o)}x[s]=o}return S=x}for(f=function(){for(var t,n,i=/(\r\n|\r|\n)/g,r=0,o=0,a=0,s=j;O>=a&&(t=i.exec(e))&&!((s=t[0].length+t.index)>O);)r+=1,a=s;return-1==O?(o=s,n=e.substring(j)):0===j?(console.log(O-a),n=e.substring(j,O)):(o=O-a,n=-1==j?e.substring(O):e.substring(O,j+1)),{data:n,line:r,column:o}},d&&(M=Object.create({},{name:Ti(function(){return E}),originalName:Ti(function(){return w}),attrs:Ti(D),ns:Ti(function(){return P})}));-1!==j;){if(-1===(O=60===e.charCodeAt(j)?j:e.indexOf("<",j)))return R.length?g("unexpected end of file"):0===j?g("missing start tag"):void(j<e.length&&e.substring(j).trim()&&_(Ci));if(j!==O)if(R.length){if(n&&(n(e.substring(j,O),Ei,f),v))return}else if(e.substring(j,O).trim()&&(_(Ci),v))return;if(33!==(x=e.charCodeAt(O+1)))if(63!==x){if(-1==(j=e.indexOf(">",O+1)))return g("unclosed tag");if(S={},47===x){if(k=!1,A=!0,!R.length)return g("missing open tag");if(a=E=R.pop(),y=O+2+a.length,e.substring(O+2,y)!==a)return g("closing tag mismatch");for(;y<j;y++)if(!(32===(x=e.charCodeAt(y))||x>8&&x<14))return g("close tag")}else{if(47===e.charCodeAt(j-1)?(a=E=e.substring(O+1,j-1),k=!0,A=!0):(a=E=e.substring(O+1,j),k=!0,A=!1),!(x>96&&x<123||x>64&&x<91||95===x||58===x))return g("illegal first char nodeName");for(y=1,p=a.length;y<p;y++)if(!((x=a.charCodeAt(y))>96&&x<123||x>64&&x<91||x>47&&x<59||45===x||95===x||46==x)){if(32===x||x<14&&x>8){E=a.substring(0,y),S=null;break}return g("invalid nodeName")}A||R.push(E)}if(m){if(t=P,k&&(A||C.push(t),null===S&&(h=-1!==a.indexOf("xmlns",y))&&(I=y,N=a,D(),h=!1)),w=E,-1!==(x=E.indexOf(":"))){if(!(b=P[E.substring(0,x)]))return g("missing namespace on <"+w+">");E=E.substr(x+1)}else b=P.xmlns;b&&(E=b+":"+E)}if(k&&(I=y,N=a,i&&(d?i(M,Ei,A,f):i(E,D,Ei,A,f),v)))return;if(A){if(r&&(r(d?M:E,Ei,k,f),v))return;m&&(P=k?t:C.pop())}j+=1}else{if(-1===(j=e.indexOf("?>",O)))return g("unclosed question");if(c&&(c(e.substring(O,j+2),f),v))return;j+=2}else{if(91===(x=e.charCodeAt(O+2))&&"CDATA["===e.substr(O+3,6)){if(-1===(j=e.indexOf("]]>",O)))return g("unclosed cdata");if(o&&(o(e.substring(O+9,j),f),v))return;j+=3;continue}if(45===x&&45===e.charCodeAt(O+3)){if(-1===(j=e.indexOf("--\x3e",O)))return g("unclosed comment");if(s&&(s(e.substring(O+4,j),Ei,f),v))return;j+=3;continue}if(-1===(j=e.indexOf(">",O+1)))return g("unclosed tag");if(u&&(u(e.substring(O,j+1),Ei,f),v))return;j+=1}}}(e),f=Oi,v=!1,y},this.stop=function(){v=!0}};var Ni={};Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.Reader=Yi;var Ii=function(e){return e&&e.__esModule?e:{default:e}}(hi);function Di(e,t){return(0,Fn.hasLowerCaseAlias)(t)?e.prefix+":"+((n=e.localName).charAt(0).toUpperCase()+n.slice(1)):e.name;var n}function Bi(e){return new Error(e)}function Li(e){return e.$descriptor}function zi(e){(0,l.assign)(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw Bi("expected element");var t,n=this.elementsById,i=Li(e).idProperty;if(i&&(t=e.get(i.name))){if(n[t])throw Bi("duplicate ID <"+t+">");n[t]=e}},this.addWarning=function(e){this.warnings.push(e)}}function Fi(){}function $i(){}function Hi(){}function Ui(e,t){this.property=e,this.context=t}function Wi(e,t){this.element=t,this.propertyDesc=e}function Vi(){}function Gi(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}function qi(e,t,n){Gi.call(this,e,t,n)}function Ki(e,t,n){this.model=e,this.context=n}function Yi(e){e instanceof Ii.default&&(e={model:e}),(0,l.assign)(this,{lax:!1},e)}Fi.prototype.handleEnd=function(){},Fi.prototype.handleText=function(){},Fi.prototype.handleNode=function(){},$i.prototype=Object.create(Fi.prototype),$i.prototype.handleNode=function(){return this},Hi.prototype=Object.create(Fi.prototype),Hi.prototype.handleText=function(e){this.body=(this.body||"")+e},Ui.prototype=Object.create(Hi.prototype),Ui.prototype.handleNode=function(e){if(this.element)throw Bi("expected no sub nodes");return this.element=this.createReference(e),this},Ui.prototype.handleEnd=function(){this.element.id=this.body},Ui.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},Wi.prototype=Object.create(Hi.prototype),Wi.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=(0,ti.coerceType)(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)},Vi.prototype=Object.create(Hi.prototype),Vi.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t},Gi.prototype=Object.create(Vi.prototype),Gi.prototype.addReference=function(e){this.context.addReference(e)},Gi.prototype.handleText=function(e){if(!Li(this.element).bodyProperty)throw Bi("unexpected body text <"+e+">");Hi.prototype.handleText.call(this,e)},Gi.prototype.handleEnd=function(){var e=this.body,t=this.element,n=Li(t).bodyProperty;n&&void 0!==e&&(e=(0,ti.coerceType)(n.type,e),t.set(n.name,e))},Gi.prototype.createElement=function(e){var t,n=e.attributes,i=this.type,r=Li(i),o=this.context,a=new i({}),s=this.model;return(0,l.forEach)(n,function(e,n){var i,c=r.propertiesByName[n];c&&c.isReference?c.isMany?(i=e.split(" "),(0,l.forEach)(i,function(e){o.addReference({element:a,property:c.ns.name,id:e})})):o.addReference({element:a,property:c.ns.name,id:e}):(c?e=(0,ti.coerceType)(c.type,e):"xmlns"!==n&&(t=(0,Yn.parseName)(n,r.ns.prefix),s.getPackage(t.prefix)&&o.addWarning({message:"unknown attribute <"+n+">",element:a,property:n,value:e})),a.set(n,e))}),a},Gi.prototype.getPropertyForNode=function(e){var t,n,i=e.name,r=(0,Yn.parseName)(i),o=this.type,a=this.model,s=Li(o),c=r.name,u=s.propertiesByName[c];if(u)return(0,Fn.serializeAsType)(u)&&(t=e.attributes[Fn.XSI_TYPE])?(t=function(e,t){var n=(0,Yn.parseName)(e);return function(e,t){var n=e.name,i=e.localName,r=t.xml&&t.xml.typePrefix;return r&&0===i.indexOf(r)?e.prefix+":"+i.slice(r.length):n}(n,t.getPackage(n.prefix))}(t,a),n=a.getType(t),(0,l.assign)({},u,{effectiveType:Li(n).name})):u;var d=a.getPackage(r.prefix);if(d){if(t=Di(r,d),n=a.getType(t),u=(0,l.find)(s.properties,function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&n.hasType(e.type)}))return(0,l.assign)({},u,{effectiveType:Li(n).name})}else if(u=(0,l.find)(s.properties,function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type}))return u;throw Bi("unrecognized element <"+r.name+">")},Gi.prototype.toString=function(){return"ElementDescriptor["+Li(this.type).name+"]"},Gi.prototype.valueHandler=function(e,t){return new Wi(e,t)},Gi.prototype.referenceHandler=function(e){return new Ui(e,this.context)},Gi.prototype.handler=function(e){return"Element"===e?new Ki(this.model,e,this.context):new Gi(this.model,e,this.context)},Gi.prototype.handleChild=function(e){var t,n,i,r;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,(0,ti.isSimple)(n))return this.valueHandler(t,i);var o=(r=t.isReference?this.referenceHandler(t).handleNode(e):this.handler(n).handleNode(e)).element;return void 0!==o&&(t.isMany?i.get(t.name).push(o):i.set(t.name,o),t.isReference?((0,l.assign)(o,{element:i}),this.context.addReference(o)):o.$parent=i),r},qi.prototype=Object.create(Gi.prototype),qi.prototype.createElement=function(e){var t=e.name,n=(0,Yn.parseName)(t),i=this.model,r=this.type,o=i.getPackage(n.prefix),a=o&&Di(n,o)||t;if(!r.hasType(a))throw Bi("unexpected element <"+e.originalName+">");return Gi.prototype.createElement.call(this,e)},Ki.prototype=Object.create(Vi.prototype),Ki.prototype.createElement=function(e){var t=e.name,n=(0,Yn.parseName)(t).prefix,i=e.ns[n+"$uri"],r=e.attributes;return this.model.createAny(t,i,r)},Ki.prototype.handleChild=function(e){var t=new Ki(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element;return void 0!==i&&((n.$children=n.$children||[]).push(i),i.$parent=n),t},Ki.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Yi.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof Gi?(i=t,t={}):"string"==typeof t?(i=this.handler(t),t={}):"string"==typeof i&&(i=this.handler(i));var r=this.model,o=this.lax,a=new zi((0,l.assign)({},t,{rootHandler:i})),s=new mi.Parser({proxy:!0}),c=function(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}();function u(e,t,n){var i=t(),r=i.line,o=i.column,s=i.data;"<"===s.charAt(0)&&-1!==s.indexOf(" ")&&(s=s.slice(0,s.indexOf(" "))+">");var c="unparsable content "+(s?s+" ":"")+"detected\n\tline: "+r+"\n\tcolumn: "+o+"\n\tnested error: "+e.message;if(n)return a.addWarning({message:c,error:e}),!0;throw Bi(c)}function d(e,t){return u(e,t,!0)}i.context=a,c.push(i);var p=/^<\?xml /i,f=/ encoding="([^"]+)"/i,h=/^utf-8$/i;function m(e,t){try{c.peek().handleText(e)}catch(e){d(e,t)}}var y=r.getPackages().reduce(function(e,t){return e[t.uri]=t.prefix,e},{});s.ns(y).on("openTag",function(e,t,n,i){var r=e.attrs||{},a=Object.keys(r).reduce(function(e,n){var i=t(r[n]);return e[n]=i,e},{});!function(e,t){var n=c.peek();try{c.push(n.handleNode(e))}catch(e){u(e,t,o)&&c.push(new $i)}}({name:e.name,originalName:e.originalName,attributes:a,ns:e.ns},i)}).on("question",function(e){if(p.test(e)){var t=f.exec(e),n=t&&t[1];n&&!h.test(n)&&a.addWarning({message:"unsupported document encoding <"+n+">, falling back to UTF-8"})}}).on("closeTag",function(){c.pop().handleEnd()}).on("cdata",m).on("text",function(e,t,n){!function(e,t){(e=e.trim())&&m(e,t)}(t(e),n)}).on("error",u).on("warn",d),setTimeout(function(){var t;try{s.parse(e),function(){var e,t,n=a.elementsById,i=a.references;for(e=0;t=i[e];e++){var r=t.element,o=n[t.id],s=Li(r).propertiesByName[t.property];if(o||a.addWarning({message:"unresolved reference <"+t.id+">",element:t.element,property:t.property,value:t.id}),s.isMany){var c=r.get(s.name),u=c.indexOf(t);-1===u&&(u=c.length),o?c[u]=o:c.splice(u,1)}else r.set(s.name,o)}}()}catch(e){t=e}var r=i.element;t||r||(t=Bi("failed to parse document as <"+i.type.$descriptor.name+">")),n(t,t?void 0:r,a)},0)},Yi.prototype.handler=function(e){return new qi(this.model,e)};var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.Writer=function(e){return e=(0,l.assign)({format:!1,preamble:!0},e||{}),{toXML:function(t,n){var i=n||new function(){this.value="",this.write=function(e){this.value+=e}},r=new function(e,t){var n=[""];this.append=function(t){return e.write(t),this},this.appendNewLine=function(){return t&&e.write("\n"),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}(i,e.format);if(e.preamble&&r.append(Zi),(new lr).build(t).serializeTo(r),!n)return i.value}}};var Zi='<?xml version="1.0" encoding="UTF-8"?>\n',Qi=/<|>|'|"|&|\n\r|\n/g,Ji=/<|>|&/g;function er(e){var t={},n={},i={},r=[],o=[];this.byUri=function(t){return n[t]||e&&e.byUri(t)},this.add=function(e,t){n[e.uri]=e,t?r.push(e):o.push(e),this.mapPrefix(e.prefix,e.uri)},this.uriByPrefix=function(e){return t[e||"xmlns"]},this.mapPrefix=function(e,n){t[e||"xmlns"]=n},this.logUsed=function(e){var t=e.uri;i[t]=this.byUri(t)},this.getUsed=function(e){return[].concat(r,o).filter(function(e){return i[e.uri]})}}function tr(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function nr(e){return(0,l.isString)(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function ir(e,t){return t.isGeneric?(0,l.assign)({localName:t.ns.localName},e):(0,l.assign)({localName:(n=t.ns.localName,i=t.$pkg,(0,Fn.hasLowerCaseAlias)(i)?(r=n).charAt(0).toLowerCase()+r.slice(1):n)},e);var n,i,r}var rr={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},or={"<":"lt",">":"gt","&":"amp"};function ar(e,t,n){return(e=(0,l.isString)(e)?e:""+e).replace(t,function(e){return"&"+n[e]+";"})}function sr(e){this.tagName=e}function cr(){}function ur(e){this.tagName=e}function lr(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function dr(e,t){lr.call(this,e,t)}sr.prototype.build=function(e){return this.element=e,this},sr.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},cr.prototype.serializeValue=cr.prototype.serializeTo=function(e){e.append(this.escape?ar(this.value,Ji,or):this.value)},cr.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(Ji)&&(this.escape=!0),this},tr(ur,cr),ur.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},lr.prototype.build=function(e){this.element=e;var t,n,i,r=e.$descriptor,o=this.propertyDescriptor,a=r.isGeneric;return t=a?this.parseGeneric(e):this.parseNsAttributes(e),this.ns=o?this.nsPropertyTagName(o):this.nsTagName(r),this.tagName=this.addTagName(this.ns),a||(n=function(e){var t=e.$descriptor;return(0,l.filter)(t.properties,function(t){var n=t.name;if(t.isVirtual)return!1;if(!e.hasOwnProperty(n))return!1;var i=e[n];return i!==t.default&&null!==i&&(!t.isMany||i.length)})}(e),this.parseAttributes((i=n,(0,l.filter)(i,function(e){return e.isAttr}))),this.parseContainments(function(e){return(0,l.filter)(e,function(e){return!e.isAttr})}(n))),this.parseGenericAttributes(e,t),this},lr.prototype.nsTagName=function(e){return ir(this.logNamespaceUsed(e.ns),e)},lr.prototype.nsPropertyTagName=function(e){return function(e,t){return(0,l.assign)({localName:t.ns.localName},e)}(this.logNamespaceUsed(e.ns),e)},lr.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},lr.prototype.nsAttributeName=function(e){var t;if(t=(0,l.isString)(e)?(0,Yn.parseName)(e):e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:(0,l.assign)({localName:t.localName},n)},lr.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return(0,l.forEach)(e,function(r,o){"$body"===o?n.push((new cr).build({type:"String"},r)):"$children"===o?(0,l.forEach)(r,function(e){n.push(new lr(t).build(e))}):0!==o.indexOf("$")&&t.parseNsAttribute(e,o,r)&&i.push({name:o,value:r})}),i},lr.prototype.parseNsAttribute=function(e,t,n){var i,r=e.$model,o=(0,Yn.parseName)(t);if("xmlns"===o.prefix&&(i={prefix:o.localName,uri:n}),o.prefix||"xmlns"!==o.localName||(i={uri:n}),!i)return{name:t,value:n};if(r&&r.getPackage(n))this.logNamespace(i,!0,!0);else{var a=this.logNamespaceUsed(i,!0);this.getNamespaces().logUsed(a)}},lr.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,r=[];return(0,l.forEach)(i,function(t,i){var o=n.parseNsAttribute(e,i,t);o&&r.push(o)}),r},lr.prototype.parseGenericAttributes=function(e,t){var n=this;(0,l.forEach)(t,function(t){if(t.name!==Fn.XSI_TYPE)try{n.addAttribute(n.nsAttributeName(t.name),t.value)}catch(n){console.warn("missing namespace information for ",t.name,"=",t.value,"on",e,n)}})},lr.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;(0,l.forEach)(e,function(e){var r=i.get(e.name),o=e.isReference;if(e.isMany||(r=[r]),e.isBody)n.push((new cr).build(e,r[0]));else if((0,ti.isSimple)(e.type))(0,l.forEach)(r,function(i){n.push(new ur(t.addTagName(t.nsPropertyTagName(e))).build(e,i))});else if(o)(0,l.forEach)(r,function(i){n.push(new sr(t.addTagName(t.nsPropertyTagName(e))).build(i))});else{var a=(0,Fn.serializeAsType)(e),s=(0,Fn.serializeAsProperty)(e);(0,l.forEach)(r,function(i){var r;r=a?new dr(t,e):s?new lr(t,e):new lr(t),n.push(r.build(i))})}})},lr.prototype.getNamespaces=function(e){var t,n=this.namespaces,i=this.parent;return n||(t=i&&i.getNamespaces(),e||!t?this.namespaces=n=new er(t):n=t),n},lr.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),r=e.uri,o=e.prefix;return i.byUri(r)||i.add(e,t),i.mapPrefix(o,r),e},lr.prototype.logNamespaceUsed=function(e,t){var n,i,r,o=this.element.$model,a=this.getNamespaces(t),s=e.prefix,c=e.uri;if(!s&&!c)return{localName:e.localName};if(r=Fn.DEFAULT_NS_MAP[s]||o&&(o.getPackage(s)||{}).uri,!(c=c||r||a.uriByPrefix(s)))throw new Error("no namespace uri given for prefix <"+s+">");if(!(e=a.byUri(c))){for(n=s,i=1;a.uriByPrefix(n);)n=s+"_"+i++;e=this.logNamespace({prefix:n,uri:c},r===c)}return s&&a.mapPrefix(s,c),e},lr.prototype.parseAttributes=function(e){var t=this,n=this.element;(0,l.forEach)(e,function(e){var i=n.get(e.name);if(e.isReference)if(e.isMany){var r=[];(0,l.forEach)(i,function(e){r.push(e.id)}),i=r.join(" ")}else i=i.id;t.addAttribute(t.nsAttributeName(e),i)})},lr.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),nr(e)},lr.prototype.addAttribute=function(e,t){var n=this.attrs;(0,l.isString)(t)&&(t=ar(t,Qi,rr)),n.push({name:e,value:t})},lr.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=function(e){return(0,l.map)(e.getUsed(),function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}})}(n).concat(t)),(0,l.forEach)(t,function(t){e.append(" ").append(nr(t.name)).append('="').append(t.value).append('"')})},lr.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==cr;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),(0,l.forEach)(this.body,function(t){t.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()},tr(dr,lr),dr.prototype.parseNsAttributes=function(e){var t=lr.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var r=e.$model.getPackage(i.uri),o=r.xml&&r.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(Fn.XSI_TYPE),(i.prefix?i.prefix+":":"")+o+n.ns.localName),t},dr.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};var pr={};Object.defineProperty(pr,"__esModule",{value:!0}),Object.defineProperty(pr,"Reader",{enumerable:!0,get:function(){return Ni.Reader}}),Object.defineProperty(pr,"Writer",{enumerable:!0,get:function(){return Xi.Writer}});var fr={};Object.defineProperty(fr,"__esModule",{value:!0}),fr.default=mr;var hr=function(e){return e&&e.__esModule?e:{default:e}}(hi);function mr(e,t){hr.default.call(this,e,t)}mr.prototype=Object.create(hr.default.prototype),mr.prototype.fromXML=function(e,t,n,i){(0,l.isString)(t)||(i=n,n=t,t="cmmn:Definitions"),(0,l.isFunction)(n)&&(i=n,n={});var r=new pr.Reader((0,l.assign)({model:this,lax:!0},n)),o=r.handler(t);r.fromXML(e,o,i)},mr.prototype.toXML=function(e,t,n){(0,l.isFunction)(t)&&(n=t,t={});var i,r,o=new pr.Writer(t);try{i=o.toXML(e)}catch(e){r=e}return n(r,i)};var yr={};Object.defineProperty(yr,"__esModule",{value:!0}),yr.default=function(e,t){var n=(0,l.assign)({},wr,e);return new vr.default(n,t)};var vr=Er(fr),gr=Er({name:"CMMN",uri:"http://www.omg.org/spec/CMMN/20151109/MODEL",types:[{name:"ApplicabilityRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["CMMNElement"]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"CMMNElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"CMMNElement",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"ManualActivationRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Case",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"caseFileModel",type:"CaseFile",xml:{serialize:"property"}},{name:"casePlanModel",type:"Stage",xml:{serialize:"property"}},{name:"caseRoles",type:"CaseRoles"},{name:"input",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}}]},{name:"CaseFile",superClass:["CMMNElement"],properties:[{name:"caseFileItems",type:"CaseFileItem",isMany:!0}]},{name:"CaseFileItem",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"multiplicity",type:"String",isAttr:!0,default:"Unspecified"},{name:"definitionRef",type:"CaseFileItemDefinition",isAttr:!0,isReference:!0},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"targetRefs",type:"CaseFileItem",isAttr:!0,isReference:!0,isMany:!0},{name:"children",type:"Children",xml:{serialize:"property"}}]},{name:"CaseFileItemDefinition",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"definitionType",type:"String",default:"http://www.omg.org/spec/CMMN/DefinitionType/Unspecified",isAttr:!0},{name:"properties",type:"Property",isMany:!0},{name:"structureRef",type:"String",isAttr:!0},{name:"importRef",type:"Import",isAttr:!0,isReference:!0}]},{name:"CaseFileItemOnPart",superClass:["OnPart"],properties:[{name:"standardEvent",type:"String"},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"CaseParameter",superClass:["Parameter"],properties:[{name:"bindingRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"bindingRefinement",type:"Expression",xml:{serialize:"property"}}]},{name:"CaseRoles",superClass:["Parameter"],properties:[{name:"role",type:"Role",isMany:!0}]},{name:"CaseTask",superClass:["Task"],properties:[{name:"parameterMapping",type:"ParameterMapping",isMany:!0},{name:"caseRefExpression",type:"Expression",xml:{serialize:"property"}},{name:"caseRef",type:"String",isAttr:!0}]},{name:"Children",superClass:["CMMNElement"],properties:[{name:"caseFileItems",type:"CaseFileItem",isMany:!0}]},{name:"CMMNElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionElements",type:"ExtensionElements"},{name:"extensionDefinitions",type:"ExtensionDefinition",isReference:!0,isMany:!0}]},{name:"Definitions",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",type:"String",isAttr:!0},{name:"expressionLanguage",type:"String",isAttr:!0,default:"http://www.w3.org/1999/XPath"},{name:"exporter",isAttr:!0,type:"String"},{name:"exporterVersion",isAttr:!0,type:"String"},{name:"author",isAttr:!0,type:"String"},{name:"creationDate",type:"DateTime",isAttr:!0},{name:"imports",type:"Import",isMany:!0},{name:"caseFileItemDefinitions",type:"CaseFileItemDefinition",isMany:!0},{name:"cases",type:"Case",isMany:!0},{name:"processes",type:"Process",isMany:!0},{name:"decisions",type:"Decision",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"relationships",type:"Relationship",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"CMMNDI",type:"cmmndi:CMMNDI"}]},{name:"DiscretionaryItem",superClass:["TableItem"],properties:[{name:"itemControl",type:"PlanItemControl",xml:{serialize:"property"}},{name:"definitionRef",type:"PlanItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"entryCriteria",type:"EntryCriterion",isMany:!0},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"EventListener",superClass:["PlanItemDefinition"]},{name:"Expression",superClass:["CMMNElement"],properties:[{name:"language",type:"String",isAttr:!0},{name:"body",isBody:!0,type:"String"}]},{name:"HumanTask",superClass:["Task"],properties:[{name:"planningTable",type:"PlanningTable"},{name:"performerRef",type:"Role",isAttr:!0,isReference:!0}]},{name:"IfPart",superClass:["CMMNElement"],properties:[{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"condition",type:"Expression",xml:{serialize:"property"}}]},{name:"Import",properties:[{name:"location",isAttr:!0,type:"String"},{name:"namespace",type:"String",isAttr:!0},{name:"importType",isAttr:!0,type:"String"}]},{name:"Milestone",superClass:["PlanItemDefinition"]},{name:"On",isAbstract:!0,superClass:["CMMNElement"]},{name:"OnPart",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"Parameter",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ParameterMapping",properties:[{name:"sourceRef",type:"Parameter",isAttr:!0,isReference:!0},{name:"targetRef",type:"Parameter",isAttr:!0,isReference:!0},{name:"transformation",type:"Expression",xml:{serialize:"property"}}]},{name:"PlanFragment",superClass:["PlanItemDefinition"],properties:[{name:"planItems",type:"PlanItem",isMany:!0},{name:"sentries",type:"Sentry",isMany:!0}]},{name:"PlanItem",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"definitionRef",type:"PlanItemDefinition",isAttr:!0,isReference:!0},{name:"itemControl",type:"PlanItemControl",xml:{serialize:"property"}},{name:"entryCriteria",type:"EntryCriterion",isMany:!0},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"PlanItemControl",superClass:["CMMNElement"],properties:[{name:"repetitionRule",type:"RepetitionRule"},{name:"requiredRule",type:"RequiredRule"},{name:"manualActivationRule",type:"ManualActivationRule"}]},{name:"PlanItemDefinition",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"defaultControl",type:"PlanItemControl",xml:{serialize:"property"}}]},{name:"PlanItemOnPart",superClass:["OnPart"],properties:[{name:"standardEvent",type:"String"},{name:"sourceRef",type:"PlanItem",isAttr:!0,isReference:!0},{name:"exitCriterionRef",type:"ExitCriterion",isAttr:!0,isReference:!0}]},{name:"PlanningTable",superClass:["TableItem"],properties:[{name:"tableItems",type:"TableItem",isMany:!0},{name:"applicabilityRules",type:"ApplicabilityRule",isMany:!0}]},{name:"Process",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"implementationType",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/ProcessType/Unspecified"},{name:"externalRef",type:"String",isAttr:!0},{name:"input",type:"ProcessParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"ProcessParameter",isMany:!0,xml:{serialize:"property"}}]},{name:"ProcessParameter",superClass:["Parameter"]},{name:"ProcessTask",superClass:["Task"],properties:[{name:"parameterMapping",type:"ParameterMapping",isMany:!0},{name:"processRefExpression",type:"Expression",xml:{serialize:"property"}},{name:"processRef",type:"String",isAttr:!0}]},{name:"Property",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/PropertyType/Unspecified"}]},{name:"RepetitionRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"RequiredRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Role",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"Sentry",superClass:["CMMNElement"],properties:[{name:"onParts",type:"OnPart",isMany:!0},{name:"ifPart",type:"IfPart"},{name:"name",isAttr:!0,type:"String"}]},{name:"Stage",superClass:["PlanFragment"],properties:[{name:"planningTable",type:"PlanningTable"},{name:"planItemDefinitions",type:"PlanItemDefinition",isMany:!0},{name:"autoComplete",isAttr:!0,type:"Boolean"},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"TableItem",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"authorizedRoleRefs",type:"Role",isAttr:!0,isReference:!0,isMany:!0},{name:"applicabilityRuleRefs",type:"ApplicabilityRule",isAttr:!0,isReference:!0,isMany:!0}]},{name:"Task",superClass:["PlanItemDefinition"],properties:[{name:"input",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"isBlocking",isAttr:!0,default:!0,type:"Boolean"}]},{name:"TimerEventListener",superClass:["EventListener"],properties:[{name:"timerExpression",type:"Expression",xml:{serialize:"property"}},{name:"timerStart",type:"StartTrigger"}]},{name:"UserEventListener",superClass:["EventListener"],properties:[{name:"authorizedRoleRefs",type:"Role",isMany:!0,isAttr:!0}]},{name:"DateTime",superClass:[]},{name:"StartTrigger",isAbstract:!0,superClass:["CMMNElement"]},{name:"PlanItemStartTrigger",superClass:["StartTrigger"],properties:[{name:"standardEvent",type:"String",isAttr:!0},{name:"sourceRef",type:"PlanItem",isAttr:!0,isReference:!0}]},{name:"CaseFileItemStartTrigger",superClass:["StartTrigger"],properties:[{name:"standardEvent",type:"String",isAttr:!0},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition"}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",isAttr:!0,default:!1,type:"Boolean"}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Relationship",properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,type:"Element"},{name:"target",isMany:!0,type:"Element"}]},{name:"Documentation",superClass:["CMMNElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"DecisionTask",superClass:["Task"],properties:[{name:"mappings",type:"ParameterMapping",isMany:!0},{name:"decisionRef",type:"String",isAttr:!0},{name:"decisionRefExpression",type:"Expression",xml:{serialize:"property"}}]},{name:"Decision",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"implementationType",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/DecisionType/Unspecified"},{name:"input",type:"DecisionParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"DecisionParameter",isMany:!0,xml:{serialize:"property"}},{name:"externalRef",type:"String",isAttr:!0}]},{name:"DecisionParameter",superClass:["Parameter"]},{name:"Criterion",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sentryRef",type:"Sentry",isAttr:!0,isReference:!0}]},{name:"EntryCriterion",superClass:["Criterion"]},{name:"ExitCriterion",superClass:["Criterion"]}],emumerations:[{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"CaseFileItemTransition",literalValues:[{name:"addChild"},{name:"addReference"},{name:"create"},{name:"delete"},{name:"removeChild"},{name:"removeReference"},{name:"replace"},{name:"update"}]},{name:"MultiplicityEnum",literalValues:[{name:"ZeroOrOne"},{name:"ZeroOrMore"},{name:"ExactlyOne"},{name:"OneOrMore"},{name:"Unspecified"},{name:"Unknown"}]},{name:"PlanItemTransition",literalValues:[{name:"close"},{name:"complete"},{name:"create"},{name:"disable"},{name:"enable"},{name:"exit"},{name:"fault"},{name:"manualStart"},{name:"occur"},{name:"parentResume"},{name:"parentSuspend"},{name:"reactivate"},{name:"reenable"},{name:"resume"},{name:"start"},{name:"suspend"},{name:"terminate"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]}],associations:[],xml:{tagAlias:"lowerCase",typePrefix:"t"},prefix:"cmmn"}),_r=Er({name:"CMMNDI",uri:"http://www.omg.org/spec/CMMN/20151109/CMMNDI",types:[{name:"CMMNDI",properties:[{name:"diagrams",type:"CMMNDiagram",isMany:!0},{name:"styles",type:"CMMNStyle",isMany:!0}]},{name:"CMMNDiagram",properties:[{name:"cmmnElementRef",isAttr:!0,type:"cmmn:CMMNElement",isReference:!0},{name:"Size",type:"dc:Dimension",xml:{serialize:"xsi:type"}},{name:"diagramElements",type:"CMMNDiagramElement",isMany:!0}],superClass:["di:Diagram"]},{name:"CMMNDiagramElement",superClass:["di:DiagramElement"]},{name:"CMMNShape",properties:[{name:"cmmnElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"label",type:"CMMNLabel"},{name:"isCollapsed",isAttr:!0,type:"Boolean"},{name:"isPlanningTableCollapsed",isAttr:!0,type:"Boolean"}],superClass:["CMMNDiagramElement","di:Shape"]},{name:"CMMNEdge",properties:[{name:"label",type:"CMMNLabel"},{name:"cmmnElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"sourceCMMNElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"targetCMMNElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"isStandardEventVisible",type:"Boolean",isAttr:!0}],superClass:["CMMNDiagramElement","di:Edge"]},{name:"CMMNLabel",superClass:["di:Shape"]},{name:"CMMNStyle",properties:[{name:"FillColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"StrokeColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"FontColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"fontFamily",type:"String",isAttr:!0},{name:"fontSize",type:"Real",isAttr:!0},{name:"fontItalic",type:"Boolean",isAttr:!0},{name:"fontBold",type:"Boolean",isAttr:!0},{name:"fontUnderline",type:"Boolean",isAttr:!0},{name:"fontStrikeThrough",type:"Boolean",isAttr:!0}],superClass:["di:Style"]}],associations:[],prefix:"cmmndi"}),xr=Er({name:"DC",uri:"http://www.omg.org/spec/CMMN/20151109/DC",types:[{name:"rgb"},{name:"Real"},{name:"Color",properties:[{name:"red",type:"rgb",isAttr:!0},{name:"green",type:"rgb",isAttr:!0},{name:"blue",type:"rgb",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",isAttr:!0},{name:"y",type:"Real",isAttr:!0}]},{name:"Dimension",properties:[{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",isAttr:!0},{name:"y",type:"Real",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],prefix:"dc",associations:[]}),br=Er({name:"DI",uri:"http://www.omg.org/spec/CMMN/20151109/DI",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"extension",type:"Extension"},{name:"style",type:"Style"},{name:"sharedStyle",type:"Style",isReference:!0,isAttr:!0},{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"waypoint",isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"name",type:"String",isAttr:!0},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,default:300,type:"double"}]},{name:"Shape",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"extension",type:"Extension"},{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Extension",properties:[{name:"values",type:"Element",isMany:!0}]}],associations:[],prefix:"di",xml:{tagAlias:"lowerCase"}});function Er(e){return e&&e.__esModule?e:{default:e}}var wr={cmmn:gr.default,cmmndi:_r.default,dc:xr.default,di:br.default},Mr={};Object.defineProperty(Mr,"__esModule",{value:!0}),Object.defineProperty(Mr,"default",{enumerable:!0,get:function(){return(e=yr,e&&e.__esModule?e:{default:e}).default;var e}});var Sr={};function Cr(e,t,n){var i=!n||-1===e.indexOf(t);return i&&e.push(t),i}function Pr(e,t,n){n=n||0,(0,l.isArray)(e)||(e=[e]),(0,l.forEach)(e,function(e,i){var r=t(e,i,n);(0,l.isArray)(r)&&r.length&&Pr(r,t,n+1)})}function Rr(e,t,n){var i=[],r=[];return Pr(e,function(e,o,a){Cr(i,e,t);var s=e.children;if((-1===n||a<n)&&s&&Cr(r,s,t))return s}),i}function Tr(e,t){var n,i,r,o;return t=!!t,(0,l.isArray)(e)||(e=[e]),(0,l.forEach)(e,function(e){var a=e;e.waypoints&&!t&&(a=Tr(e.waypoints,!0));var s=a.x,c=a.y,u=a.height||0,l=a.width||0;(s<n||void 0===n)&&(n=s),(c<i||void 0===i)&&(i=c),(s+l>r||void 0===r)&&(r=s+l),(c+u>o||void 0===o)&&(o=c+u)}),{x:n,y:i,height:o-i,width:r-n}}function kr(e,t){return(0,l.assign)({},e||{},t||{})}Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.eachElement=Pr,Sr.selfAndAllChildren=function(e,t){return Rr(e,!t,-1)},Sr.getClosure=function(e,t,n){(0,l.isUndefined)(t)&&(t=!0);(0,l.isObject)(t)&&(n=t,t=!0);var i=kr((n=n||{}).allShapes),r=kr(n.allConnections),o=kr(n.enclosedElements),a=kr(n.enclosedConnections),s=kr(n.topLevel,t&&(0,l.groupBy)(e,function(e){return e.id}));function c(e){s[e.source.id]&&s[e.target.id]&&(s[e.id]=[e]),i[e.source.id]&&i[e.target.id]&&(a[e.id]=o[e.id]=e),r[e.id]=e}return Pr(e,function(e){if(o[e.id]=e,!e.waypoints)return i[e.id]=e,(0,l.forEach)(e.incoming,c),(0,l.forEach)(e.outgoing,c),e.children;a[e.id]=r[e.id]=e}),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:a,enclosedElements:o}},Sr.getBBox=Tr,Sr.getEnclosedElements=function(e,t){var n={};return(0,l.forEach)(e,function(e){var i=e;i.waypoints&&(i=Tr(i)),!(0,l.isNumber)(t.y)&&i.x>t.x&&(n[e.id]=e),!(0,l.isNumber)(t.x)&&i.y>t.y&&(n[e.id]=e),i.x>t.x&&i.y>t.y&&((0,l.isNumber)(t.width)&&(0,l.isNumber)(t.height)&&i.width+i.x<t.width+t.x&&i.height+i.y<t.height+t.y?n[e.id]=e:(0,l.isNumber)(t.width)&&(0,l.isNumber)(t.height)||(n[e.id]=e))}),n},Sr.getType=function(e){if("waypoints"in e)return"connection";if("x"in e)return"shape";return"root"};var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});var Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function jr(e,t){return Math.round(e*t)/t}function Nr(e){return(0,l.isNumber)(e)?e+"px":e}function Ir(e,t,n){var i=(0,Ee.create)("g");(0,Ee.classes)(i).add(t);var r=void 0!==n?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[r]||null),i}Ar.default=Br;var Dr={shape:["x","y","width","height"],connection:["waypoints"]};function Br(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._init(e||{})}function Lr(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}Br.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],Br.prototype._init=function(e){var t=this._eventBus,n=this._container=function(e){var t=(e=(0,l.assign)({},{width:"100%",height:"100%"},e)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),(0,l.assign)(n.style,{position:"relative",overflow:"hidden",width:Nr(e.width),height:Nr(e.height)}),t.appendChild(n),n}(e),i=this._svg=(0,Ee.create)("svg");(0,Ee.attr)(i,{width:"100%",height:"100%"}),(0,Ee.append)(n,i);var r=this._viewport=Ir(i,"viewport");this._layers={},!1!==e.deferUpdate&&(this._viewboxChanged=(0,l.debounce)((0,l.bind)(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:r})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)},Br.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},Br.prototype._clear=function(){var e=this;this._elementRegistry.getAll().forEach(function(t){var n=(0,Sr.getType)(t);"root"===n?e.setRootElement(null,!0):e._removeElement(t,n)}),delete this._cachedViewbox},Br.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},Br.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),void 0!==t&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group},Br.prototype._createLayer=function(e,t){t||(t=0);var n=(0,l.reduce)(this._layers,function(e,n){return t>=n.index&&e++,e},0);return{group:Ir(this._viewport,"layer-"+e,n),index:t}},Br.prototype.getContainer=function(){return this._container},Br.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),(i=this._elementRegistry._elements[e.id])&&((0,l.forEach)([i.gfx,i.secondaryGfx],function(e){e&&(n?(0,Ee.classes)(e).add(t):(0,Ee.classes)(e).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))},Br.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)},Br.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)},Br.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return(0,Ee.classes)(n).has(t)},Br.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)},Br.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},Br.prototype.setRootElement=function(e,t){e&&this._ensureValid("root",e);var n=this._rootElement,i=this._elementRegistry,r=this._eventBus;if(n){if(!t)throw new Error("rootElement already set, need to specify override");r.fire("root.remove",{element:n}),r.fire("root.removed",{element:n}),i.remove(n)}if(e){var o=this.getDefaultLayer();r.fire("root.add",{element:e}),i.add(e,o,this._svg),r.fire("root.added",{element:e,gfx:o})}return this._rootElement=e,e},Br.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=Dr[e];if(!(0,l.every)(n,function(e){return void 0!==t[e]}))throw new Error("must supply { "+n.join(", ")+" } with "+e)},Br.prototype._setParent=function(e,t,n){(0,Sn.add)(t.children,e,n),e.parent=t},Br.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var r=this._eventBus,o=this._graphicsFactory;this._ensureValid(e,t),r.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var a=o.create(e,t,i);return this._elementRegistry.add(t,a),o.update(e,t,a),r.fire(e+".added",{element:t,gfx:a}),t},Br.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)},Br.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)},Br.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(e=n.get(e.id||e))return r.fire(t+".remove",{element:e}),i.remove(e),(0,Sn.remove)(e.parent&&e.parent.children,e),e.parent=null,r.fire(t+".removed",{element:e}),n.remove(e),e},Br.prototype.removeShape=function(e){return this._removeElement(e,"shape")},Br.prototype.removeConnection=function(e){return this._removeElement(e,"connection")},Br.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)},Br.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()},Br.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},Br.prototype.viewbox=function(e){if(void 0===e&&this._cachedViewbox)return this._cachedViewbox;var t,n,i,r,o,a,s=this._viewport,c=this.getSize();return e?(this._changeViewbox(function(){r=Math.min(c.width/e.width,c.height/e.height);var t=this._svg.createSVGMatrix().scale(r).translate(-e.x,-e.y);(0,Ee.transform)(s,t)}),e):(t=this.getDefaultLayer().getBBox(),n=(i=(0,Ee.transform)(s))?i.matrix:(0,Ee.createMatrix)(),r=jr(n.a,1e3),o=jr(-n.e||0,1e3),a=jr(-n.f||0,1e3),e=this._cachedViewbox={x:o?o/r:0,y:a?a/r:0,width:c.width/r,height:c.height/r,scale:r,inner:{width:t.width,height:t.height,x:t.x,y:t.y},outer:c})},Br.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=(0,l.assign)({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),Lr(t,n)}),{x:n.e,y:n.f}},Br.prototype.zoom=function(e,t){return e?"fit-viewport"===e?this._fitViewport(t):(this._changeViewbox(function(){"object"!==(void 0===t?"undefined":Or(t))&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),jr(i.a,1e3)):this.viewbox(e).scale;var n,i},Br.prototype._fitViewport=function(e){var t,n,i=this.viewbox(),r=i.outer,o=i.inner;return o.x>=0&&o.y>=0&&o.x+o.width<=r.width&&o.y+o.height<=r.height&&!e?n={x:0,y:0,width:Math.max(o.width+o.x,r.width),height:Math.max(o.height+o.y,r.height)}:(t=Math.min(1,r.width/o.width,r.height/o.height),n={x:o.x+(e?o.width/2-r.width/t/2:0),y:o.y+(e?o.height/2-r.height/t/2:0),width:r.width/t,height:r.height/t}),this.viewbox(n),this.viewbox(!1).scale},Br.prototype._setZoom=function(e,t){var n,i,r,o,a=this._svg,s=this._viewport,c=a.createSVGMatrix(),u=a.createSVGPoint(),d=(i=s.getCTM()).a;return t?(n=(0,l.assign)(u,t).matrixTransform(i.inverse()),r=c.translate(n.x,n.y).scale(1/d*e).translate(-n.x,-n.y),o=i.multiply(r)):o=c.scale(e),Lr(this._viewport,o),o},Br.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},Br.prototype.getAbsoluteBBox=function(e){var t,n=this.viewbox();e.waypoints?t=this.getGraphics(e).getBBox():t=e;return{x:t.x*n.scale-n.x*n.scale,y:t.y*n.scale-n.y*n.scale,width:t.width*n.scale,height:t.height*n.scale}},Br.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var zr={};function Fr(){this._uid=12}Object.defineProperty(zr,"__esModule",{value:!0}),zr.default=Fr,Fr.prototype.createRoot=function(e){return this.create("root",e)},Fr.prototype.createLabel=function(e){return this.create("label",e)},Fr.prototype.createShape=function(e){return this.create("shape",e)},Fr.prototype.createConnection=function(e){return this.create("connection",e)},Fr.prototype.create=function(e,t){return(t=(0,l.assign)({},t||{})).id||(t.id=e+"_"+this._uid++),(0,B.create)(e,t)};var $r={};Object.defineProperty($r,"__esModule",{value:!0}),$r.default=Ur;var Hr="data-element-id";function Ur(e){this._elements={},this._eventBus=e}Ur.$inject=["eventBus"],Ur.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),(0,Ee.attr)(t,Hr,i),n&&(0,Ee.attr)(n,Hr,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}},Ur.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&((0,Ee.attr)(i.gfx,Hr,""),i.secondaryGfx&&(0,Ee.attr)(i.secondaryGfx,Hr,""),delete t[n])},Ur.prototype.updateId=function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)},Ur.prototype.get=function(e){var t;t="string"==typeof e?e:e&&(0,Ee.attr)(e,Hr);var n=this._elements[t];return n&&n.element},Ur.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t},Ur.prototype.getAll=function(){return this.filter(function(e){return e})},Ur.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],r=i.element,o=i.gfx;return e(r,o)})},Ur.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)},Ur.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0});var Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Wr.default=qr;var Gr=Array.prototype.slice;function qr(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function Kr(){}qr.prototype.on=function(e,t,n,i){if(e=(0,l.isArray)(e)?e:[e],(0,l.isFunction)(t)&&(i=n,n=t,t=1e3),!(0,l.isNumber)(t))throw new Error("priority must be a number");var r=n;i&&((r=(0,l.bind)(n,i)).__fn=n.__fn||n);var o=this;e.forEach(function(e){o._addListener(e,{priority:t,callback:r,next:null})})},qr.prototype.once=function(e,t,n,i){var r=this;if((0,l.isFunction)(t)&&(i=n,n=t,t=1e3),!(0,l.isNumber)(t))throw new Error("priority must be a number");function o(){var t=n.apply(i,arguments);return r.off(e,o),t}o.__fn=n,this.on(e,t,o)},qr.prototype.off=function(e,t){e=(0,l.isArray)(e)?e:[e];var n=this;e.forEach(function(e){n._removeListener(e,t)})},qr.prototype.createEvent=function(e){var t=new Kr;return t.init(e),t},qr.prototype.fire=function(e,t){var n,i,r,o;if(o=Gr.call(arguments),"object"===(void 0===e?"undefined":Vr(e))&&(e=(n=e).type),!e)throw new Error("no event type specified");if(i=this._listeners[e]){n=t instanceof Kr?t:this.createEvent(t),o[0]=n;var a=n.type;e!==a&&(n.type=e);try{r=this._invokeListeners(n,o,i)}finally{e!==a&&(n.type=a)}return void 0===r&&n.defaultPrevented&&(r=!1),r}},qr.prototype.handleError=function(e){return!1===this.fire("error",{error:e})},qr.prototype._destroy=function(){this._listeners={}},qr.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i},qr.prototype._invokeListener=function(e,t,n){var i;try{void 0!==(i=function(e,t){return e.apply(null,t)}(n.callback,t))&&(e.returnValue=i,e.stopPropagation()),!1===i&&e.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener"),console.error(e.stack),e}return i},qr.prototype._addListener=function(e,t){var n,i=this._getListeners(e);if(i){for(;i;){if(i.priority<t.priority)return t.next=i,void(n?n.next=t:this._setListeners(e,t));n=i,i=i.next}n.next=t}else this._setListeners(e,t)},qr.prototype._getListeners=function(e){return this._listeners[e]},qr.prototype._setListeners=function(e,t){this._listeners[e]=t},qr.prototype._removeListener=function(e,t){var n,i,r,o=this._getListeners(e);if(t)for(;o;)n=o.next,(r=o.callback)!==t&&r.__fn!==t||(i?i.next=n:this._setListeners(e,n)),i=o,o=n;else this._setListeners(e,null)},Kr.prototype.stopPropagation=function(){this.cancelBubble=!0},Kr.prototype.preventDefault=function(){this.defaultPrevented=!0},Kr.prototype.init=function(e){(0,l.assign)(this,e||{})};var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.getVisual=function(e){return(0,at.query)(".djs-visual",e)},Yr.getChildren=function(e){return e.parentNode.childNodes[1]};var Xr={};function Zr(e,t){this._eventBus=e,this._elementRegistry=t}function Qr(e,t,n){t.insertBefore(e,n||t.firstChild)}Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.default=Zr,Zr.$inject=["eventBus","elementRegistry"],Zr.prototype._getChildren=function(e){var t,n=this._elementRegistry.getGraphics(e);return e.parent?(t=(0,Yr.getChildren)(n))||(t=(0,Ee.create)("g"),(0,Ee.classes)(t).add("djs-children"),(0,Ee.append)(n.parentNode,t)):t=n,t},Zr.prototype._clear=function(e){var t=(0,Yr.getVisual)(e);return(0,at.clear)(t),t},Zr.prototype._createContainer=function(e,t,n){var i=(0,Ee.create)("g");(0,Ee.classes)(i).add("djs-group"),void 0!==n?Qr(i,t,t.childNodes[n]):(0,Ee.append)(t,i);var r=(0,Ee.create)("g");(0,Ee.classes)(r).add("djs-element"),(0,Ee.classes)(r).add("djs-"+e),(0,Ee.append)(i,r);var o=(0,Ee.create)("g");return(0,Ee.classes)(o).add("djs-visual"),(0,Ee.append)(r,o),r},Zr.prototype.create=function(e,t,n){var i=this._getChildren(t.parent);return this._createContainer(e,i,n)},Zr.prototype.updateContainments=function(e){var t,n=this,i=this._elementRegistry;t=(0,l.reduce)(e,function(e,t){return t.parent&&(e[t.parent.id]=t.parent),e},{}),(0,l.forEach)(t,function(e){var t=e.children;if(t){var r=n._getChildren(e);(0,l.forEach)(t.slice().reverse(),function(e){Qr(i.getGraphics(e).parentNode,r)})}})},Zr.prototype.drawShape=function(e,t){return this._eventBus.fire("render.shape",{gfx:e,element:t})},Zr.prototype.getShapePath=function(e){return this._eventBus.fire("render.getShapePath",e)},Zr.prototype.drawConnection=function(e,t){return this._eventBus.fire("render.connection",{gfx:e,element:t})},Zr.prototype.getConnectionPath=function(e){return this._eventBus.fire("render.getConnectionPath",e)},Zr.prototype.update=function(e,t,n){if(t.parent){var i=this._clear(n);if("shape"===e)this.drawShape(i,t),(0,Ze.translate)(n,t.x,t.y);else{if("connection"!==e)throw new Error("unknown type: "+e);this.drawConnection(i,t)}t.hidden?(0,Ee.attr)(n,"display","none"):(0,Ee.attr)(n,"display","block")}},Zr.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);(0,Ee.remove)(t.parentNode)};var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.default=ro;var eo=no(u),to=no(_e);function no(e){return e&&e.__esModule?e:{default:e}}var io=1;function ro(e,t){to.default.call(this,e,io),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2})}(0,eo.default)(ro,to.default),ro.prototype.canRender=function(){return!0},ro.prototype.drawShape=function(e,t){var n=(0,Ee.create)("rect");return(0,Ee.attr)(n,{x:0,y:0,width:t.width||0,height:t.height||0}),(0,Ee.attr)(n,this.SHAPE_STYLE),(0,Ee.append)(e,n),n},ro.prototype.drawConnection=function(e,t){var n=(0,Ye.createLine)(t.waypoints,this.CONNECTION_STYLE);return(0,Ee.append)(e,n),n},ro.prototype.getShapePath=function(e){var t=e.x,n=e.y,i=e.width,r=[["M",t,n],["l",i,0],["l",0,e.height],["l",-i,0],["z"]];return(0,Ye.componentsToPath)(r)},ro.prototype.getConnectionPath=function(e){var t,n,i=e.waypoints,r=[];for(t=0;n=i[t];t++)n=n.original||n,r.push([0===t?"M":"L",n.x,n.y]);return(0,Ye.componentsToPath)(r)},ro.$inject=["eventBus","styles"];var oo={};Object.defineProperty(oo,"__esModule",{value:!0}),oo.default=function(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(e,t,n){var i=this.style(t,n);return(0,l.assign)(i,{class:e})},this.style=function(t,n){(0,l.isArray)(t)||n||(n=t,t=[]);var i=(0,l.reduce)(t,function(t,n){return(0,l.assign)(t,e[n]||{})},{});return n?(0,l.assign)(i,n):i},this.computeStyle=function(e,n,i){return(0,l.isArray)(n)||(i=n,n=[]),t.style(n||[],(0,l.assign)({},i,e||{}))}};var ao={};Object.defineProperty(ao,"__esModule",{value:!0});var so=uo(Jr),co=uo(oo);function uo(e){return e&&e.__esModule?e:{default:e}}ao.default={__init__:["defaultRenderer"],defaultRenderer:["type",so.default],styles:["type",co.default]};var lo={};Object.defineProperty(lo,"__esModule",{value:!0});var po=go(ao),fo=go(Ar),ho=go($r),mo=go(zr),yo=go(Wr),vo=go(Xr);function go(e){return e&&e.__esModule?e:{default:e}}lo.default={__depends__:[po.default],__init__:["canvas"],canvas:["type",fo.default],elementRegistry:["type",ho.default],elementFactory:["type",mo.default],eventBus:["type",yo.default],graphicsFactory:["type",vo.default]};var _o={},xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(_o,"__esModule",{value:!0});var bo=/^class /;function Eo(e){return"[object Array]"===Object.prototype.toString.call(e)}function wo(){var e=Array.prototype.slice.call(arguments);1===e.length&&Eo(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var Mo=/constructor\s*[^(]*\(\s*([^)]*)\)/m,So=/^function\s*[^(]*\(\s*([^)]*)\)/m,Co=/\/\*([^*]*)\*\//m;function Po(e){if("function"!=typeof e)throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(function(e){return bo.test(e.toString())}(e)?Mo:So);return t&&t[1]&&t[1].split(",").map(function(e){return(t=e.match(Co))?t[1].trim():e.trim()})||[]}function Ro(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}}var To="function"==typeof Symbol&&"symbol"===xo(Symbol.iterator)?function(e){return void 0===e?"undefined":xo(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":xo(e)};function ko(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Ao(e,t){return Object.hasOwnProperty.call(e,t)}_o.Injector=function e(t,n){n=n||{get:function(e,t){if(i.push(e),!1===t)return null;throw s('No provider for "'+e+'"!')}};var i=[],r=this._providers=Object.create(n._providers||null),o=this._instances=Object.create(null),a=o.injector=this,s=function(e){var t=i.join(" -> ");return i.length=0,new Error(t?e+" (Resolving: "+t+")":e)},c=function e(t,a){if(!r[t]&&-1!==t.indexOf(".")){for(var c=t.split("."),u=e(c.shift());c.length;)u=u[c.shift()];return u}if(Ao(o,t))return o[t];if(Ao(r,t)){if(-1!==i.indexOf(t))throw i.push(t),s("Cannot resolve circular dependency!");return i.push(t),o[t]=r[t][0](r[t][1]),i.pop(),o[t]}return n.get(t,a)},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof e){if(!Eo(e))throw new Error('Cannot invoke "'+e+'". Expected a function!');e=wo(e.slice())}return{fn:e,dependencies:(e.$inject||Po(e)).map(function(e){return Ao(t,e)?t[e]:c(e)})}},l=function(e){var t=u(e),n=t.dependencies,i=t.fn;return new(Function.prototype.bind.apply(i,[null].concat(ko(n))))},d=function(e,t,n){var i=u(e,n),r=i.dependencies,o=i.fn;return o.call.apply(o,[t].concat(ko(r)))},p=function(e){return wo(function(t){return e.get(t)})},f={factory:d,type:l,value:function(e){return e}};t.forEach(function(t){function n(e,t){return"value"!==e&&Eo(t)&&(t=wo(t.slice())),t}if(t instanceof Ro)t.forEach(function(e){var t=e[0],i=e[1],o=e[2];r[t]=[f[i],n(i,o),i]});else if("object"===(void 0===t?"undefined":To(t)))if(t.__exports__){var i=Object.keys(t).reduce(function(e,n){return"__"!==n.substring(0,2)&&(e[n]=t[n]),e},Object.create(null)),o=new e((t.__modules__||[]).concat([i]),a),s=wo(function(e){return o.get(e)});t.__exports__.forEach(function(e){r[e]=[s,e,"private",o]})}else Object.keys(t).forEach(function(e){if("private"!==t[e][2]){var i=t[e][0],o=t[e][1];r[e]=[f[i],n(i,o),i]}else r[e]=t[e]})}),this.get=c,this.invoke=d,this.instantiate=l,this.createChild=function(t,n){if(n&&n.length){var i,o,s,c,u=Object.create(null),l=Object.create(null),d=[],f=[],h=[];for(var m in r)i=r[m],-1!==n.indexOf(m)&&("private"===i[2]?-1===(o=d.indexOf(i[3]))?(s=i[3].createChild([],n),c=p(s),d.push(i[3]),f.push(s),h.push(c),u[m]=[c,m,"private",s]):u[m]=[h[o],m,"private",f[o]]:u[m]=[i[2],i[1]],l[m]=!0),"factory"!==i[2]&&"type"!==i[2]||!i[1].$scope||n.forEach(function(e){-1!==i[1].$scope.indexOf(e)&&(u[m]=[i[2],i[1]],l[e]=!0)});n.forEach(function(e){if(!l[e])throw new Error('No provider for "'+e+'". Cannot use provider from the parent!')}),t.unshift(u)}return new e(t,a)}};var Oo={};Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.default=Io;var jo=function(e){return e&&e.__esModule?e:{default:e}}(lo);function No(e){var t=[],n=[];function i(e){return t.indexOf(e)>=0}e.forEach(function e(r){i(r)||((r.__depends__||[]).forEach(e),i(r)||(function(e){t.push(e)}(r),(r.__init__||[]).forEach(function(e){n.push(e)})))});var r=new _o.Injector(t);return n.forEach(function(e){try{r["string"==typeof e?"get":"invoke"](e)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),r}function Io(e,t){this.injector=t=t||function(e){return No([{config:["value",e=e||{}]},jo.default].concat(e.modules||[]))}(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}Io.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},Io.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};var Do={};Object.defineProperty(Do,"__esModule",{value:!0}),Object.defineProperty(Do,"default",{enumerable:!0,get:function(){return(e=Oo,e&&e.__esModule?e:{default:e}).default;var e}});var Bo={};function Lo(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.default=Lo,Lo.prototype.next=function(){return this._prefix+ ++this._counter};var zo={};Object.defineProperty(zo,"__esModule",{value:!0}),zo.default=$o;var Fo=new(function(e){return e&&e.__esModule?e:{default:e}}(Bo).default)("ov");function $o(e,t,n,i){var r,o;this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=Fo,this._overlayDefaults=(0,l.assign)({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(r=n.getContainer(),o=(0,at.domify)('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),r.insertBefore(o,r.firstChild),o),this._init()}function Ho(e,t,n){(0,l.assign)(e.style,{left:t+"px",top:n+"px"})}function Uo(e,t){e.style.display=!1===t?"none":""}function Wo(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}$o.$inject=["config.overlays","eventBus","canvas","elementRegistry"],$o.prototype.get=function(e){if((0,l.isString)(e)&&(e={id:e}),(0,l.isString)(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?(0,l.filter)(t.overlays,(0,l.matchPattern)({type:e.type})):t.overlays.slice():[]}return e.type?(0,l.filter)(this._overlays,(0,l.matchPattern)({type:e.type})):e.id?this._overlays[e.id]:null},$o.prototype.add=function(e,t,n){if((0,l.isObject)(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=(0,l.assign)({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i},$o.prototype.remove=function(e){var t=this.get(e)||[];(0,l.isArray)(t)||(t=[t]);var n=this;(0,l.forEach)(t,function(e){var t=n._getOverlayContainer(e.element,!0);if(e&&((0,at.remove)(e.html),(0,at.remove)(e.htmlContainer),delete e.htmlContainer,delete e.element,delete n._overlays[e.id]),t){var i=t.overlays.indexOf(e);-1!==i&&t.overlays.splice(i,1)}})},$o.prototype.show=function(){Uo(this._overlayRoot)},$o.prototype.hide=function(){Uo(this._overlayRoot,!1)},$o.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,at.clear)(this._overlayRoot)},$o.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,r=t.y;if(t.waypoints){var o=(0,Sr.getBBox)(t);i=o.x,r=o.y}Ho(n,i,r),(0,at.attr)(e.html,"data-container-id",t.id)},$o.prototype._updateOverlay=function(e){var t,n,i=e.position,r=e.htmlContainer,o=e.element,a=i.left,s=i.top;void 0!==i.right&&(t=o.waypoints?(0,Sr.getBBox)(o).width:o.width,a=-1*i.right+t);void 0!==i.bottom&&(n=o.waypoints?(0,Sr.getBBox)(o).height:o.height,s=-1*i.bottom+n);Ho(r,a||0,s||0)},$o.prototype._createOverlayContainer=function(e){var t=(0,at.domify)('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},$o.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";Wo(this._overlayRoot,n)},$o.prototype._getOverlayContainer=function(e,t){var n=(0,l.find)(this._overlayContainers,function(t){return t.element===e});return n||t?n:this._createOverlayContainer(e)},$o.prototype._addOverlay=function(e){var t,n,i=e.id,r=e.element,o=e.html;o.get&&o.constructor.prototype.jquery&&(o=o.get(0)),(0,l.isString)(o)&&(o=(0,at.domify)(o)),n=this._getOverlayContainer(r),(t=(0,at.domify)('<div class="djs-overlay" data-overlay-id="'+i+'" style="position: absolute">')).appendChild(o),e.type&&(0,at.classes)(t).add("djs-overlay-"+e.type),e.htmlContainer=t,n.overlays.push(e),n.html.appendChild(t),this._overlays[i]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},$o.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=n&&n.minZoom,r=n&&n.maxZoom,o=e.htmlContainer,a=!0;n&&(((0,l.isDefined)(i)&&i>t.scale||(0,l.isDefined)(r)&&r<t.scale)&&(a=!1),Uo(o,a)),this._updateOverlayScale(e,t)},$o.prototype._updateOverlayScale=function(e,t){var n,i,r,o=e.scale,a=e.htmlContainer,s="";!0!==o&&(!1===o?(n=1,i=1):(n=o.min,i=o.max),(0,l.isDefined)(n)&&t.scale<n&&(r=(1/t.scale||1)*n),(0,l.isDefined)(i)&&t.scale>i&&(r=(1/t.scale||1)*i)),(0,l.isDefined)(r)&&(s="scale("+r+","+r+")"),Wo(a,s)},$o.prototype._updateOverlaysVisibilty=function(e){var t=this;(0,l.forEach)(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})},$o.prototype._init=function(){var e=this._eventBus,t=this;e.on("canvas.viewbox.changing",function(e){t.hide()}),e.on("canvas.viewbox.changed",function(e){var n;n=e.viewbox,t._updateRoot(n),t._updateOverlaysVisibilty(n),t.show()}),e.on(["shape.remove","connection.remove"],function(e){var n=e.element,i=t.get({element:n});(0,l.forEach)(i,function(e){t.remove(e.id)});var r=t._getOverlayContainer(n);if(r){(0,at.remove)(r.html);var o=t._overlayContainers.indexOf(r);-1!==o&&t._overlayContainers.splice(o,1)}}),e.on("element.changed",500,function(e){var n=e.element,i=t._getOverlayContainer(n,!0);i&&((0,l.forEach)(i.overlays,function(e){t._updateOverlay(e)}),t._updateOverlayContainer(i))}),e.on("element.marker.update",function(e){var n=t._getOverlayContainer(e.element,!0);n&&(0,at.classes)(n.html)[e.add?"add":"remove"](e.marker)}),e.on("diagram.clear",this.clear,this)};var Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});var Go=function(e){return e&&e.__esModule?e:{default:e}}(zo);Vo.default={__init__:["overlays"],overlays:["type",Go.default]};var qo={};function Ko(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function Yo(e){return e.originalEvent||e.srcEvent}Object.defineProperty(qo,"__esModule",{value:!0}),qo.getOriginal=Yo,qo.stopPropagation=function(e,t){Ko(e),Ko(Yo(e))},qo.toPoint=function(e){e.pointers&&e.pointers.length&&(e=e.pointers[0]);e.touches&&e.touches.length&&(e=e.touches[0]);return e?{x:e.clientX,y:e.clientY}:null};var Xo={};Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.isMac=function(){return/mac/i.test(navigator.platform)};var Zo={};function Qo(e){return!((0,qo.getOriginal)(e)||e).button}Object.defineProperty(Zo,"__esModule",{value:!0}),Object.defineProperty(Zo,"isMac",{enumerable:!0,get:function(){return Xo.isMac}}),Zo.isPrimaryButton=Qo,Zo.hasPrimaryModifier=function(e){var t=(0,qo.getOriginal)(e)||e;if(!Qo(e))return!1;return(0,Xo.isMac)()?t.metaKey:t.ctrlKey},Zo.hasSecondaryModifier=function(e){var t=(0,qo.getOriginal)(e)||e;return Qo(e)&&t.shiftKey};var Jo={};function ea(e){return!0}Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.default=na;var ta=500;function na(e,t,n){var i=n.cls("djs-hit",["no-fill","no-border"],{stroke:"white",strokeWidth:15});function r(n,i,r){var o,a;(function(e,t){return!(c[e]||Zo.isPrimaryButton)(t)})(n,i)||(r?a=t.getGraphics(r):(o=i.delegateTarget||i.target)&&(a=o,r=t.get(a)),a&&r&&!1===e.fire(n,{element:r,gfx:a,originalEvent:i})&&(i.stopPropagation(),i.preventDefault()))}var o={};function a(e){return o[e]}var s={mouseover:"element.hover",mouseout:"element.out",click:"element.click",dblclick:"element.dblclick",mousedown:"element.mousedown",mouseup:"element.mouseup",contextmenu:"element.contextmenu"},c={"element.contextmenu":ea};var u="svg, .djs-element";function d(e,t,n,i){var a=o[n]=function(e){r(n,e)};i&&(c[n]=i),a.$delegate=at.delegate.bind(e,u,t,a)}function p(e,t,n){var i=a(n);i&&at.delegate.unbind(e,t,i.$delegate)}e.on("canvas.destroy",function(e){var t;t=e.svg,(0,l.forEach)(s,function(e,n){p(t,n,e)})}),e.on("canvas.init",function(e){var t;t=e.svg,(0,l.forEach)(s,function(e,n){d(t,n,e)})}),e.on(["shape.added","connection.added"],function(e){var t,n=e.element,r=e.gfx;n.waypoints?t=(0,Ye.createLine)(n.waypoints):(t=(0,Ee.create)("rect"),(0,Ee.attr)(t,{x:0,y:0,width:n.width,height:n.height})),(0,Ee.attr)(t,i),(0,Ee.append)(r,t)}),e.on("shape.changed",ta,function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-hit",n);(0,Ee.attr)(i,{width:t.width,height:t.height})}),e.on("connection.changed",function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-hit",n);(0,Ye.updateLine)(i,t.waypoints)}),this.fire=r,this.triggerMouseEvent=function(e,t,n){var i=s[e];if(!i)throw new Error("unmapped DOM event name <"+e+">");return r(i,t,n)},this.mouseHandler=a,this.registerEvent=d,this.unregisterEvent=p}na.$inject=["eventBus","elementRegistry","styles"];var ia={};Object.defineProperty(ia,"__esModule",{value:!0});var ra=function(e){return e&&e.__esModule?e:{default:e}}(Jo);ia.default={__init__:["interactionEvents"],interactionEvents:["type",ra.default]};var oa={};Object.defineProperty(oa,"__esModule",{value:!0}),oa.default=sa;var aa=500;function sa(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),r=this;function o(e,t){var n=(0,Ee.create)("rect");return(0,Ee.attr)(n,(0,l.assign)({x:10,y:10,width:100,height:100},i)),(0,Ee.append)(e,n),n}e.on(["shape.added","shape.changed"],aa,function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-outline",n);i||(i=o(n)),r.updateShapeOutline(i,t)}),e.on(["connection.added","connection.changed"],function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-outline",n);i||(i=o(n)),r.updateConnectionOutline(i,t)})}sa.prototype.updateShapeOutline=function(e,t){(0,Ee.attr)(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},sa.prototype.updateConnectionOutline=function(e,t){var n=(0,Sr.getBBox)(t);(0,Ee.attr)(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},sa.$inject=["eventBus","styles","elementRegistry"];var ca={};Object.defineProperty(ca,"__esModule",{value:!0});var ua=function(e){return e&&e.__esModule?e:{default:e}}(oa);ca.default={__init__:["outline"],outline:["type",ua.default]};var la={};function da(e){this._eventBus=e,this._selectedElements=[];var t=this;e.on(["shape.remove","connection.remove"],function(e){var n=e.element;t.deselect(n)}),e.on(["diagram.clear"],function(e){t.select(null)})}Object.defineProperty(la,"__esModule",{value:!0}),la.default=da,da.$inject=["eventBus"],da.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(-1!==n){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}},da.prototype.get=function(){return this._selectedElements},da.prototype.isSelected=function(e){return-1!==this._selectedElements.indexOf(e)},da.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();(0,l.isArray)(e)||(e=e?[e]:[]),t?(0,l.forEach)(e,function(e){-1===n.indexOf(e)&&n.push(e)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var pa={};function fa(e,t,n,i){e.on("create.end",500,function(e){e.context.canExecute&&t.select(e.context.shape)}),e.on("connect.end",500,function(e){e.context.canExecute&&e.context.target&&t.select(e.context.target)}),e.on("shape.move.end",500,function(e){var n=e.previousSelection||[],r=i.get(e.context.shape.id);(0,l.find)(n,function(e){return r.id===e.id})||t.select(r)}),e.on("element.click",function(e){var i=e.element;i===n.getRootElement()&&(i=null);var r=t.isSelected(i),o=t.get().length>1,a=(0,Zo.hasPrimaryModifier)(e);if(r&&o)return a?t.deselect(i):t.select(i);r?t.deselect(i):t.select(i,a)})}Object.defineProperty(pa,"__esModule",{value:!0}),pa.default=fa,fa.$inject=["eventBus","selection","canvas","elementRegistry"];var ha={};Object.defineProperty(ha,"__esModule",{value:!0}),ha.default=va;var ma="hover",ya="selected";function va(e,t,n,i){function r(e,n){t.addMarker(e,n)}function o(e,n){t.removeMarker(e,n)}this._multiSelectionBox=null,e.on("element.hover",function(e){r(e.element,ma)}),e.on("element.out",function(e){o(e.element,ma)}),e.on("selection.changed",function(e){var t=e.oldSelection,n=e.newSelection;(0,l.forEach)(t,function(e){-1===n.indexOf(e)&&o(e,ya)}),(0,l.forEach)(n,function(e){-1===t.indexOf(e)&&r(e,ya)})})}va.$inject=["eventBus","canvas","selection","styles"];var ga={};Object.defineProperty(ga,"__esModule",{value:!0});var _a=Ma(ia),xa=Ma(ca),ba=Ma(la),Ea=Ma(ha),wa=Ma(pa);function Ma(e){return e&&e.__esModule?e:{default:e}}ga.default={__init__:["selectionVisuals","selectionBehavior"],__depends__:[_a.default,xa.default],selection:["type",ba.default],selectionVisuals:["type",Ea.default],selectionBehavior:["type",wa.default]};var Sa=l.assign,Ca=l.omit,Pa=l.isNumber,Ra=at.domify,Ta=at.query,ka=at.remove,Aa=Ee.innerSVG,Oa=Do.default,ja=Mr.default;var Na={width:"100%",height:"100%",position:"relative"};function Ia(e){return e+(Pa(e)?"px":"")}function Da(e){var t,n,i;e=Sa({},Na,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),t=this._container,n=jn.BPMNIO_IMG,i=Ra('<a href="http://bpmn.io" target="_blank" class="cjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100">'+n+"</a>"),t.appendChild(i),La.bind(i,"click",function(e){jn.open(),e.preventDefault()}),this._init(this._container,this._moddle,e)}u(Da,Oa);var Ba=Da;Da.prototype.importXML=function(e,t){t=t||function(){};var n=this;e=this._emit("import.parse.start",{xml:e})||e,this._moddle.fromXML(e,"cmmn:Definitions",function(e,i,r){i=n._emit("import.parse.complete",{error:e,definitions:i,context:r})||i;var o=r.warnings;if(e)return e=function(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);return t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid CMMN 1.1 diagram file"+t[2]),e}(e),n._emit("import.done",{error:e,warnings:o}),t(e,o);n.importDefinitions(i,function(e,i){var r=[].concat(o,i||[]);n._emit("import.done",{error:e,warnings:r}),t(e,r)})})},Da.prototype.saveXML=function(e,t){t||(t=e,e={});var n=this,i=this._definitions;if(!i)return t(new Error("no definitions loaded"));i=this._emit("saveXML.start",{definitions:i})||i,this._moddle.toXML(i,e,function(e,i){try{i=n._emit("saveXML.serialized",{error:e,xml:i})||i,n._emit("saveXML.done",{error:e,xml:i})}catch(e){console.error("error in saveXML life-cycle listener",e)}t(e,i)})},Da.prototype.saveSVG=function(e,t){t||(t=e,e={});var n=this.get("canvas"),i=n.getDefaultLayer(),r=Ta("defs",n._svg),o=Aa(i),a=r&&r.outerHTML||"",s=i.getBBox();t(null,'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with cmmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+s.width+'" height="'+s.height+'" viewBox="'+s.x+" "+s.y+" "+s.width+" "+s.height+'" version="1.1">'+a+o+"</svg>")},Da.prototype.importDefinitions=function(e,t){try{this._definitions&&this.clear(),this._definitions=e,On.importCmmnDiagram(this,e,t)}catch(e){t(e)}},Da.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=Ta(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},Da.prototype.getDefinitions=function(){return this._definitions},Da.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},Da.prototype.getModules=function(){return this._modules},Da.prototype.destroy=function(){Oa.prototype.destroy.call(this),ka(this._container)},Da.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)},Da.prototype.off=function(e,t){this.get("eventBus").off(e,t)},Da.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),r=n.additionalModules||[],o=[].concat([{cmmnjs:["value",this],moddle:["value",t]}],i,r),a=Sa(Ca(n,"additionalModules"),{canvas:Sa({},n.canvas,{container:e}),modules:o});Oa.call(this,a),n&&n.container&&this.attachTo(n.container)},Da.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},Da.prototype._createContainer=function(e){var t=Ra('<div class="cjs-container"></div>');return Sa(t.style,{width:Ia(e.width),height:Ia(e.height),position:e.position}),t},Da.prototype._createModdle=function(e){var t=Sa({},this._moddleExtensions,e.moddleExtensions);return new ja(t)},Da.prototype._modules=[Mn,ga.default,Vo.default];var La=at.event;var za={};Object.defineProperty(za,"__esModule",{value:!0}),za.install=function(e,t){function n(){return!1}return t=t||"element.click",e.once(t,Fa,n),function(){e.off(t,n)}};var Fa=5e3;var $a={};Object.defineProperty($a,"__esModule",{value:!0}),$a.set=Ua,$a.unset=function(){Ua(null)};var Ha=/^djs-cursor-.*$/;function Ua(e){var t=(0,at.classes)(document.body);t.removeMatching(Ha),e&&t.add("djs-cursor-"+e)}var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.center=function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}},Wa.delta=function(e,t){return{x:e.x-t.x,y:e.y-t.y}};var Va={};Object.defineProperty(Va,"__esModule",{value:!0}),Va.default=qa;var Ga=15;function qa(e,t){var n;function i(i){var r,o=n.start,a=(0,qo.toPoint)(i),s=(0,Wa.delta)(a,o);if(!n.dragging&&(r=s,Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))>Ga)&&(n.dragging=!0,(0,za.install)(e),(0,$a.set)("grab")),n.dragging){var c=n.last||n.start;s=(0,Wa.delta)(a,c),t.scroll({dx:s.x,dy:s.y}),n.last=a}i.preventDefault()}function r(e){at.event.unbind(document,"mousemove",i),at.event.unbind(document,"mouseup",r),n=null,(0,$a.unset)()}e.on("element.mousedown",500,function(e){return function(e){if((0,at.closest)(e.target,".djs-draggable"))return;if(e.button||e.ctrlKey||e.shiftKey||e.altKey)return;return n={start:(0,qo.toPoint)(e)},at.event.bind(document,"mousemove",i),at.event.bind(document,"mouseup",r),!0}(e.originalEvent)})}qa.$inject=["eventBus","canvas"];var Ka={};Object.defineProperty(Ka,"__esModule",{value:!0});var Ya=function(e){return e&&e.__esModule?e:{default:e}}(Va);Ka.default={__init__:["moveCanvas"],moveCanvas:["type",Ya.default]};var Xa={};Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.log10=function(e){return Math.log(e)/Math.log(10)},Object.defineProperty(Xa,"substract",{enumerable:!0,get:function(){return Wa.delta}});var Za={};Object.defineProperty(Za,"__esModule",{value:!0}),Za.getStepSize=function(e,t){var n=(0,Xa.log10)(e.min),i=(0,Xa.log10)(e.max);return(Math.abs(n)+Math.abs(i))/t},Za.cap=function(e,t){return Math.max(e.min,Math.min(e.max,t))};var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.default=ns;var Ja=Math.sign||function(e){return e>=0?1:-1},es={min:.2,max:4},ts=.75;function ns(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=(0,l.bind)(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||ts;var i=this;t.on("canvas.init",function(t){i._init(!1!==e.enabled)})}ns.$inject=["config.zoomScroll","eventBus","canvas"],ns.prototype.scroll=function(e){this._canvas.scroll(e)},ns.prototype.reset=function(){this._canvas.zoom("fit-viewport")},ns.prototype.zoom=function(e,t){var n=(0,Za.getStepSize)(es,20);this._totalDelta+=e,Math.abs(this._totalDelta)>.1&&(this._zoom(e,t,n),this._totalDelta=0)},ns.prototype._handleWheel=function(e){if(!(0,at.closest)(e.target,".djs-scrollable",!0)){var t=this._container;e.preventDefault();var n,i=e.ctrlKey,r=e.shiftKey,o=-1*this._scale;if(o*=i?0===e.deltaMode?.02:.32:0===e.deltaMode?1:16,i){var a=t.getBoundingClientRect(),s={x:e.clientX-a.left,y:e.clientY-a.top};n=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*Ja(e.deltaY)*o,this.zoom(n,s)}else n=r?{dx:o*e.deltaY,dy:0}:{dx:o*e.deltaX,dy:o*e.deltaY},this.scroll(n)}},ns.prototype.stepZoom=function(e,t){var n=(0,Za.getStepSize)(es,10);this._zoom(e,t,n)},ns.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,o=(0,Xa.log10)(i.zoom()),a=Math.round(o/n)*n;a+=n*r;var s=Math.pow(10,a);i.zoom((0,Za.cap)(es,s),t)},ns.prototype.toggle=function(e){var t=this._container,n=this._handleWheel,i=this._enabled;return void 0===e&&(e=!i),i!==e&&at.event[e?"bind":"unbind"](t,"wheel",n,!1),this._enabled=e,e},ns.prototype._init=function(e){this.toggle(e)};var is={};Object.defineProperty(is,"__esModule",{value:!0});var rs=function(e){return e&&e.__esModule?e:{default:e}}(Qa);function os(e){Ba.call(this,e)}is.default={__init__:["zoomScroll"],zoomScroll:["type",rs.default]},u(os,Ba);var as=os;os.prototype._navigationModules=[is.default,Ka.default],os.prototype._modules=[].concat(os.prototype._modules,os.prototype._navigationModules);var ss={};Object.defineProperty(ss,"__esModule",{value:!0}),ss.default=cs;function cs(e){this._eventBus=e}cs.$inject=["eventBus"],cs.prototype.on=function(e,t,n,i,r,o){if(((0,l.isFunction)(t)||(0,l.isNumber)(t))&&(o=r,r=i,i=n,n=t,t=null),(0,l.isFunction)(n)&&(o=r,r=i,i=n,n=1e3),(0,l.isObject)(r)&&(o=r,r=!1),!(0,l.isFunction)(i))throw new Error("handlerFn must be a function");(0,l.isArray)(e)||(e=[e]);var a=this._eventBus;(0,l.forEach)(e,function(e){var s=["commandStack",e,t].filter(function(e){return e}).join(".");a.on(s,n,r?function(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}(i,o):i,o)})};(0,l.forEach)(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],function(e){cs.prototype[e]=function(t,n,i,r,o){((0,l.isFunction)(t)||(0,l.isNumber)(t))&&(o=r,r=i,i=n,n=t,t=null),this.on(t,e,n,i,r,o)}});var us={};Object.defineProperty(us,"__esModule",{value:!0}),us.default=fs;var ls=ps(u),ds=ps(ss);function ps(e){return e&&e.__esModule?e:{default:e}}function fs(e){ds.default.call(this,e),this.init()}fs.$inject=["eventBus"],(0,ls.default)(fs,ds.default),fs.prototype.addRule=function(e,t,n){var i=this;"string"==typeof e&&(e=[e]),e.forEach(function(e){i.canExecute(e,t,function(e,t,i){return n(e)},!0)})},fs.prototype.init=function(){};var hs={};Object.defineProperty(hs,"__esModule",{value:!0}),hs.default=gs;var ms=vs(us),ys=vs(u);function vs(e){return e&&e.__esModule?e:{default:e}}function gs(e){ms.default.call(this,e);var t=this;this.addRule("element.autoResize",function(e){return t.canResize(e.elements,e.target)})}gs.$inject=["eventBus"],(0,ys.default)(gs,ms.default),gs.prototype.canResize=function(e,t){return!1};var _s=e.is,xs=e.getDefinition,bs=l.forEach,Es=hs.default;function ws(e){Es.call(this,e)}u(ws,Es),ws.$inject=["eventBus"];var Ms=ws;ws.prototype.canResize=function(e,t){if(_s(t,"cmmn:CMMNElement")){var n=!0;if(bs(e,function(e){_s(e,"cmmn:Criterion")||(n=!1)}),!n){var i=xs(t);return _s(i,"cmmn:PlanFragment")}}};var Ss={};function Cs(e,t){return e&&t?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):-1}Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.pointDistance=Cs,Ss.pointsOnLine=function(e,t,n,i){void 0===i&&(i=5);if(!e||!t||!n)return!1;var r=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),o=Cs(e,t);return Math.abs(r/o)<=i},Ss.pointsAligned=function(e,t){if(Math.abs(e.x-t.x)<=Ps)return"h";if(Math.abs(e.y-t.y)<=Ps)return"v";return!1},Ss.pointInRect=function(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n},Ss.getMidPoint=function(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}};var Ps=2;var Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ts="hasOwnProperty",ks=/,?([a-z]),?/gi,As=parseFloat,Os=Math,js=Os.PI,Ns=Os.min,Is=Os.max,Ds=Os.pow,Bs=Os.abs,Ls=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,zs=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi;function Fs(e,t){return"finite"==(t=String.prototype.toLowerCase.call(t))?isFinite(e):!("array"!=t||!(e instanceof Array||Array.isArray&&Array.isArray(e)))||("null"==t&&null===e||t==(void 0===e?"undefined":Rs(e))&&null!==e||"object"==t&&e===Object(e)||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()==t)}function $s(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[Ts](n)&&(t[n]=$s(e[n]));return t}function Hs(e){var t=Hs.ps=Hs.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[Ts](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function Us(e,t,n,i){return null==e&&(e=t=n=i=0),null==t&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,w:n,height:i,h:i,x2:e+n,y2:t+i,cx:e+n/2,cy:t+i/2,r1:Os.min(n,i)/2,r2:Os.max(n,i)/2,r0:Os.sqrt(n*n+i*i)/2,path:function(e,t,n,i,r){if(r)return[["M",+e+ +r,t],["l",n-2*r,0],["a",r,r,0,0,1,r,r],["l",0,i-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-n,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-i],["a",r,r,0,0,1,r,-r],["z"]];var o=[["M",e,t],["l",n,0],["l",0,i],["l",-n,0],["z"]];return o.toString=Ws,o}(e,t,n,i),vb:[e,t,n,i].join(" ")}}function Ws(){return this.join(",").replace(ks,"$1")}function Vs(e){var t=$s(e);return t.toString=Ws,t}function Gs(e,t,n,i,r,o,a,s,c){var u=1-c,l=Ds(u,3),d=Ds(u,2),p=c*c,f=p*c,h=e+2*c*(n-e)+p*(r-2*n+e),m=t+2*c*(i-t)+p*(o-2*i+t),y=n+2*c*(r-n)+p*(a-2*r+n),v=i+2*c*(o-i)+p*(s-2*o+i);return{x:l*e+3*d*c*n+3*u*c*c*r+f*a,y:l*t+3*d*c*i+3*u*c*c*o+f*s,m:{x:h,y:m},n:{x:y,y:v},start:{x:u*e+c*n,y:u*t+c*i},end:{x:u*r+c*a,y:u*o+c*s},alpha:90-180*Os.atan2(h-y,m-v)/js}}function qs(e,t,n,i,r,o,a,s){Fs(e,"array")||(e=[e,t,n,i,r,o,a,s]);var c=function(e,t,n,i,r,o,a,s){for(var c,u,l,d,p,f,h,m,y=[],v=[[],[]],g=0;g<2;++g)if(0==g?(u=6*e-12*n+6*r,c=-3*e+9*n-9*r+3*a,l=3*n-3*e):(u=6*t-12*i+6*o,c=-3*t+9*i-9*o+3*s,l=3*i-3*t),Bs(c)<1e-12){if(Bs(u)<1e-12)continue;0<(d=-l/u)&&d<1&&y.push(d)}else h=u*u-4*l*c,m=Os.sqrt(h),h<0||(0<(p=(-u+m)/(2*c))&&p<1&&y.push(p),0<(f=(-u-m)/(2*c))&&f<1&&y.push(f));var _,x=y.length,b=x;for(;x--;)d=y[x],_=1-d,v[0][x]=_*_*_*e+3*_*_*d*n+3*_*d*d*r+d*d*d*a,v[1][x]=_*_*_*t+3*_*_*d*i+3*_*d*d*o+d*d*d*s;return v[0][b]=e,v[1][b]=t,v[0][b+1]=a,v[1][b+1]=s,v[0].length=v[1].length=b+2,{min:{x:Ns.apply(0,v[0]),y:Ns.apply(0,v[1])},max:{x:Is.apply(0,v[0]),y:Is.apply(0,v[1])}}}.apply(null,e);return Us(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y)}function Ks(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Ys(e,t,n,i,r){return e*(e*(-3*t+9*n-9*i+3*r)+6*t-12*n+6*i)-3*t+3*n}function Xs(e,t,n,i,r,o,a,s,c){null==c&&(c=1);for(var u=(c=c>1?1:c<0?0:c)/2,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,f=0;f<12;f++){var h=u*l[f]+u,m=Ys(h,e,n,r,a),y=Ys(h,t,i,o,s),v=m*m+y*y;p+=d[f]*Os.sqrt(v)}return u*p}function Zs(e,t,n,i,r,o,a,s){if(!(Is(e,n)<Ns(r,a)||Ns(e,n)>Is(r,a)||Is(t,i)<Ns(o,s)||Ns(t,i)>Is(o,s))){var c=(e-n)*(o-s)-(t-i)*(r-a);if(c){var u=((e*i-t*n)*(r-a)-(e-n)*(r*s-o*a))/c,l=((e*i-t*n)*(o-s)-(t-i)*(r*s-o*a))/c,d=+u.toFixed(2),p=+l.toFixed(2);if(!(d<+Ns(e,n).toFixed(2)||d>+Is(e,n).toFixed(2)||d<+Ns(r,a).toFixed(2)||d>+Is(r,a).toFixed(2)||p<+Ns(t,i).toFixed(2)||p>+Is(t,i).toFixed(2)||p<+Ns(o,s).toFixed(2)||p>+Is(o,s).toFixed(2)))return{x:u,y:l}}}}function Qs(e,t,n){if(!function(e,t){return e=Us(e),Ks(t=Us(t),e.x,e.y)||Ks(t,e.x2,e.y)||Ks(t,e.x,e.y2)||Ks(t,e.x2,e.y2)||Ks(e,t.x,t.y)||Ks(e,t.x2,t.y)||Ks(e,t.x,t.y2)||Ks(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}(qs(e),qs(t)))return n?0:[];for(var i=~~(Xs.apply(0,e)/5),r=~~(Xs.apply(0,t)/5),o=[],a=[],s={},c=n?0:[],u=0;u<i+1;u++){var l=Gs.apply(0,e.concat(u/i));o.push({x:l.x,y:l.y,t:u/i})}for(u=0;u<r+1;u++)l=Gs.apply(0,t.concat(u/r)),a.push({x:l.x,y:l.y,t:u/r});for(u=0;u<i;u++)for(var d=0;d<r;d++){var p=o[u],f=o[u+1],h=a[d],m=a[d+1],y=Bs(f.x-p.x)<.01?"y":"x",v=Bs(m.x-h.x)<.01?"y":"x",g=Zs(p.x,p.y,f.x,f.y,h.x,h.y,m.x,m.y);if(g){if(s[g.x.toFixed(0)]==g.y.toFixed(0))continue;s[g.x.toFixed(0)]=g.y.toFixed(0);var _=p.t+Bs((g[y]-p[y])/(f[y]-p[y]))*(f.t-p.t),x=h.t+Bs((g[v]-h[v])/(m[v]-h[v]))*(m.t-h.t);_>=0&&_<=1&&x>=0&&x<=1&&(n?c++:c.push({x:g.x,y:g.y,t1:_,t2:x}))}}return c}function Js(e,t,n,i,r){if(null==r&&null==i&&(i=n),e=+e,t=+t,n=+n,i=+i,null!=r)var o=Math.PI/180,a=e+n*Math.cos(-i*o),s=e+n*Math.cos(-r*o),c=[["M",a,t+n*Math.sin(-i*o)],["A",n,n,0,+(r-i>180),0,s,t+n*Math.sin(-r*o)]];else c=[["M",e,t],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]];return c.toString=Ws,c}function ec(e){var t=Hs(e);if(t.abs)return Vs(t.abs);if(Fs(e,"array")&&Fs(e&&e[0],"array")||(e=function(e){if(!e)return null;var t=Hs(e);if(t.arr)return $s(t.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},i=[];return Fs(e,"array")&&Fs(e[0],"array")&&(i=$s(e)),i.length||String(e).replace(Ls,function(e,t,r){var o=[],a=t.toLowerCase();if(r.replace(zs,function(e,t){t&&o.push(+t)}),"m"==a&&o.length>2&&(i.push([t].concat(o.splice(0,2))),a="l",t="m"==t?"l":"L"),"o"==a&&1==o.length&&i.push([t,o[0]]),"r"==a)i.push([t].concat(o));else for(;o.length>=n[a]&&(i.push([t].concat(o.splice(0,n[a]))),n[a]););}),i.toString=Hs.toString,t.arr=$s(i),i}(e)),!e||!e.length)return[["M",0,0]];var n,i=[],r=0,o=0,a=0,s=0,c=0;"M"==e[0][0]&&(a=r=+e[0][1],s=o=+e[0][2],c++,i[0]=["M",r,o]);for(var u,l,d=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),p=c,f=e.length;p<f;p++){if(i.push(u=[]),(n=(l=e[p])[0])!=n.toUpperCase())switch(u[0]=n.toUpperCase(),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+l[6]+r,u[7]=+l[7]+o;break;case"V":u[1]=+l[1]+o;break;case"H":u[1]=+l[1]+r;break;case"R":for(var h=[r,o].concat(l.slice(1)),m=2,y=h.length;m<y;m++)h[m]=+h[m]+r,h[++m]=+h[m]+o;i.pop(),i=i.concat(rc(h,d));break;case"O":i.pop(),(h=Js(r,o,l[1],l[2])).push(h[0]),i=i.concat(h);break;case"U":i.pop(),i=i.concat(Js(r,o,l[1],l[2],l[3])),u=["U"].concat(i[i.length-1].slice(-2));break;case"M":a=+l[1]+r,s=+l[2]+o;default:for(m=1,y=l.length;m<y;m++)u[m]=+l[m]+(m%2?r:o)}else if("R"==n)h=[r,o].concat(l.slice(1)),i.pop(),i=i.concat(rc(h,d)),u=["R"].concat(l.slice(-2));else if("O"==n)i.pop(),(h=Js(r,o,l[1],l[2])).push(h[0]),i=i.concat(h);else if("U"==n)i.pop(),i=i.concat(Js(r,o,l[1],l[2],l[3])),u=["U"].concat(i[i.length-1].slice(-2));else for(var v=0,g=l.length;v<g;v++)u[v]=l[v];if("O"!=(n=n.toUpperCase()))switch(u[0]){case"Z":r=+a,o=+s;break;case"H":r=u[1];break;case"V":o=u[1];break;case"M":a=u[u.length-2],s=u[u.length-1];default:r=u[u.length-2],o=u[u.length-1]}}return i.toString=Ws,t.abs=Vs(i),i}function tc(e,t,n,i){return[e,t,n,i,n,i]}function nc(e,t,n,i,r,o){return[1/3*e+2/3*n,1/3*t+2/3*i,1/3*r+2/3*n,1/3*o+2/3*i,r,o]}function ic(e,t,n,i,r,o,a,s,c,u){var l,d,p,f,h=120*js/180,m=js/180*(+r||0),y=[],v=(d=function(e,t,n){return{x:e*Os.cos(n)-t*Os.sin(n),y:e*Os.sin(n)+t*Os.cos(n)}},function e(){var t=Array.prototype.slice.call(arguments,0),n=t.join("␀"),i=e.cache=e.cache||{},r=e.count=e.count||[];return i[Ts](n)?(function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}(r,n),f?f(i[n]):i[n]):(r.length>=1e3&&delete i[r.shift()],r.push(n),i[n]=d.apply(p,t),f?f(i[n]):i[n])});if(u)C=u[0],P=u[1],M=u[2],S=u[3];else{e=(l=v(e,t,-m)).x,t=l.y;var g=(e-(s=(l=v(s,c,-m)).x))/2,_=(t-(c=l.y))/2,x=g*g/(n*n)+_*_/(i*i);x>1&&(n*=x=Os.sqrt(x),i*=x);var b=n*n,E=i*i,w=(o==a?-1:1)*Os.sqrt(Bs((b*E-b*_*_-E*g*g)/(b*_*_+E*g*g))),M=w*n*_/i+(e+s)/2,S=w*-i*g/n+(t+c)/2,C=Os.asin(((t-S)/i).toFixed(9)),P=Os.asin(((c-S)/i).toFixed(9));(C=e<M?js-C:C)<0&&(C=2*js+C),(P=s<M?js-P:P)<0&&(P=2*js+P),a&&C>P&&(C-=2*js),!a&&P>C&&(P-=2*js)}var R=P-C;if(Bs(R)>h){var T=P,k=s,A=c;P=C+h*(a&&P>C?1:-1),y=ic(s=M+n*Os.cos(P),c=S+i*Os.sin(P),n,i,r,0,a,k,A,[P,T,M,S])}R=P-C;var O=Os.cos(C),j=Os.sin(C),N=Os.cos(P),I=Os.sin(P),D=Os.tan(R/4),B=4/3*n*D,L=4/3*i*D,z=[e,t],F=[e+B*j,t-L*O],$=[s+B*I,c-L*N],H=[s,c];if(F[0]=2*z[0]-F[0],F[1]=2*z[1]-F[1],u)return[F,$,H].concat(y);for(var U=[],W=0,V=(y=[F,$,H].concat(y).join().split(",")).length;W<V;W++)U[W]=W%2?v(y[W-1],y[W],m).y:v(y[W],y[W+1],m).x;return U}function rc(e,t){for(var n=[],i=0,r=e.length;r-2*!t>i;i+=2){var o=[{x:+e[i-2],y:+e[i-1]},{x:+e[i],y:+e[i+1]},{x:+e[i+2],y:+e[i+3]},{x:+e[i+4],y:+e[i+5]}];t?i?r-4==i?o[3]={x:+e[0],y:+e[1]}:r-2==i&&(o[2]={x:+e[0],y:+e[1]},o[3]={x:+e[2],y:+e[3]}):o[0]={x:+e[r-2],y:+e[r-1]}:r-4==i?o[3]=o[2]:i||(o[0]={x:+e[i],y:+e[i+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n}function oc(e,t){var n=!t&&Hs(e);if(!t&&n.curve)return Vs(n.curve);for(var i=ec(e),r=t&&ec(t),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=function(e,t,n){var i,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(ic.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==n||"S"==n?(i=2*t.x-t.bx,r=2*t.y-t.by):(i=t.x,r=t.y),e=["C",i,r].concat(e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(nc(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(nc(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(tc(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(tc(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(tc(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(tc(t.x,t.y,t.X,t.Y))}return e},c=function(e,t){if(e[t].length>7){e[t].shift();for(var n=e[t];n.length;)l[t]="A",r&&(d[t]="A"),e.splice(t++,0,["C"].concat(n.splice(0,6)));e.splice(t,1),m=Is(i.length,r&&r.length||0)}},u=function(e,t,n,o,a){e&&t&&"M"==e[a][0]&&"M"!=t[a][0]&&(t.splice(a,0,["M",o.x,o.y]),n.bx=0,n.by=0,n.x=e[a][1],n.y=e[a][2],m=Is(i.length,r&&r.length||0))},l=[],d=[],p="",f="",h=0,m=Is(i.length,r&&r.length||0);h<m;h++){i[h]&&(p=i[h][0]),"C"!=p&&(l[h]=p,h&&(f=l[h-1])),i[h]=s(i[h],o,f),"A"!=l[h]&&"C"==p&&(l[h]="C"),c(i,h),r&&(r[h]&&(p=r[h][0]),"C"!=p&&(d[h]=p,h&&(f=d[h-1])),r[h]=s(r[h],a,f),"A"!=d[h]&&"C"==p&&(d[h]="C"),c(r,h)),u(i,r,o,a,h),u(r,i,a,o,h);var y=i[h],v=r&&r[h],g=y.length,_=r&&v.length;o.x=y[g-2],o.y=y[g-1],o.bx=As(y[g-4])||o.x,o.by=As(y[g-3])||o.y,a.bx=r&&(As(v[_-4])||a.x),a.by=r&&(As(v[_-3])||a.y),a.x=r&&v[_-2],a.y=r&&v[_-1]}return r||(n.curve=Vs(i)),r?[i,r]:i}var ac=function(e,t,n){e=oc(e),t=oc(t);for(var i,r,o,a,s,c,u,l,d,p,f=n?0:[],h=0,m=e.length;h<m;h++){var y=e[h];if("M"==y[0])i=s=y[1],r=c=y[2];else{"C"==y[0]?(i=(d=[i,r].concat(y.slice(1)))[6],r=d[7]):(d=[i,r,i,r,s,c,s,c],i=s,r=c);for(var v=0,g=t.length;v<g;v++){var _=t[v];if("M"==_[0])o=u=_[1],a=l=_[2];else{"C"==_[0]?(o=(p=[o,a].concat(_.slice(1)))[6],a=p[7]):(p=[o,a,o,a,u,l,u,l],o=u,a=l);var x=Qs(d,p,n);if(n)f+=x;else{for(var b=0,E=x.length;b<E;b++)x[b].segment1=h,x[b].segment2=v,x[b].bez1=d,x[b].bez2=p;f=f.concat(x)}}}}}return f},sc={};Object.defineProperty(sc,"__esModule",{value:!0}),sc.roundBounds=function(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}},sc.roundPoint=uc,sc.asTRBL=lc,sc.asBounds=function(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}},sc.getMid=function(e){return uc({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})},sc.getOrientation=function(e,t,n){n=n||0,(0,l.isObject)(n)||(n={x:n,y:n});var i=lc(e),r=lc(t),o=i.bottom+n.y<=r.top,a=i.left-n.x>=r.right,s=i.top-n.y>=r.bottom,c=i.right+n.x<=r.left,u=o?"top":s?"bottom":null,d=c?"left":a?"right":null;return d&&u?u+"-"+d:d||u||"intersect"},sc.getElementLineIntersection=function(e,t,n){var i=dc(e,t);if(1===i.length)return uc(i[0]);if(2===i.length&&(0,Ss.pointDistance)(i[0],i[1])<1)return uc(i[0]);if(i.length>1)return uc((i=(0,l.sortBy)(i,function(e){var t=Math.floor(100*e.t2)||1;return t=((t=100-t)<10?"0":"")+t,e.segment2+"#"+t}))[n?0:i.length-1]);return null};var cc=function(e){return e&&e.__esModule?e:{default:e}}(ac);function uc(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function lc(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function dc(e,t){return(0,cc.default)(e,t)}var pc={};Object.defineProperty(pc,"__esModule",{value:!0}),pc.default=yc;var fc=mc(u),hc=mc(ss);function mc(e){return e&&e.__esModule?e:{default:e}}function yc(e,t,n,i){hc.default.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(e){var t=e.context,n=t.hints,i=t.shape,o=t.parent||t.newParent;(!n||!1!==n.root&&!1!==n.autoResize)&&r._expand([i],o)}),this.postExecuted(["elements.move"],function(e){var t=e.context,n=(0,l.flatten)((0,l.values)(t.closure.topLevel)),i=t.hints,o=!i||i.autoResize;if(!1!==o){var a=(0,l.groupBy)(n,function(e){return e.parent.id});(0,l.forEach)(a,function(e,t){(0,l.isArray)(o)&&(e=e.filter(function(e){return-1!==o.indexOf(e)})),r._expand(e,t)})}}),this.postExecuted(["shape.toggleCollapse"],function(e){var t=e.context,n=t.hints,i=t.shape;(!n||!1!==n.root&&!1!==n.autoResize)&&(i.collapsed||r._expand(i.children||[],i))}),this.postExecuted(["shape.resize"],function(e){var t=e.context,n=t.hints,i=t.shape,o=i.parent;(!n||!1!==n.root&&!1!==n.autoResize)&&o&&r._expand([i],o)})}yc.$inject=["eventBus","elementRegistry","modeling","rules"],(0,fc.default)(yc,hc.default),yc.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=(0,sc.asTRBL)((0,Sr.getBBox)(e)),o=(0,sc.asTRBL)(t),a={};return r.top-o.top<i.top&&(a.top=r.top-n.top),r.left-o.left<i.left&&(a.left=r.left-n.left),o.right-r.right<i.right&&(a.right=r.right+n.right),o.bottom-r.bottom<i.bottom&&(a.bottom=r.bottom+n.bottom),(0,sc.asBounds)((0,l.assign)({},o,a))},yc.prototype._expand=function(e,t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._rules.allowed("element.autoResize",{elements:e,target:t})){var n=this._getOptimalBounds(e,t);if(function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(n,t)){this.resize(t,n);var i=t.parent;i&&this._expand([t],i)}}},yc.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}},yc.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}},yc.prototype.resize=function(e,t){this._modeling.resizeShape(e,t)};var vc={};Object.defineProperty(vc,"__esModule",{value:!0});var gc=function(e){return e&&e.__esModule?e:{default:e}}(pc);vc.default={__init__:["autoResize"],autoResize:["type",gc.default]};var _c={__init__:["cmmnAutoResizeProvider"],__depends__:[vc.default],cmmnAutoResizeProvider:["type",Ms]},xc=l.assign,bc=l.isArray,Ec=Q.isAny,wc=e.is,Mc=e.getDefinition;function Sc(e,t,n,i,r,o,a,s){e.registerProvider(this),this._contextPad=e,this._connect=t,this._create=n,this._elementFactory=i,this._modeling=r,this._rules=o,this._popupMenu=a,this._canvas=s}Sc.$inject=["contextPad","connect","create","elementFactory","modeling","rules","popupMenu","canvas"];var Cc=Sc;Sc.prototype.getContextPadEntries=function(e){var t,n,i,r=this._contextPad,o=this._connect,a=this._create,s=this._elementFactory,c=this._modeling,u=this._canvas,l=this._rules,d=this._popupMenu,p={};if("label"===e.type)return p;function f(e,t,n){o.start(e,t,n)}function h(e,t,n,i,r){function o(t,n){var r=s.createShape(xc({type:e},i));a.start(t,r,n)}return"string"!=typeof n&&(i=n,n="Append "+e.replace(/^cmmn:/,"")),{group:"model",className:t,title:n,action:{dragstart:r||o,click:r||o}}}Ec(e,["cmmn:PlanItem","cmmn:CaseFileItem"])&&xc(p,{"append.entryCriterion":(t="cmmn-icon-entry-criterion",n="Append Criterion",h("cmmn:EntryCriterion",t,n,i,function(e,t){var n=s.createCriterionShape("cmmn:EntryCriterion");a.start(e,n,t)}))}),function(e){var t=Mc(e);return wc(t,"cmmn:HumanTask")&&t.isBlocking}(e)&&xc(p,{"append.discretionaryItem":function(e,t,n){return h("cmmn:DiscretionaryItem",e,t,n,function(e,t){var n=s.createDiscretionaryItemShape("cmmn:Task");a.start(e,n,t)})}("cmmn-icon-task-discretionary","Append DiscretionaryItem")}),d.isEmpty(e,"cmmn-replace")||xc(p,{replace:{group:"edit",className:"cmmn-icon-screw-wrench",title:"Change type",action:{click:function(e,t){var n=xc(function(e){var t=u.getContainer(),n=r.getPad(e).html,i=t.getBoundingClientRect(),o=n.getBoundingClientRect(),a=o.top-i.top;return{x:o.left-i.left,y:a+o.height+5}}(t),{cursor:{x:e.x,y:e.y}});d.open(t,"cmmn-replace",n)}}}}),Ec(e,["cmmndi:CMMNEdge","cmmn:TextAnnotation"])||xc(p,{"append.text-annotation":h("cmmn:TextAnnotation","cmmn-icon-text-annotation")}),Ec(e,["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:CaseFileItem","cmmn:Criterion"])&&xc(p,{connect:{group:"connect",className:"cmmn-icon-connection",title:"Connect using Discretionary/OnPart or Association",action:{click:f,dragstart:f}}});var m=l.allowed("elements.delete",{elements:[e]});return bc(m)&&(m=m[0]===e),m&&xc(p,{delete:{group:"edit",className:"cmmn-icon-trash",title:"Remove",action:{click:function(t){c.removeElements([e])}}}}),p};var Pc={},Rc=e.is,Tc=e.getDefinition,kc=e.getBusinessObject,Ac=Q.isAny,Oc=Q.getParent,jc=Sr.eachElement;function Nc(e){Ic(e=kc(e))&&(e=Tc(e));var t=[];if(Dc(e)&&(e=e.planningTable)){var n=e.get("tableItems");jc(n,function(e){if(!Bc(e))return e.get("tableItems");t.push(e)})}return t}function Ic(e){return Ac(e,["cmmn:DiscretionaryItem","cmmn:PlanItem"])}function Dc(e){return Ac(e,["cmmn:HumanTask","cmmn:Stage"])}function Bc(e){return Rc(e,"cmmn:DiscretionaryItem")}Pc.getAllDiscretionaryItems=Nc,Pc.getDirectItemCapables=function(e){Ic(e=kc(e))&&(e=Tc(e));var t,n=[];function i(e){n.push(e)}return e&&(Rc(e,"cmmn:PlanFragment")&&(t=e.get("planItems"),jc(t,i)),Dc(e)&&(t=Nc(e),jc(t,i))),n},Pc.isItemCapable=Ic,Pc.isPlanningTableCapable=Dc,Pc.isDiscretionaryItem=Bc,Pc.isDiscretionaryToHumanTask=function(e){var t=kc(e),n=Oc(t,"cmmn:PlanItemDefinition");return Rc(n,"cmmn:HumanTask")},Pc.isHumanTask=function(e){return Rc(e,"cmmn:HumanTask")},Pc.isPlanFragment=function(e){return Rc(e,"cmmn:PlanFragment")&&!Rc(e,"cmmn:Stage")};var Lc={TASK:[{label:"Task",actionName:"replace-with-task-plan-item",className:"cmmn-icon-task-none",target:{definitionType:"cmmn:Task",type:"cmmn:PlanItem"}},{label:"Human Task",actionName:"replace-with-blocking-human-task-plan-item",className:"cmmn-icon-human-blocking-task",target:{definitionType:"cmmn:HumanTask",type:"cmmn:PlanItem",isBlocking:!0}},{label:"Human Task",actionName:"replace-with-non-blocking-human-task-plan-item",className:"cmmn-icon-human-non-blocking-task",target:{definitionType:"cmmn:HumanTask",type:"cmmn:PlanItem",isBlocking:!1}},{label:"Decision Task",actionName:"replace-with-decision-task-plan-item",className:"cmmn-icon-decision-task",target:{definitionType:"cmmn:DecisionTask",type:"cmmn:PlanItem"}},{label:"Process Task",actionName:"replace-with-process-task-plan-item",className:"cmmn-icon-process-task",target:{definitionType:"cmmn:ProcessTask",type:"cmmn:PlanItem"}},{label:"Case Task",actionName:"replace-with-case-task-plan-item",className:"cmmn-icon-case-task",target:{definitionType:"cmmn:CaseTask",type:"cmmn:PlanItem"}},{label:"Stage (collapsed)",actionName:"replace-with-collapsed-stage-plan-item",className:"cmmn-icon-stage-collapsed",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!0}},{label:"Stage (expanded)",actionName:"replace-with-expanded-stage-plan-item",className:"cmmn-icon-stage-expanded",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!1}},{label:"Discretionary Task",actionName:"replace-with-task-discretionary-item",className:"cmmn-icon-task-discretionary",target:{definitionType:"cmmn:Task",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Human Task",actionName:"replace-with-blocking-human-task-discretionary-item",className:"cmmn-icon-human-blocking-task-discretionary",target:{definitionType:"cmmn:HumanTask",type:"cmmn:DiscretionaryItem",isBlocking:!0}},{label:"Discretionary Human Task",actionName:"replace-with-non-blocking-human-task-discretionary-item",className:"cmmn-icon-human-non-blocking-task-discretionary",target:{definitionType:"cmmn:HumanTask",type:"cmmn:DiscretionaryItem",isBlocking:!1}},{label:"Discretionary Decision Task",actionName:"replace-with-decision-task-discretionary-item",className:"cmmn-icon-decision-task-discretionary",target:{definitionType:"cmmn:DecisionTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Process Task",actionName:"replace-with-process-task-discretionary-item",className:"cmmn-icon-process-task-discretionary",target:{definitionType:"cmmn:ProcessTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Case Task",actionName:"replace-with-case-task-discretionary-item",className:"cmmn-icon-case-task-discretionary",target:{definitionType:"cmmn:CaseTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Stage (collapsed)",actionName:"replace-with-collapsed-stage-discretionary-item",className:"cmmn-icon-stage-collapsed-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!0}},{label:"Discretionary Stage (expanded)",actionName:"replace-with-expanded-stage-discretionary-item",className:"cmmn-icon-stage-expanded-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!1}}],PLAN_FRAGMENT_EXPANDED:[{label:"Stage",actionName:"replace-with-stage-plan-item",className:"cmmn-icon-stage-expanded",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!1}},{label:"Discretionary Stage",actionName:"replace-with-stage-discretionary-item",className:"cmmn-icon-stage-expanded-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!1}},{label:"Discretionary Plan Fragment",actionName:"replace-with-plan-fragment-discretionary-item",className:"cmmn-icon-plan-fragment-expanded-discretionary",target:{definitionType:"cmmn:PlanFragment",type:"cmmn:DiscretionaryItem",isCollapsed:!1}}],EVENT_LISTENER:[{label:"Event Listener",actionName:"replace-with-event-listener-plan-item",className:"cmmn-icon-event-listener",target:{definitionType:"cmmn:EventListener",type:"cmmn:PlanItem"}},{label:"Timer Event Listener",actionName:"replace-with-timer-event-listener-plan-item",className:"cmmn-icon-timer-event-listener",target:{definitionType:"cmmn:TimerEventListener",type:"cmmn:PlanItem"}},{label:"User Event Listener",actionName:"replace-with-user-event-listener-plan-item",className:"cmmn-icon-user-event-listener",target:{definitionType:"cmmn:UserEventListener",type:"cmmn:PlanItem"}}],CRITERION:[{label:"Entry Criterion",actionName:"replace-with-entry-criterion",className:"cmmn-icon-entry-criterion",target:{type:"cmmn:EntryCriterion"}},{label:"Exit Criterion",actionName:"replace-with-exit-criterion",className:"cmmn-icon-exit-criterion",target:{type:"cmmn:ExitCriterion"}}]},zc=l.forEach,Fc=l.filter,$c=Pc.isItemCapable,Hc=Q.isAny,Uc=e.getBusinessObject,Wc=e.getDefinition,Vc=e.isCasePlanModel,Gc=e.isRequired,qc=e.isRepeatable,Kc=e.isManualActivation,Yc=e.is,Xc=me.isCollapsed;function Zc(e,t){return Uc(e).$type!==t.target.type}function Qc(e,t){return Wc(e).$type!==t.target.definitionType}function Jc(e,t){var n=t.type,i=t.definitionType,r=e.parent,o=Wc(e);if(function(e){return Yc(e,"cmmn:PlanItem")}(e)&&"cmmn:DiscretionaryItem"===n&&!nu(r))return!1;if("cmmn:HumanTask"===i){if(tu(e)&&!t.isBlocking)return!1;if(iu(e)&&o.isBlocking!==t.isBlocking)return!1}return!0}function eu(e,t,n,i,r){this._popupMenu=e,this._cmmnReplace=t,this._cmmnFactory=n,this._modeling=i,this._rules=r,this.register()}function tu(e){return Yc(Wc(e),"cmmn:PlanFragment")}function nu(e){return Yc(Wc(e),"cmmn:Stage")}function iu(e){return Yc(Wc(e),"cmmn:Task")}eu.$inject=["popupMenu","cmmnReplace","cmmnFactory","modeling","rules"],eu.prototype.register=function(){this._popupMenu.registerProvider("cmmn-replace",this)},eu.prototype.getEntries=function(e){var t,n=this._rules,i=Wc(e);if(!n.allowed("shape.replace",{element:e}))return[];if($c(e)){if(iu(e))return t=Fc(Lc.TASK,function(t){var n=t.target;if(Jc(e,n))return Zc(e,t)^Qc(e,t)}),this._createEntries(e,t);if(tu(e)){if(!Xc(e))return t=Fc(Lc.PLAN_FRAGMENT_EXPANDED,function(t){var n=t.target;if(Jc(e,n))return Zc(e,t)||Qc(e,t)}),this._createEntries(e,t);if(Xc(e))return t=Fc(Lc.TASK,function(t){var n=t.target,r=n.definitionType;return!!Jc(e,n)&&(r===i.$type&&!n.isCollapsed||Zc(e,t)^Qc(e,t))}),this._createEntries(e,t)}if(function(e){return Yc(Wc(e),"cmmn:EventListener")}(e))return t=Fc(Lc.EVENT_LISTENER,function(t){return Qc(e,t)}),this._createEntries(e,t)}return function(e){return Yc(e,"cmmn:Criterion")}(e)?(t=Fc(Lc.CRITERION,function(t){return Zc(e,t)}),this._createEntries(e,t)):[]},eu.prototype.getHeaderEntries=function(e){var t=[];return iu(e)&&(t=t.concat(this._getBlockingEntry(e))),nu(e)&&(t=t.concat(this._getAutoCompleteEntry(e))),function(e){var t=Wc(e);return!Vc(e)&&Hc(t,["cmmn:Stage","cmmn:Milestone","cmmn:Task"])}(e)&&(t=t.concat(this._getRuleEntries(e))),t},eu.prototype._createEntries=function(e,t){var n=[],i=this;return zc(t,function(t){var r=i._createMenuEntry(t,e);n.push(r)}),n},eu.prototype._createMenuEntry=function(e,t,n){var i=this._cmmnReplace.replaceElement;return n=n||function(){return i(t,e.target)},{label:e.label,className:e.className,id:e.actionName,action:n}},eu.prototype._getBlockingEntry=function(e){var t=this;return[{id:"toggle-is-blocking",className:"cmmn-icon-blocking",title:"Blocking",active:Wc(e).isBlocking,action:function(n,i){var r=!i.active;t._modeling.updateControls(e,{isBlocking:r})}}]},eu.prototype._getAutoCompleteEntry=function(e){var t=this;return[{id:"toggle-auto-complete",className:"cmmn-icon-auto-complete-marker",title:"Auto Complete",active:Wc(e).autoComplete,action:function(n,i){var r=!i.active;t._modeling.updateControls(e,{autoComplete:r})}}]},eu.prototype._getRuleEntries=function(e){var t=this;function n(n,i){return function(r,o){var a={};o.active?a[n]=void 0:a[n]=t._cmmnFactory.create(i),t._modeling.updateControls(e,a)}}var i=qc(e),r=Gc(e),o=Kc(e),a=[{id:"toggle-required-rule",className:"cmmn-icon-required-marker",title:"Required Rule",active:r,action:n("requiredRule","cmmn:RequiredRule")}];return function(e){return Yc(Wc(e),"cmmn:Milestone")}(e)||a.push({id:"toggle-manual-activation-rule",className:"cmmn-icon-manual-activation-marker",title:"Manual Activation Rule",active:o,action:n("manualActivationRule","cmmn:ManualActivationRule")}),a.push({id:"toggle-repetition-rule",className:"cmmn-icon-repetition-marker",title:"Repetition Rule",active:i,action:n("repetitionRule","cmmn:RepetitionRule")}),a};var ru={__init__:["replaceMenuProvider"],replaceMenuProvider:["type",eu]},ou={};Object.defineProperty(ou,"__esModule",{value:!0});var au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};ou.default=uu;var su="connect-ok",cu="connect-not-ok";function uu(e,t,n,i,r,o){function a(e,t){return i.allowed("connection.create",{source:e,target:t})}e.on("connect.move",function(e){var t,n=e.context,i=n.source,r=n.target,a=n.visual;t=function(e,t,n,i){var r=o.getShapePath(n),a=i&&o.getShapePath(i),s=o.getConnectionPath({waypoints:[e,t]});return[e=(0,sc.getElementLineIntersection)(r,s,!0)||e,t=i&&(0,sc.getElementLineIntersection)(a,s,!1)||t]}(n.sourcePosition,{x:e.x,y:e.y},i,r),(0,Ee.attr)(a,{points:[t[0].x,t[0].y,t[1].x,t[1].y]})}),e.on("connect.hover",function(e){var t,n=e.context,i=n.source,o=e.hover;null!==(t=n.canExecute=a(i,o))&&(n.target=o,r.addMarker(o,t?su:cu))}),e.on(["connect.out","connect.cleanup"],function(e){var t=e.context;t.target&&r.removeMarker(t.target,t.canExecute?su:cu),t.target=null,t.canExecute=!1}),e.on("connect.cleanup",function(e){var t=e.context;t.visual&&(0,Ee.remove)(t.visual)}),e.on("connect.start",function(e){var t,n=e.context;t=(0,Ee.create)("polyline"),(0,Ee.attr)(t,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),(0,Ee.append)(r.getDefaultLayer(),t),n.visual=t}),e.on("connect.end",function(e){var t=e.context,i=t.source,r=t.sourcePosition,o=t.target,s={x:e.x,y:e.y},c=t.canExecute||a(i,o);if(!c)return!1;var u=null,l={connectionStart:r,connectionEnd:s};"object"===(void 0===c?"undefined":au(c))&&(u=c),n.connect(i,o,u,l)}),this.start=function(e,n,i,r){"object"!==(void 0===i?"undefined":au(i))&&(r=i,i=(0,sc.getMid)(n)),t.init(e,"connect",{autoActivate:r,data:{shape:n,context:{source:n,sourcePosition:i}}})}}uu.$inject=["eventBus","dragging","modeling","rules","canvas","graphicsFactory"];var lu={};Object.defineProperty(lu,"__esModule",{value:!0}),lu.default=hu;var du=Math.round,pu="djs-drag-active";function fu(e){e.preventDefault()}function hu(e,t,n){var i,r={threshold:5,trapClick:!0};function o(e){var n=t.viewbox(),i=t._container.getBoundingClientRect();return{x:n.x+(e.x-i.left)/n.scale,y:n.y+(e.y-i.top)/n.scale}}function a(t,n){n=n||i;var r=e.createEvent((0,l.assign)({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==e.fire("drag."+t,r)&&e.fire(n.prefix+"."+t,r)}function s(e,r){var s,c=i.payload,u=i.displacement,d=i.globalStart,p=(0,qo.toPoint)(e),f=(0,Wa.delta)(p,d),h=i.localStart,y=o(p),v=(0,Wa.delta)(y,h);if(!i.active&&(r||(s=f,Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2))>i.threshold))){if((0,l.assign)(c,{x:du(h.x+u.x),y:du(h.y+u.y),dx:0,dy:0},{originalEvent:e}),!1===a("start"))return m();i.active=!0,i.keepSelection||(c.previousSelection=n.get(),n.select(null)),i.cursor&&(0,$a.set)(i.cursor),t.addMarker(t.getRootElement(),pu)}(0,qo.stopPropagation)(e),i.active&&((0,l.assign)(c,{x:du(y.x+u.x),y:du(y.y+u.y),dx:du(v.x),dy:du(v.y)},{originalEvent:e}),a("move"))}function c(e){var t=!0;i.active&&(e&&(i.payload.originalEvent=e,(0,qo.stopPropagation)(e)),t=a("end")),!1===t&&a("rejected"),a("ended",y(!0!==t))}function u(e){27===e.which&&(fu(e),m())}function d(t){var n;i.active&&(n=(0,za.install)(e),setTimeout(n,400),fu(t)),c(t)}function p(e){s(e)}function f(e){var t=i.payload;t.hoverGfx=e.gfx,t.hover=e.element,a("hover")}function h(e){a("out");var t=i.payload;t.hoverGfx=null,t.hover=null}function m(e){var t;if(i){var n=i.active;n&&a("cancel"),t=y(e),n&&a("canceled",t)}}function y(r){var o,l;a("cleanup"),(0,$a.unset)(),l=i.trapClick?d:c,at.event.unbind(document,"mousemove",s),at.event.unbind(document,"dragstart",fu),at.event.unbind(document,"selectstart",fu),at.event.unbind(document,"mousedown",l,!0),at.event.unbind(document,"mouseup",l,!0),at.event.unbind(document,"keyup",u),at.event.unbind(document,"touchstart",p,!0),at.event.unbind(document,"touchcancel",m,!0),at.event.unbind(document,"touchmove",s,!0),at.event.unbind(document,"touchend",c,!0),e.off("element.hover",f),e.off("element.out",h),t.removeMarker(t.getRootElement(),pu);var y=i.payload.previousSelection;return!1!==r&&y&&!n.get().length&&n.select(y),o=i,i=null,o}e.on("diagram.destroy",m),this.init=function(t,n,y,v){i&&m(!1),"string"==typeof n&&(v=y,y=n,n=null);var g,_,x,b,E,w=(v=(0,l.assign)({},r,v||{})).data||{};b=v.trapClick?d:c,t?(g=(0,qo.getOriginal)(t)||t,_=(0,qo.toPoint)(t),(0,qo.stopPropagation)(t),"dragstart"===g.type&&fu(g)):(g=null,_={x:0,y:0}),x=o(_),n||(n=x),E=function(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}(g),i=(0,l.assign)({prefix:y,data:w,payload:{},globalStart:_,displacement:(0,Wa.delta)(n,x),localStart:x,isTouch:E},v),v.manual||(E?(at.event.bind(document,"touchstart",p,!0),at.event.bind(document,"touchcancel",m,!0),at.event.bind(document,"touchmove",s,!0),at.event.bind(document,"touchend",c,!0)):(at.event.bind(document,"mousemove",s),at.event.bind(document,"dragstart",fu),at.event.bind(document,"selectstart",fu),at.event.bind(document,"mousedown",b,!0),at.event.bind(document,"mouseup",b,!0)),at.event.bind(document,"keyup",u),e.on("element.hover",f),e.on("element.out",h)),a("init"),v.autoActivate&&s(t,!0)},this.move=s,this.hover=f,this.out=h,this.end=c,this.cancel=m,this.context=function(){return i},this.setOptions=function(e){(0,l.assign)(r,e)}}hu.$inject=["eventBus","canvas","selection"];var mu={};function yu(e,t,n){var i=this;e.on("drag.start",function(t){e.once("drag.move",function(){e.once("drag.move",function(e){i.ensureHover(e)})})}),this.ensureHover=function(e){if(!e.hover){var i,r,o,a=e.originalEvent;a instanceof MouseEvent&&(i=(0,qo.toPoint)(a),(o=function(e){return(0,at.closest)(e,"svg, .djs-element",!0)}(document.elementFromPoint(i.x,i.y)))&&(r=n.get(o),t.hover({element:r,gfx:o})))}}}Object.defineProperty(mu,"__esModule",{value:!0}),mu.default=yu,yu.$inject=["eventBus","dragging","elementRegistry"];var vu={};Object.defineProperty(vu,"__esModule",{value:!0});var gu=bu(ga),_u=bu(lu),xu=bu(mu);function bu(e){return e&&e.__esModule?e:{default:e}}vu.default={__init__:["hoverFix"],__depends__:[gu.default],dragging:["type",_u.default],hoverFix:["type",xu.default]};var Eu={};function wu(e){this._commandStack=e.get("commandStack",!1)}Object.defineProperty(Eu,"__esModule",{value:!0}),Eu.default=wu,wu.$inject=["injector"],wu.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),void 0===n||n};var Mu={};Object.defineProperty(Mu,"__esModule",{value:!0});var Su=function(e){return e&&e.__esModule?e:{default:e}}(Eu);Mu.default={__init__:["rules"],rules:["type",Su.default]};var Cu={};Object.defineProperty(Cu,"__esModule",{value:!0});var Pu=Au(ga),Ru=Au(Mu),Tu=Au(vu),ku=Au(ou);function Au(e){return e&&e.__esModule?e:{default:e}}Cu.default={__depends__:[Pu.default,Ru.default,Tu.default],connect:["type",ku.default]};var Ou={};Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.default=ju;function ju(e,t,n){this._providers=[],this._eventBus=t,this._overlays=n;var i=(0,l.isDefined)(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}ju.$inject=["config.contextPad","eventBus","overlays"],ju.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(e){var n=e.newSelection;1===n.length?t.open(n[0]):t.close()}),e.on("elements.delete",function(e){var n=e.elements;(0,l.forEach)(n,function(e){t.isOpen(e)&&t.close()})}),e.on("element.changed",function(e){var n=e.element,i=t._current;i&&i.element===n&&t.open(n,!0)})},ju.prototype.registerProvider=function(e){this._providers.push(e)},ju.prototype.getEntries=function(e){var t={};return(0,l.forEach)(this._providers,function(n){var i=n.getContextPadEntries(e);(0,l.forEach)(i,function(e,n){t[n]=e})}),t},ju.prototype.trigger=function(e,t,n){var i,r,o=this._current.element,a=this._current.entries,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();if(i=a[(0,at.attr)(s,"data-action")].action,r=t.originalEvent||t,(0,l.isFunction)(i)){if("click"===e)return i(r,o,n)}else if(i[e])return i[e](r,o,n);t.preventDefault()},ju.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},ju.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html;(0,l.forEach)(t,function(e,t){var n,r,o,a,s=e.group||"default",c=(0,at.domify)(e.html||'<div class="entry" draggable="true"></div>');(0,at.attr)(c,"data-action",t),(n=(0,at.query)("[data-group="+s+"]",i))||(n=(0,at.domify)('<div class="group" data-group="'+s+'"></div>'),i.appendChild(n)),n.appendChild(c),e.className&&(r=c,o=e.className,a=(0,at.classes)(r),((0,l.isArray)(o)?o:o.split(/\s+/g)).forEach(function(e){a.add(e)})),e.title&&(0,at.attr)(c,"title",e.title),e.imageUrl&&c.appendChild((0,at.domify)('<img src="'+e.imageUrl+'">'))}),(0,at.classes)(i).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})},ju.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=(0,at.domify)('<div class="djs-context-pad"></div>'),r=(0,l.assign)({html:i},this._overlaysConfig);at.delegate.bind(i,".entry","click",function(e){t.trigger("click",e)}),at.delegate.bind(i,".entry","dragstart",function(e){t.trigger("dragstart",e)}),at.event.bind(i,"mousedown",function(e){e.stopPropagation()}),this._overlayId=n.add(e,"context-pad",r);var o=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:o}),o},ju.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},ju.prototype.isOpen=function(e){return!(!this._current||e&&this._current.element!==e)};var Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});var Iu=Lu(ia),Du=Lu(Vo),Bu=Lu(Ou);function Lu(e){return e&&e.__esModule?e:{default:e}}Nu.default={__depends__:[Iu.default,Du.default],contextPad:["type",Bu.default]};var zu={};Object.defineProperty(zu,"__esModule",{value:!0}),zu.default=Vu;var Fu=750,$u="drop-ok",Hu="drop-not-ok",Uu="attach-ok",Wu="new-parent";function Vu(e,t,n,i,r,o,a){function s(e,t){[Uu,$u,Hu,Wu].forEach(function(n){n===t?r.addMarker(e,n):r.removeMarker(e,n)})}e.on("create.move",function(e){var t,i=e.context,r=e.hover,o=i.shape,a=i.source,c={x:e.x,y:e.y};t=i.canExecute=r&&function(e,t,i,r){if(!t)return!1;var o,a,s,c={source:i,shape:e,target:t,position:r};return(a=n.allowed("shape.attach",c))||(o=n.allowed("shape.create",c)),(o||a)&&(s=i&&n.allowed("connection.create",{source:i,target:e,hints:{targetParent:t,targetAttach:a}})),!(!o&&!a)&&{attach:a,connect:s}}(o,r,a,c),r&&null!==t&&(i.target=r,t&&t.attach?s(r,Uu):s(r,t?Wu:Hu))}),e.on("create.move",Fu,function(e){var t=e.context,n=t.shape,i=t.visual;i||(i=t.visual=function(e){var t,n,i;t=(0,Ee.create)("g"),(0,Ee.attr)(t,o.cls("djs-drag-group",["no-events"])),(0,Ee.append)(r.getDefaultLayer(),t),n=(0,Ee.create)("g"),(0,Ee.classes)(n).add("djs-dragger"),(0,Ee.append)(t,n),(0,Ze.translate)(n,e.width/-2,e.height/-2);var s=(0,Ee.create)("g");return(0,Ee.classes)(s).add("djs-visual"),(0,Ee.append)(n,s),i=s,a.drawShape(i,e),t}(n)),(0,Ze.translate)(i,e.x,e.y)}),e.on(["create.end","create.out","create.cleanup"],function(e){var t=e.context.target;t&&s(t,null)}),e.on("create.end",function(e){var t=e.context,n=t.source,r=t.shape,o=t.target,a=t.canExecute,s=a&&a.attach,c=a&&a.connect,u={x:e.x,y:e.y};if(!a)return!1;r=c?i.appendShape(n,r,u,o,{attach:s,connection:!0===c?{}:c}):i.createShape(r,u,o,{attach:s}),t.shape=r}),e.on("create.cleanup",function(e){var t=e.context;t.visual&&(0,Ee.remove)(t.visual)}),this.start=function(e,n,i){t.init(e,"create",{cursor:"grabbing",autoActivate:!0,data:{shape:n,context:{shape:n,source:i}}})}}Vu.$inject=["eventBus","dragging","rules","modeling","canvas","styles","graphicsFactory"];var Gu={};Object.defineProperty(Gu,"__esModule",{value:!0});var qu=Zu(vu),Ku=Zu(ga),Yu=Zu(Mu),Xu=Zu(zu);function Zu(e){return e&&e.__esModule?e:{default:e}}Gu.default={__depends__:[qu.default,Ku.default,Yu.default],create:["type",Xu.default]};var Qu={__depends__:[Cu.default,Nu.default,Gu.default,ga.default,ru],__init__:["contextPadProvider"],contextPadProvider:["type",Cc]},Ju={};Object.defineProperty(Ju,"__esModule",{value:!0}),Ju.default=el;function el(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}function tl(e,t){return new Error(e+" "+t)}el.$inject=["eventBus","injector"],el.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),o=e.get("copyPaste",!1),a=e.get("canvas",!1),s=e.get("rules",!1),c=e.get("mouseTracking",!1),u=e.get("keyboardMove",!1),d=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),o&&i&&this.register("copy",function(){var e=i.get();o.copy(e)}),c&&o&&this.register("paste",function(){var e=c.getHoverContext();o.paste(e)}),r&&this.register("stepZoom",function(e){r.stepZoom(e.value)}),a&&this.register("zoom",function(e){a.zoom(e.value)}),n&&i&&s&&this.register("removeSelection",function(){var e=i.get();if(e.length){var t,r=s.allowed("elements.delete",{elements:e});!1!==r&&(t=(0,l.isArray)(r)?r:e).length&&n.removeElements(t.slice())}}),u&&this.register("moveCanvas",function(e){u.moveCanvas(e)}),d&&this.register("moveSelection",function(e){d.moveSelection(e.direction,e.accelerated)})},el.prototype.trigger=function(e,t){if(!this._actions[e])throw tl(e,"is not a registered action");return this._actions[e](t)},el.prototype.register=function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);(0,l.forEach)(e,function(e,t){n._registerAction(t,e)})},el.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw tl(e,"is already registered");this._actions[e]=t},el.prototype.unregister=function(e){if(!this.isRegistered(e))throw tl(e,"is not a registered action");this._actions[e]=void 0},el.prototype.getActions=function(){return Object.keys(this._actions)},el.prototype.isRegistered=function(e){return!!this._actions[e]};var nl=Ju.default;function il(e){e.invoke(nl,this)}u(il,nl),il.$inject=["injector"];var rl=il;il.prototype._registerDefaultActions=function(e){nl.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),o=e.get("lassoTool",!1),a=e.get("handTool",!1),s=e.get("globalConnect",!1),c=e.get("directEditing",!1),u=e.get("searchPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var e=t.getRootElement(),r=n.filter(function(t){return t!==e});return i.select(r),r}),r&&this._registerAction("spaceTool",function(){r.toggle()}),o&&this._registerAction("lassoTool",function(){o.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&c&&this._registerAction("directEditing",function(){var e=i.get();e.length&&c.activate(e[0])}),u&&this._registerAction("find",function(){u.toggle()})};var ol={};Object.defineProperty(ol,"__esModule",{value:!0});var al=function(e){return e&&e.__esModule?e:{default:e}}(Ju);ol.default={__init__:["editorActions"],editorActions:["type",al.default]};var sl={__depends__:[ol.default],editorActions:["type",rl]},cl={};Object.defineProperty(cl,"__esModule",{value:!0}),cl.hasModifier=function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},cl.isCmd=function(e){if(e.altKey)return!1;return e.ctrlKey||e.metaKey},cl.isKey=function(e,t){return(e=(0,l.isArray)(e)?e:[e]).indexOf(t.key)>-1},cl.isShift=function(e){return e.shiftKey};var ul={};Object.defineProperty(ul,"__esModule",{value:!0}),ul.default=dl;var ll=500;function dl(e,t){var n=this;e.on("editorActions.init",ll,function(e){var i=e.editorActions;n.registerBindings(t,i)})}dl.$inject=["eventBus","keyboard"],dl.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}n("undo",function(e){var n=e.keyEvent;if((0,cl.isCmd)(n)&&!(0,cl.isShift)(n)&&(0,cl.isKey)(["z","Z"],n))return t.trigger("undo"),!0}),n("redo",function(e){var n=e.keyEvent;if((0,cl.isCmd)(n)&&((0,cl.isKey)(["y","Y"],n)||(0,cl.isKey)(["z","Z"],n)&&(0,cl.isShift)(n)))return t.trigger("redo"),!0}),n("copy",function(e){var n=e.keyEvent;if((0,cl.isCmd)(n)&&(0,cl.isKey)(["c","C"],n))return t.trigger("copy"),!0}),n("paste",function(e){var n=e.keyEvent;if((0,cl.isCmd)(n)&&(0,cl.isKey)(["v","V"],n))return t.trigger("paste"),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,cl.isKey)(["+","Add"],n)&&(0,cl.isCmd)(n))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,cl.isKey)(["-","Subtract"],n)&&(0,cl.isCmd)(n))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(e){var n=e.keyEvent;if((0,cl.isKey)("0",n)&&(0,cl.isCmd)(n))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(e){var n=e.keyEvent;if((0,cl.isKey)(["Delete","Del"],n))return t.trigger("removeSelection"),!0})};var pl=ul.default;function fl(e){e.invoke(pl,this)}u(fl,pl),fl.$inject=["injector"];var hl=fl;fl.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}pl.prototype.registerBindings.call(this,e,t),n("selectElements",function(n){var i=n.keyEvent;if(e.isKey(["a","A"],i)&&e.isCmd(i))return t.trigger("selectElements"),!0}),n("find",function(n){var i=n.keyEvent;if(e.isKey(["f","F"],i)&&e.isCmd(i))return t.trigger("find"),!0}),n("spaceTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["s","S"],i)?(t.trigger("spaceTool"),!0):void 0}),n("lassoTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["l","L"],i)?(t.trigger("lassoTool"),!0):void 0}),n("handTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["h","H"],i)?(t.trigger("handTool"),!0):void 0}),n("globalConnectTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["c","C"],i)?(t.trigger("globalConnectTool"),!0):void 0}),n("directEditing",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["e","E"],i)?(t.trigger("directEditing"),!0):void 0})};var ml={};Object.defineProperty(ml,"__esModule",{value:!0}),ml.default=yl;function yl(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keyHandler=this._keyHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}yl.$inject=["config.keyboard","eventBus"],yl.prototype._keyHandler=function(e){if(!function(e){return e&&((0,at.matches)(e,"input, textarea")||"true"===e.contentEditable)}(e.target)){var t={keyEvent:e};this._eventBus.fire("keyboard.keydown",t)&&e.preventDefault()}},yl.prototype.bind=function(e){this.unbind(),this._node=e,at.event.bind(e,"keydown",this._keyHandler,!0),this._fire("bind")},yl.prototype.getBinding=function(){return this._node},yl.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),at.event.unbind(e,"keydown",this._keyHandler,!0)),this._node=null},yl.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})},yl.prototype.addListener=function(e,t){(0,l.isFunction)(e)&&(t=e,e=1e3),this._eventBus.on("keyboard.keydown",e,t)},yl.prototype.hasModifier=cl.hasModifier,yl.prototype.isCmd=cl.isCmd,yl.prototype.isShift=cl.isShift,yl.prototype.isKey=cl.isKey;var vl={};Object.defineProperty(vl,"__esModule",{value:!0});var gl=xl(ml),_l=xl(ul);function xl(e){return e&&e.__esModule?e:{default:e}}vl.default={__init__:["keyboard","keyboardBindings"],keyboard:["type",gl.default],keyboardBindings:["type",_l.default]};var bl={__depends__:[vl.default],__init__:["keyboardBindings"],keyboardBindings:["type",hl]},El={},wl=e.is,Ml=Q.isAny,Sl=e.getBusinessObject;function Cl(e){return wl(e,"cmmn:TextAnnotation")?"text":"name"}function Pl(e){var t=Sl(e);return wl(t,"cmmndi:CMMNEdge")&&t.cmmnElementRef&&(t=t.cmmnElementRef),t}var Rl=function(e){return Ml(e,["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:CaseFileItem"])};El.getLabel=function(e){var t=Pl(e),n=Cl(t);if(function(e){return!Ml(e,["cmmn:Association","cmmn:Criterion","cmmndi:CMMNEdge"])}(t))return!t[n]&&Rl(e)&&(t=t.definitionRef),t[n]||""};El.setLabel=function(e,t,n,i){var r=Pl(e),o=Cl(r);return!r[o]&&Rl(e)&&i&&(r=r.definitionRef),r[o]=t,n&&(e.hidden=!t),e};var Tl=e.getDefinition;function kl(e){function t(t,n){var i=t.label||t,r=t.labelTarget||t;return El.setLabel(i,n,r!==i,function(t){var n=Tl(t);return!n||1===e.getReferences(n).length}(t)),[i,r]}this.execute=function(e){return e.oldLabel=El.getLabel(e.element),t(e.element,e.newLabel)},this.revert=function(e){return t(e.element,e.oldLabel)}}kl.$inject=["itemRegistry"];var Al=kl,Ol=e.isCasePlanModel,jl=e.is,Nl=e.getDefinition,Il=l.assign;function Dl(e,t,n,i){this._canvas=t,this._commandStack=i,n.registerProvider(this),i.registerHandler("element.updateLabel",Al),e.on("element.dblclick",function(e){n.activate(e.element)}),e.on(["element.mousedown","drag.init","canvas.viewbox.changed"],function(e){n.complete()}),e.on(["commandStack.changed"],function(){n.cancel()}),e.on("create.end",500,function(e){var t=e.shape,i=e.context.canExecute;e.isTouch||i&&n.activate(t)})}Dl.$inject=["eventBus","canvas","directEditing","commandStack"];var Bl=Dl;Dl.prototype.activate=function(e){var t=El.getLabel(e);if(void 0!==t&&e.parent){var n=e.label||e,i=this.getEditingBBox(e),r=Nl(e),o={};return(jl(r,"cmmn:Task")||jl(r,"cmmn:Milestone"))&&(o.centerVertically=!0),jl(e,"cmmn:TextAnnotation")&&(o.autoResize=!0,o.resizable=!0),n.labelTarget&&(o.autoResize=!0),Il({text:t,options:o},i)}},Dl.prototype.getEditingBBox=function(e,t){var n=this._canvas,i=Nl(e),r=e.label||e,o=this._canvas.getAbsoluteBBox(r),a=o.x+o.width/2,s=(o.y,o.height,{x:o.x,y:o.y}),c={},u=n.zoom();return Ol(e)&&(s.height=50,s.width=200,s.y-=30,c.textAlign="left"),jl(i,"cmmn:PlanFragment")&&!Ol(e)&&(s.width=e.width,s.maxHeight=48,s.y+=5,c.textAlign="left"),(jl(i,"cmmn:Task")||jl(i,"cmmn:Milestone"))&&(u>1?(s.width=o.width,s.height=o.height):(s.width=o.width/u,s.height=o.height/u),u<1&&(s.x=o.x-(s.width/2-o.width/2),s.y=o.y-(s.height/2-o.height/2))),jl(e,"cmmn:TextAnnotation")&&(s.width=o.width,s.height=o.height,s.minWidth=30*u,s.minHeight=10*u,c.textAlign="left"),r.labelTarget&&(s.width=150,s.minHeight=20,s.x=a-s.width/2),{bounds:s,style:c}},Dl.prototype.update=function(e,t){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t})};var Ll={};Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.default=Ul;var zl=Math.min,Fl=Math.max;function $l(e){e.preventDefault()}function Hl(e){e.stopPropagation()}function Ul(e){this.container=e.container,this.parent=(0,at.domify)('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=(0,at.query)("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=(0,l.bind)(this.autoResize,this),this.handlePaste=(0,l.bind)(this.handlePaste,this)}Ul.prototype.create=function(e,t,n,i){var r=this.parent,o=this.content,a=this.container;i=this.options=i||{},t=this.style=t||{};var s=(0,l.pick)(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);(0,l.assign)(r.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},s);var c=(0,l.pick)(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return(0,l.assign)(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&(0,l.assign)(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),o.innerText=n,at.event.bind(o,"keydown",this.keyHandler),at.event.bind(o,"mousedown",Hl),at.event.bind(o,"paste",this.handlePaste),i.autoResize&&at.event.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),a.appendChild(r),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),r},Ul.prototype.handlePaste=function(e){var t,n=this.options,i=this.style;if(e.preventDefault(),t=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(t),n.autoResize){var r=this.autoResize(i);r&&this.resizeHandler(r)}},Ul.prototype.insertText=function(e){document.execCommand("insertText",!1,e)||this._insertTextIE(e)},Ul.prototype._insertTextIE=function(e){var t,n,i,r=this.getSelection(),o=r.startContainer,a=r.endContainer,s=r.startOffset,c=r.endOffset,u=r.commonAncestorContainer,l=(t=u.childNodes,[].slice.call(t));if(u.nodeType===Node.TEXT_NODE){var d=o.textContent;o.textContent=d.substring(0,s)+e+d.substring(c),n=o,i=s+e.length}else if(o===this.content&&a===this.content){var p=document.createTextNode(e);this.content.insertBefore(p,l[s]),n=p,i=p.textContent.length}else{var f=l.indexOf(o),h=l.indexOf(a);l.forEach(function(t,n){n===f?t.textContent=o.textContent.substring(0,s)+e+a.textContent.substring(c):n>f&&n<=h&&(0,at.remove)(t)}),n=o,i=s+e.length}n&&void 0!==i&&setTimeout(function(){self.setSelection(n,i)})},Ul.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}},Ul.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,o=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){var s,c,u,d;n=this.resizeHandle=(0,at.domify)('<div class="djs-direct-editing-resize-handle"></div>');var p=function(n){$l(n),Hl(n);var l=zl(Fl(u+n.clientX-s,i),o),p=zl(Fl(d+n.clientY-c,r),a);t.style.width=l+"px",t.style.height=p+"px",e.resizeHandler({width:u,height:d,dx:n.clientX-s,dy:n.clientY-c})},f=function e(t){$l(t),Hl(t),at.event.unbind(document,"mousemove",p,!1),at.event.unbind(document,"mouseup",e,!1)};at.event.bind(n,"mousedown",function(e){$l(e),Hl(e),s=e.clientX,c=e.clientY;var n=t.getBoundingClientRect();u=n.width,d=n.height,at.event.bind(document,"mousemove",p),at.event.bind(document,"mouseup",f)})}(0,l.assign)(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)},Ul.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),at.event.unbind(t,"keydown",this.keyHandler),at.event.unbind(t,"mousedown",Hl),at.event.unbind(t,"input",this.autoResize),at.event.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),(0,at.remove)(n)),(0,at.remove)(e)},Ul.prototype.getValue=function(){return this.content.innerText.trim()},Ul.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},Ul.prototype.setSelection=function(e,t){var n=document.createRange();null===e?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};var Wl={};Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.default=Gl;var Vl=function(e){return e&&e.__esModule?e:{default:e}}(Ll);function Gl(e,t){this._eventBus=e,this._providers=[],this._textbox=new Vl.default({container:t.getContainer(),keyHandler:(0,l.bind)(this._handleKey,this),resizeHandler:(0,l.bind)(this._handleResize,this)})}Gl.$inject=["eventBus","canvas"],Gl.prototype.registerProvider=function(e){this._providers.push(e)},Gl.prototype.isActive=function(){return!!this._active},Gl.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},Gl.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},Gl.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},Gl.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue();r===e.context.text&&i.height===n.height&&i.width===n.width||(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,r,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}},Gl.prototype.getValue=function(){return this._textbox.getValue()},Gl.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},Gl.prototype._handleResize=function(e){this._fire("resize",e)},Gl.prototype.activate=function(e){var t;this.isActive()&&this.cancel();var n=(0,l.find)(this._providers,function(n){return(t=n.activate(e))?n:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var ql={};Object.defineProperty(ql,"__esModule",{value:!0});var Kl=Xl(ia),Yl=Xl(Wl);function Xl(e){return e&&e.__esModule?e:{default:e}}ql.default={__depends__:[Kl.default],__init__:["directEditing"],directEditing:["type",Yl.default]};var Zl={};function Ql(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.default=Ql,Ql.$inject=["eventBus","injector"],Ql.prototype.execute=function(e,t){if(!e)throw new Error("command required");var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)},Ql.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),r=this._fire(e,"canExecute",n);if(void 0===r){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r},Ql.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed")},Ql.prototype.undo=function(){var e,t=this._getUndoAction();if(t){for(this._pushAction(t);t&&(this._internalUndo(t),(e=this._getUndoAction())&&e.id===t.id);)t=e;this._popAction()}},Ql.prototype.redo=function(){var e,t=this._getRedoAction();if(t){for(this._pushAction(t);t&&(this._internalExecute(t,!0),(e=this._getRedoAction())&&e.id===t.id);)t=e;this._popAction()}},Ql.prototype.register=function(e,t){this._setHandler(e,t)},Ql.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)},Ql.prototype.canUndo=function(){return!!this._getUndoAction()},Ql.prototype.canRedo=function(){return!!this._getRedoAction()},Ql.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},Ql.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},Ql.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,r=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),r.revert&&t._markDirty(r.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})},Ql.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i,r,o,a=t?[e+"."+t,t]:[e];for(n=this._eventBus.createEvent(n),i=0;(r=a[i])&&(o=this._eventBus.fire("commandStack."+r,n),!n.cancelBubble);i++);return o},Ql.prototype._createId=function(){return this._uid++},Ql.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},Ql.prototype._internalExecute=function(e,t){var n=this,i=e.command,r=e.context,o=this._getHandler(i);if(!o)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),o.preExecute&&o.preExecute(r),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),o.execute&&n._markDirty(o.execute(r)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),o.postExecute&&o.postExecute(r),this._fire(i,"postExecuted",e)),this._popAction(e)},Ql.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)},Ql.prototype._popAction=function(){var e=this._currentExecution,t=e.actions,n=e.dirty;t.pop(),t.length||(this._eventBus.fire("elements.changed",{elements:(0,l.uniqueBy)("id",n)}),n.length=0,this._fire("changed"))},Ql.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=(0,l.isArray)(e)?e:[e],t.dirty=t.dirty.concat(e))},Ql.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},Ql.prototype._revertedAction=function(e){this._stackIdx--},Ql.prototype._getHandler=function(e){return this._handlerMap[e]},Ql.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var Jl={};Object.defineProperty(Jl,"__esModule",{value:!0});var ed=function(e){return e&&e.__esModule?e:{default:e}}(Zl);Jl.default={commandStack:["type",ed.default]};var td={};function nd(e,t,n,i){e.on("element.changed",function(i){var r=i.element;(r.parent||r===t.getRootElement())&&(i.gfx=n.getGraphics(r)),i.gfx&&e.fire((0,Sr.getType)(r)+".changed",i)}),e.on("elements.changed",function(t){var n=t.elements;n.forEach(function(t){e.fire("element.changed",{element:t})}),i.updateContainments(n)}),e.on("shape.changed",function(e){i.update("shape",e.element,e.gfx)}),e.on("connection.changed",function(e){i.update("connection",e.element,e.gfx)})}Object.defineProperty(td,"__esModule",{value:!0}),td.default=nd,nd.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var id={};Object.defineProperty(id,"__esModule",{value:!0});var rd=function(e){return e&&e.__esModule?e:{default:e}}(td);id.default={__init__:["changeSupport"],changeSupport:["type",rd.default]};var od={__depends__:[Jl.default,id.default,ql.default],__init__:["labelEditingProvider"],labelEditingProvider:["type",Bl]},ad=l.map,sd=l.assign,cd=l.pick,ud=Q.isAny;function ld(e){this._model=e}ld.$inject=["moddle"],ld.prototype._needsId=function(e){return ud(e,["cmmn:CMMNElement","cmmndi:CMMNShape","cmmndi:CMMNEdge","cmmndi:CMMNStyle","cmmndi:CMMNDiagram"])},ld.prototype._ensureId=function(e){var t=(e.$type||"").replace(/^[^:]*:/g,"")+"_";!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},ld.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},ld.prototype.createDiLabel=function(){return this.create("cmmndi:CMMNLabel")},ld.prototype.createDiShape=function(e,t,n){return this.create("cmmndi:CMMNShape",sd({cmmnElementRef:e,bounds:this.createDiBounds(t),label:this.createDiLabel()},n))},ld.prototype.createDiEdge=function(e,t,n){return this.create("cmmndi:CMMNEdge",sd({cmmnElementRef:e,label:this.createDiLabel()},n))},ld.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},ld.prototype.createDiWaypoints=function(e){var t=this;return ad(e,function(e){return t.createDiWaypoint(e)})},ld.prototype.createDiWaypoint=function(e){return this.create("dc:Point",cd(e,["x","y"]))},ld.prototype.createItem=function(e,t){var n=this.create(t);return this.create(e,{definitionRef:n})},ld.prototype.createCriterion=function(e,t){return(t=t||{}).sentryRef||(t=sd({sentryRef:this.createSentry()},t)),this.create(e,t)},ld.prototype.createSentry=function(e){return this.create("cmmn:Sentry",e)},ld.prototype.createCasePlanModel=function(){var e=this.create("cmmn:Stage");this._model.ids.unclaim(e.id),e.id=this._model.ids.nextPrefixed("CasePlanModel_",e);var t=this.create("cmmn:Case",{casePlanModel:e});return e.$parent=t,e},ld.prototype.createCaseFileModel=function(e){var t=this.create("cmmn:CaseFile");return this._model.ids.unclaim(t.id),t.id=this._model.ids.nextPrefixed("CaseFileModel_",t),t.$parent=e,t},ld.prototype.createCaseFileItem=function(e){return(e=e||{}).definitionRef||(e=sd({definitionRef:this.create("cmmn:CaseFileItemDefinition")},e)),this.create("cmmn:CaseFileItem",e)};var dd=ld,pd={};function fd(){}Object.defineProperty(pd,"__esModule",{value:!0}),pd.default=fd,fd.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||(0,sc.getMid)(e.source),t.connectionEnd||(0,sc.getMid)(e.target)]};var hd={};Object.defineProperty(hd,"__esModule",{value:!0}),hd.repairConnection=function(e,t,n,i,r,o){(0,l.isArray)(n)&&(r=n,o=i,n=(0,sc.getMid)(e),i=(0,sc.getMid)(t));o=(0,l.assign)({preferredLayouts:[]},o),r=r||[];var a,s=-1!==o.preferredLayouts.indexOf("straight");if(a=s&&Cd(e,t,n,i,o))return a;if(a=o.connectionEnd&&function(e,t,n,i){var r=i.slice().reverse();return(r=Pd(e,t,n,r))?r.reverse():null}(t,e,i,r))return a;if(a=o.connectionStart&&(c=e,u=t,d=n,p=r,Pd(c,u,d,p)))return a;var c,u,d,p;if(!o.connectionStart&&!o.connectionEnd&&r&&r.length)return r;return Md(e,t,n,i,o)};var md=20,yd=5,vd=Math.round,gd=20,_d={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function xd(e,t,n){var i,r,o,a=(0,sc.getOrientation)(t,e,yd),s=n.split(":")[0],c=vd((t.x-e.x)/2+e.x),u=vd((t.y-e.y)/2+e.y),l=(o=a,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[s].test(o)),d=/h|r|l/.test(s),p=!1;return l?(i=d?{x:c,y:e.y}:{x:e.x,y:u},r=d?"h:h":"v:v"):(r=d?"h:v":"v:h",function(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}(a,s)?d?(p=u===e.y,i={x:e.x+md*(/l/.test(s)?-1:1),y:p?u+md:u}):i={x:(p=c===e.x)?c+md:c,y:e.y+md*(/t/.test(s)?-1:1)}:i={x:c,y:u}),{waypoints:Ed(e,i,r).concat(i),directions:r,turnNextDirections:p}}function bd(e){return e.split(":").reverse().join(":")}function Ed(e,t,n){if(!function(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}(n=n||"h:h"))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Rd(n)){var i=function(e,t,n){return xd(e,t,n)}(e,t,n),r=function(e,t,n){var i=xd(t,e,bd(n));return{waypoints:i.waypoints.slice().reverse(),directions:bd(i.directions),turnNextDirections:i.turnNextDirections}}(e,t,n),o=function(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n="h"==n?"v":"h"),t.turnNextDirections&&(i="h"==i?"v":"h");var r=n+":"+i;return{waypoints:Ed(e.waypoints[e.waypoints.length-1],t.waypoints[0],r),directions:r}}(i,r);return[].concat(i.waypoints,o.waypoints,r.waypoints)}return function(e,t,n){var i=vd((t.x-e.x)/2+e.x),r=vd((t.y-e.y)/2+e.y);if("h:v"===n)return[{x:t.x,y:e.y}];if("v:h"===n)return[{x:e.x,y:t.y}];if("h:h"===n)return[{x:i,y:e.y},{x:i,y:t.y}];if("v:v"===n)return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,n)}function wd(e,t,n){var i=Ed(e,t,n);return i.unshift(e),i.push(t),kd(i)}function Md(e,t,n,i,r){var o=r&&r.preferredLayouts||[],a=(0,l.without)(o,"straight")[0]||"h:h",s=_d[a]||0,c=(0,sc.getOrientation)(e,t,s),u=function(e,t){if(Rd(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(c,a);n=n||(0,sc.getMid)(e),i=i||(0,sc.getMid)(t);var d=u.split(":");return wd(Td(n,e,d[0],function(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}(c)),Td(i,t,d[1],c),u)}function Sd(e,t,n){return function(e,t,n){return e>=t&&e<=n}(t[e],n[e],n[e]+n[{x:"width",y:"height"}[e]])}function Cd(e,t,n,i,r){var o,a,s={};return a=(0,sc.getOrientation)(e,t),/^(top|bottom|left|right)$/.test(a)?(/top|bottom/.test(a)&&(o="x"),/left|right/.test(a)&&(o="y"),"target"===r.preserveDocking?Sd(o,i,e)?(s[o]=i[o],[{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y,original:{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y}},{x:i.x,y:i.y}]):null:Sd(o,n,t)?(s[o]=n[o],[{x:n.x,y:n.y},{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y,original:{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y}}]):null):null}function Pd(e,t,n,i){if(function(e,t,n){return n.length<3||!(n.length>4)&&!!(0,l.find)(n,function(e,t){var i=n[t-1];return i&&(0,Ss.pointDistance)(e,i)<3})}(0,0,i))return null;var r,o=i[0],a=i.slice();return a[0]=n,a[1]=function(e,t,n){switch((0,Ss.pointsAligned)(t,e)){case"v":return{x:e.x,y:n.y};case"h":return{x:n.x,y:e.y}}return{x:e.x,y:e.y}}(a[1],o,n),(r=function(e,t,n){var i;for(i=e.length-2;0!==i;i--)if((0,Ss.pointInRect)(e[i],t,gd)||(0,Ss.pointInRect)(e[i],n,gd))return e.slice(i);return e}(a,e,t))!==a?Pd(e,t,n,r):a}function Rd(e){return e&&/t|r|b|l/.test(e)}function Td(e,t,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:e,x:e.x,y:t.y};if("r"===n)return{original:e,x:t.x+t.width,y:e.y};if("b"===n)return{original:e,x:e.x,y:t.y+t.height};if("l"===n)return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function kd(e){return e.reduce(function(t,n,i){var r=t[t.length-1],o=e[i+1];return(0,Ss.pointsOnLine)(r,o,n,0)||t.push(n),t},[])}var Ad=pd.default,Od=sc.getMid;function jd(){}u(jd,Ad);var Nd=jd;function Id(e,t){return e?e.original||e:Od(t)}jd.prototype.layoutConnection=function(e,t){t=t||{};var n=e.source,i=e.target,r=e.waypoints,o=t.connectionStart,a=t.connectionEnd;return o||(o=Id(r&&r[0],n)),a||(a=Id(r&&r[r.length-1],i)),hd.repairConnection(n,i,o,a,r,t)||[o,a]};var Dd=l.assign,Bd=ss.default,Ld=e.getBusinessObject,zd=e.is,Fd=e.isCasePlanModel,$d=Q.getParent,Hd=Q.isLabel,Ud=Q.isAny;function Wd(e,t,n,i){Bd.call(this,e),this._cmmnFactory=t,this._itemRegistry=n;var r=this;function o(e){var t=e.context.shape;r.updateBounds(t)}function a(e){r.updateConnection(e.context)}function s(e){r.updateConnectionWaypoints(e.context.connection)}function c(e){r.updateAttachment(e.context)}function u(e){var t=e.context.shape,i=Ld(t);n.add(i)}function l(e){var t=e.context.shape;if(!Hd(t)){var i=Ld(t);n.remove(i)}}this.executed(["connection.layout","connection.create","connection.reconnectEnd","connection.reconnectStart"],function(e){var t,n=e.context;n.cropped||((t=n.connection).waypoints=i.getCroppedWaypoints(t),n.cropped=!0)}),this.reverted(["connection.layout","connection.create","connection.reconnectEnd","connection.reconnectStart"],function(e){delete e.context.cropped}),this.executed(["shape.create","shape.move","shape.delete","connection.delete","connection.create"],Gd(function(e){var t=e.context;r.updateParent(t.shape||t.connection,t.oldParent)})),this.reverted(["shape.create","shape.move","shape.delete","connection.delete","connection.create"],Gd(function(e){var t=e.context,n=t.shape||t.connection,i=t.parent||t.newParent;r.updateParent(n,i)})),this.executed(["shape.create","shape.move","shape.resize"],Gd(function(e){"label"!==e.context.shape.type&&o(e)})),this.reverted(["shape.create","shape.move","shape.resize"],Gd(function(e){"label"!==e.context.shape.type&&o(e)})),e.on("shape.changed",function(e){"label"===e.element.type&&o({context:{shape:e.element}})}),this.executed(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Gd(a)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Gd(a)),this.executed(["connection.create","connection.layout","connection.move","connection.reconnectStart","connection.reconnectEnd","connection.updateWaypoints"],Gd(s)),this.reverted(["connection.create","connection.layout","connection.move","connection.reconnectStart","connection.reconnectEnd","connection.updateWaypoints"],Gd(s)),this.executed(["element.updateAttachment"],Gd(c)),this.reverted(["element.updateAttachment"],Gd(c)),this.executed("shape.create",Gd(u)),this.reverted("shape.create",Gd(l)),this.executed("shape.delete",Gd(l)),this.reverted("shape.delete",Gd(u))}u(Wd,Bd);var Vd=Wd;function Gd(e){return function(t){var n=t.context,i=n.shape||n.connection;(zd(i,"cmmn:CMMNElement")||zd(i,"cmmndi:CMMNDiagramElement"))&&e(t)}}function qd(e){return $d(e,"cmmn:Definitions")}Wd.$inject=["eventBus","cmmnFactory","itemRegistry","connectionDocking"],Wd.prototype.updateAttachment=function(e){var t=e.shape,n=Ld(t),i=t.host,r=i&&Ld(i);this.updateSemanticParent(n,r)},Wd.prototype.updateParent=function(e,t){if(!Hd(e)){var n,i=Ld(e),r=Ld(e.parent),o=i.di||i,a=r&&r.di;(n=(n=i).businessObject||n).cmmnElementRef&&zd(n.cmmnElementRef,"cmmn:Association")&&(i=i.cmmnElementRef),function(e){return!Ud(e,["cmmn:CaseFileItem","cmmn:Criterion","cmmn:DiscretionaryItem","cmmn:OnPart","cmmndi:CMMNEdge"])}(i)&&this.updateSemanticParent(i,r),zd(r,"cmmndi:CMMNDiagram")&&(a=r),this.updateDiParent(o,a)}},Wd.prototype.updateSemanticParent=function(e,t){var n;if(e.$parent!==t){if(zd(e,"cmmn:PlanItem")?(n="planItems",t&&!Fd(t)&&(t=t.definitionRef)):Fd(e)?(n="cases",e=e.$parent,t=t&&qd(t)):zd(e,"cmmn:EntryCriterion")?(Fd(t)&&(t=null),n="entryCriteria"):zd(e,"cmmn:ExitCriterion")?n="exitCriteria":zd(e,"cmmn:Artifact")&&(t=t&&qd(t),n="artifacts"),!n)throw new Error("no parent for ",e,t);var i;e.$parent&&(i=e.$parent.get(n),Sn.remove(i,e)),t?((i=t.get(n)).push(e),e.$parent=t):e.$parent=null}},Wd.prototype.updateDiParent=function(e,t){if(t&&!zd(t,"cmmndi:CMMNDiagram")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("diagramElements");t?(n.push(e),e.$parent=t):(Sn.remove(n,e),e.$parent=null)}},Wd.prototype.updateBounds=function(e){var t=e.businessObject.di||e.businessObject,n=Hd(e)?this._getLabel(t).bounds:t.bounds;Dd(n,{x:e.x,y:e.y,width:e.width,height:e.height})},Wd.prototype.updateConnectionWaypoints=function(e){e.businessObject.set("waypoint",this._cmmnFactory.createDiWaypoints(e.waypoints))},Wd.prototype.updateConnection=function(e){var t,n,i,r,o,a=e.connection,s=Ld(a),c=Ld(a.source),u=Ld(a.target),l=s.cmmnElementRef;zd(l,"cmmn:Association")?(t=l,n=l,i="sourceRef",r="targetRef"):(n=s,r="targetCMMNElementRef",zd(l,"cmmn:OnPart")?(t=l,i="sourceRef",zd(c,"cmmn:ExitCriterion")&&(c=$d(o=c)),l.exitCriterionRef!==o&&(l.exitCriterionRef=o)):(t=s,i="sourceCMMNElementRef"));i&&t[i]!==c&&(t[i]=c),r&&n[r]!==u&&(n[r]=u),this.updateConnectionWaypoints(a)},Wd.prototype._getLabel=function(e){return e.label||(e.label=this._cmmnFactory.createDiLabel()),e.label.bounds||(e.label.bounds=this._cmmnFactory.createDiBounds()),e.label};var Kd=l.assign,Yd=zr.default,Xd=e.is,Zd=e.getDefinition,Qd=e.isCasePlanModel,Jd=me.isCollapsed;function ep(e,t){Yd.call(this),this._cmmnFactory=e,this._moddle=t}u(ep,Yd),ep.$inject=["cmmnFactory","moddle"];var tp=ep;ep.prototype.baseCreate=Yd.prototype.create,ep.prototype.create=function(e,t){return"label"===e?this.baseCreate(e,Kd({type:"label"},cn.DEFAULT_LABEL_SIZE,t)):"root"===e?this.baseCreate(e,t):this.createCmmnElement(e,t)},ep.prototype.createCmmnElement=function(e,t){var n,i=(t=t||{}).businessObject;if(!i){if(!t.type)throw new Error("no shape type specified");var r={};t.name&&Kd(r,{name:t.name}),i=this._cmmnFactory.create(t.type,r)}if("connection"===e&&(Xd(i,"cmmndi:CMMNEdge")||(i=this._cmmnFactory.createDiEdge(i,[],{id:i.id+"_di"})),i.label||(i.label=this._cmmnFactory.createDiLabel()),t.type="cmmndi:CMMNEdge"),t.definitionType){var o=this._cmmnFactory.create(t.definitionType);i.definitionRef=o}return t.sentryRef&&(i.sentryRef=t.sentryRef),"shape"!==e||i.di||(i.di=this._cmmnFactory.createDiShape(i,{},{id:i.id+"_di"})),t.isCollapsed&&(i.di.isCollapsed=t.isCollapsed),t.isPlanningTableCollapsed&&(i.di.isPlanningTableCollapsed=t.isPlanningTableCollapsed),t.isStandardEventVisible&&(i.isStandardEventVisible=t.isStandardEventVisible),void 0!==t.isBlocking&&(i.definitionRef.isBlocking=t.isBlocking),t.autoComplete&&(i.definitionRef.autoComplete=!0),n=this._getDefaultSize(i),t=Kd({businessObject:i,id:i.id},n,t),this.baseCreate(e,t)},ep.prototype._getDefaultSize=function(e){var t=Zd(e);return Qd(e)?{width:400,height:250}:Xd(t,"cmmn:PlanFragment")?Jd(e)?{width:100,height:80}:{width:350,height:200}:Xd(t,"cmmn:Milestone")?{width:100,height:40}:Xd(t,"cmmn:EventListener")?{width:36,height:36}:Xd(e,"cmmn:Criterion")?{width:20,height:28}:Xd(e,"cmmn:TextAnnotation")?{width:100,height:30}:Xd(e,"cmmn:CaseFileItem")?{width:36,height:50}:{width:100,height:80}},ep.prototype.createPlanItemShape=function(e){return this.createShape({type:"cmmn:PlanItem",businessObject:this._cmmnFactory.createItem("cmmn:PlanItem",e)})},ep.prototype.createDiscretionaryItemShape=function(e){return this.createShape({type:"cmmn:DiscretionaryItem",businessObject:this._cmmnFactory.createItem("cmmn:DiscretionaryItem",e)})},ep.prototype.createCasePlanModelShape=function(){return this.createShape({type:"cmmn:Stage",businessObject:this._cmmnFactory.createCasePlanModel()})},ep.prototype.createCriterionShape=function(e){return this.createShape({type:e,businessObject:this._cmmnFactory.createCriterion(e)})},ep.prototype.createCaseFileItemShape=function(){return this.createShape({type:"cmmn:CaseFileItem",businessObject:this._cmmnFactory.createCaseFileItem()})};var np={};function ip(e){this._modeling=e}Object.defineProperty(np,"__esModule",{value:!0}),np.default=ip,ip.$inject=["modeling"],ip.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape;i=e.shape=this._modeling.createShape(i,e.position,n,{attach:e.attach}),e.shape=i},ip.prototype.postExecute=function(e){var t,n,i=e.connectionParent||e.shape.parent;t=e.source,n=e.shape,(0,l.some)(t.outgoing,function(e){return e.target===n})||this._modeling.connect(e.source,e.shape,e.connection,i)};var rp=e.is;function op(e,t){this._modeling=e,this._cmmnRules=t}u(op,np.default),op.$inject=["modeling","cmmnRules"];var ap=op;function sp(e){this._moddle=e}op.prototype.preExecute=function(e){if(!e.source)throw new Error("source required");var t=this._cmmnRules,n=e.shape,i=e.source,r=e.target||e.source.parent,o=e.position,a=e.attach;rp(n,"cmmn:Criterion")&&(a="attach"===t.canAttach(n,r,i,o)),e.shape=this._modeling.createShape(n,o,r,{attach:a,nested:!0})},sp.$inject=["moddle"];var cp=sp;sp.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.claim(n,i):t.unclaim(n)},sp.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.unclaim(n):t.claim(n,i)};var up={};function lp(e){this._modeling=e}Object.defineProperty(up,"__esModule",{value:!0}),up.default=lp,lp.$inject=["modeling"],lp.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget are required");if(t&&n)throw new Error("must specify either newSource or newTarget");return(0,l.isArray)(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i},lp.prototype.postExecute=function(e){var t,n,i=e.connection,r=e.dockingOrPoints,o=e.newSource,a=o?"connectionStart":"connectionEnd",s={};t=(0,l.isArray)(r)?o?r[0]:r[r.length-1]:r,s[a]=(n=t).original||n,this._modeling.layoutConnection(i,s)},lp.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,r=e.connection;return t&&(r.source=t),n&&(r.target=n),i&&(r.waypoints=i),r};var dp=l.isArray,pp=up.default;function fp(e){e.invoke(pp,this)}u(fp,pp),fp.$inject=["injector"];var hp=fp;fp.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget are required");return dp(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};var mp={};function yp(e,t){this._modeling=e,this._rules=t}function vp(e,t){this._modeling=e,this._rules=t}Object.defineProperty(mp,"__esModule",{value:!0}),mp.default=yp,yp.$inject=["modeling","rules"],yp.prototype.preExecute=function(e){var t,n=this,i=this._modeling,r=this._rules,o=e.oldShape,a=e.newData,s=e.hints;function c(e,t,n,i){return r.allowed(e,{source:t,target:n,connection:i})}var u,d={x:a.x,y:a.y};t=e.newShape=e.newShape||n.createShape(a,d,o.parent,s),o.host&&i.updateAttachment(t,o.host),!1!==s.moveChildren&&(u=o.children.slice(),i.moveElements(u,{x:0,y:0},t));var p=o.incoming.slice(),f=o.outgoing.slice();(0,l.forEach)(p,function(e){var i=e.waypoints,r=i[i.length-1];c("connection.reconnectEnd",e.source,t,e)&&n.reconnectEnd(e,t,r)}),(0,l.forEach)(f,function(e){var i=e.waypoints[0],r=e.target;c("connection.reconnectStart",t,r,e)&&n.reconnectStart(e,t,i)})},yp.prototype.postExecute=function(e){var t=this._modeling,n=e.oldShape,i=e.newShape;(0,l.forEach)(i.incoming,function(e){t.layoutConnection(e,{endChanged:!0})}),(0,l.forEach)(i.outgoing,function(e){t.layoutConnection(e,{startChanged:!0})}),t.removeShape(n)},yp.prototype.execute=function(e){},yp.prototype.revert=function(e){},yp.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)},yp.prototype.reconnectStart=function(e,t,n){this._modeling.reconnectStart(e,t,n)},yp.prototype.reconnectEnd=function(e,t,n){this._modeling.reconnectEnd(e,t,n)},u(vp,mp.default),vp.$inject=["modeling","rules"];var gp=vp;vp.prototype.createShape=function(e,t,n){return this._modeling.createShape(e,t,n,{nested:!0})},vp.prototype.reconnectStart=function(e,t,n){this._modeling.reconnectStart(e,t,n,{nested:!0,startChanged:!0})},vp.prototype.reconnectEnd=function(e,t,n){this._modeling.reconnectEnd(e,t,n,{nested:!0,endChanged:!0})};var _p=l.filter,xp=l.forEach,bp=e.getBusinessObject,Ep=e.getItemControl,wp=e.getDefaultControl,Mp=e.getDefinition,Sp=e.hasPlanningTable,Cp=Pc.isPlanningTableCapable;function Pp(e,t,n,i){this._itemRegistry=e,this._modeling=t,this._cmmnReplace=n,this._cmmnFactory=i}Pp.$inject=["itemRegistry","modeling","cmmnReplace","cmmnFactory"];var Rp=Pp,Tp=["requiredRule","repetitionRule","manualActivationRule"];function kp(e,t){var n={};return n[e]=t,n}function Ap(e){return!(Cp(e)&&Sp(e))}Pp.prototype.preExecute=function(e){var t=this,n=e.element,i=e.values;if(!n)throw new Error("element required");xp(i,function(e,i){-1!==Tp.indexOf(i)?t._updateRule(n,i,e):t._updateDecorator(n,i,e)})},Pp.prototype.execute=function(){},Pp.prototype.revert=function(){},Pp.prototype._updateDecorator=function(e,t,n){var i=this._modeling,r=Mp(e),o=kp(t,n),a=[];r[t]!==n&&((a=this._getReferencingShapes(r)).length>1&&Ap(r)&&(r=this._replaceDefinition(e),a=e),i.updateProperties(r,o,a))},Pp.prototype._updateRule=function(e,t,n){var i=this,r=i._modeling,o=i._cmmnFactory,a=Ep(e),s=wp(e),c=Mp(e),u=kp(t,n);function l(e,t){return e&&e[t]}function d(e){return!(!e||e.repetitionRule||e.requiredRule||e.manualActivationRule)}n?function(){a||(a=o.create("cmmn:PlanItemControl"),r.updateProperties(e,{itemControl:a}),r.updateSemanticParent(a,bp(e)));r.updateProperties(a,u,e),r.updateSemanticParent(n,a)}():function(){var n;l(a,t)&&(n=a[t],r.updateProperties(a,u,e),r.updateSemanticParent(n),d(a)&&(r.updateProperties(e,{itemControl:void 0}),r.updateSemanticParent(a)));if(l(s,t)){n=s[t];var o=i._getReferencingShapes(c);o.length>1&&Ap(c)&&(o=_p(o,function(e){var n=Ep(e),i=wp(e);return!l(n,t)&&l(i,t)})).length>1&&(i._replaceDefinition(e),s=wp(e),o=e),r.updateProperties(s,u,o),r.updateSemanticParent(n),d(s)&&(r.updateProperties(c,{defaultControl:void 0},o),r.updateSemanticParent(s))}}()},Pp.prototype._replaceDefinition=function(e){var t=this._modeling,n=this._cmmnReplace,i=Mp(e),r=n.replacePlanItemDefinition(i);return t.updateProperties(e,{definitionRef:r}),t.updateSemanticParent(r,i.$parent,"planItemDefinitions"),r},Pp.prototype._getReferencingShapes=function(e){return this._itemRegistry.getShapes(e)};var Op=l.reduce,jp=l.keys,Np=l.forEach,Ip=l.assign,Dp=e.getBusinessObject,Bp="id",Lp="definitionRef",zp="sentryRef",Fp=l.flatten;function $p(e,t,n){this._elementRegistry=e,this._itemRegistry=t,this._moddle=n}$p.$inject=["elementRegistry","itemRegistry","moddle"];var Hp=$p;function Up(e,t){return Bp in e&&e[Bp]!==t[Bp]}function Wp(e,t){return Lp in e&&e[Lp]!==t[Lp]}function Vp(e,t){return zp in e&&e[zp]!==t[zp]}function Gp(e,t){Np(t,function(t,n){e.set(n,t)})}$p.prototype.preExecute=function(e){var t=e.element,n=e.shape;if(!t)throw new Error("element required");var i=t.businessObject||t;e.businessObject=i;var r=[];t.businessObject&&r.push(t),n&&r.push(n),e.changed=Fp(r)},$p.prototype.execute=function(e){var t=this._elementRegistry,n=this._itemRegistry,i=this._moddle.ids,r=e.changed,o=e.element,a=e.businessObject,s=function(e){var t=Ip({},e);return qp.forEach(function(n){n in e&&(t[n]=Dp(t[n]))}),t}(e.properties),c=e.oldProperties||function(e,t){return Op(t,function(t,n){return t[n]=e.get(n),t},{})}(a,jp(s));if(Up(s,a)){i.unclaim(a[Bp]),n.updateId(a,s[Bp]);var u=t.get(o.id);u&&t.updateId(u,s[Bp]),i.claim(s[Bp],a)}return Wp(s,a)&&n.updateReference(a,s[Lp]),Vp(s,a)&&n.updateReference(a,s[zp]),"name"in s&&Np(r,function(e){e.label&&r.push(e.label)}),("standardEvent"in s||"isStandardEventVisible"in s)&&Np(r,function(e){e.label&&r.push(e.label)}),Gp(a,s),e.oldProperties=c,r},$p.prototype.revert=function(e){var t=e.properties,n=e.oldProperties,i=e.businessObject,r=this._elementRegistry,o=this._itemRegistry,a=this._moddle.ids;if(Up(n,i)&&o.updateId(i,n[Bp]),Wp(n,i)&&o.updateReference(i,n[Lp]),Vp(n,i)&&o.updateReference(i,n[zp]),Gp(i,n),Up(t,i)){a.unclaim(t[Bp]);var s=r.get(t[Bp]);s&&r.updateId(s,n[Bp]),a.claim(n[Bp],i)}return e.changed};var qp=["default"];var Kp=l.flatten;function Yp(){}var Xp=Yp;Yp.prototype.preExecute=function(e){var t=e.element,n=e.shape;if(!t)throw new Error("element required");var i=t.businessObject||t;e.businessObject=i,e.oldParent=i.$parent;var r=[];t.businessObject&&r.push(t),n&&r.push(n),e.changed=Kp(r)},Yp.prototype.execute=function(e){var t=e.businessObject,n=e.newParent,i=e.containment;return this.updateSemanticParent(t,n,i),e.changed},Yp.prototype.revert=function(e){var t=e.businessObject,n=e.oldParent,i=e.containment;return this.updateSemanticParent(t,n,i),e.changed},Yp.prototype.updateSemanticParent=function(e,t,n){var i;e.$parent!==t&&(e.$parent&&n&&(i=e.$parent.get(n),Sn.remove(i,e)),e.$parent=null,t&&(n&&(i=t.get(n)).push(e),e.$parent=t))};var Zp={};function Qp(e,t){this._modeling=e,this._canvas=t}Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.default=Qp,Qp.$inject=["modeling","canvas"],Qp.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;(0,l.forEach)(n,function(e){var n={x:0,y:0};i.left?n.x=i.left-e.x:i.right?n.x=i.right-e.width-e.x:i.center?n.x=i.center-Math.round(e.width/2)-e.x:i.top?n.y=i.top-e.y:i.bottom?n.y=i.bottom-e.height-e.y:i.middle&&(n.y=i.middle-Math.round(e.height/2)-e.y),t.moveElements([e],n,e.parent)})},Qp.prototype.postExecute=function(e){};var Jp={};function ef(e,t){this._canvas=e,this._layouter=t}Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.default=ef,ef.$inject=["canvas","layouter"],ef.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,o=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,r,o),t},ef.prototype.revert=function(e){var t=e.connection;this._canvas.removeConnection(t),t.source=null,t.target=null};var tf={};Object.defineProperty(tf,"__esModule",{value:!0}),tf.default=rf;var nf=Math.round;function rf(e){this._canvas=e}rf.$inject=["canvas"],rf.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?(0,l.assign)(t,n):(0,l.assign)(t,{x:n.x-nf(t.width/2),y:n.y-nf(t.height/2)}),this._canvas.addShape(t,i,r),t},rf.prototype.revert=function(e){this._canvas.removeShape(e.shape)};var of={};Object.defineProperty(of,"__esModule",{value:!0}),of.default=uf;var af=cf(u),sf=cf(tf);function cf(e){return e&&e.__esModule?e:{default:e}}function uf(e){sf.default.call(this,e)}(0,af.default)(uf,sf.default),uf.$inject=["canvas"];var lf=sf.default.prototype.execute;uf.prototype.execute=function(e){var t=e.shape;return function(e){["width","height"].forEach(function(t){void 0===e[t]&&(e[t]=0)})}(t),t.labelTarget=e.labelTarget,lf.call(this,e)};var df=sf.default.prototype.revert;uf.prototype.revert=function(e){return e.shape.labelTarget=null,df.call(this,e)};var pf={};function ff(e,t){this._canvas=e,this._modeling=t}Object.defineProperty(pf,"__esModule",{value:!0}),pf.default=ff,ff.$inject=["canvas","modeling"],ff.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=(0,Sn.indexOf)(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},ff.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,(0,Sn.add)(n.children,t,i),this._canvas.addConnection(t,n),t};var hf={};function mf(e,t){this._modeling=e,this._elementRegistry=t}Object.defineProperty(hf,"__esModule",{value:!0}),hf.default=mf,mf.$inject=["modeling","elementRegistry"],mf.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;(0,l.forEach)(i,function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))})};var yf={};Object.defineProperty(yf,"__esModule",{value:!0}),yf.saveClear=function(e,t){if("function"!=typeof t)throw new Error("removeFn iterator must be a function");if(!e)return;var n;for(;n=e[0];)t(n);return e};var vf={};function gf(e,t){this._canvas=e,this._modeling=t}Object.defineProperty(vf,"__esModule",{value:!0}),vf.default=gf,gf.$inject=["canvas","modeling"],gf.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;(0,yf.saveClear)(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),(0,yf.saveClear)(n.outgoing,function(e){t.removeConnection(e,{nested:!0})}),(0,yf.saveClear)(n.children,function(e){e.waypoints?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})})},gf.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=(0,Sn.indexOf)(i.children,n),t.removeShape(n),n},gf.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return(0,Sn.add)(i.children,n,r),t.addShape(n,i),n};var _f={};function xf(e){this._modeling=e}Object.defineProperty(_f,"__esModule",{value:!0}),_f.default=xf,xf.$inject=["modeling"];var bf={x:"y",y:"x"};xf.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function o(e,t){e.range.min=Math.min(t[i],e.range.min),e.range.max=Math.max(t[i]+t[r],e.range.max)}function a(e){return e[i]+e[r]/2}function s(e){return e.length-1}function c(e){return e.max-e.min}var u,d,p=n[0],f=s(n),h=n[f],m=0;(0,l.forEach)(n,function(e,u){var d,p,h;e.elements.length<2?u&&u!==n.length-1&&(o(e,e.elements[0]),m+=c(e.range)):(p=(d=(0,l.sortBy)(e.elements,i))[0],u===f&&(p=d[s(d)]),h=a(p),e.range=null,(0,l.forEach)(d,function(n){!function(e,n){var r={y:0};r[i]=e-a(n),r[i]&&(r[bf[i]]=0,t.moveElements([n],r,n.parent))}(h,n),null!==e.range?o(e,n):e.range={min:n[i],max:n[i]+n[r]}}),u&&u!==n.length-1&&(m+=c(e.range)))}),d=Math.abs(h.range.min-p.range.max),(u=Math.round((d-m)/(n.length-1)))<n.length-1||(0,l.forEach)(n,function(e,o){var a,s={};e!==p&&e!==h&&(a=n[o-1],e.range.max=0,(0,l.forEach)(e.elements,function(n,o){s[bf[i]]=0,s[i]=a.range.max-n[i]+u,e.range.min!==n[i]&&(s[i]+=n[i]-e.range.min),s[i]&&t.moveElements([n],s,n.parent),e.range.max=Math.max(n[i]+n[r],o?e.range.max:0)}))})},xf.prototype.postExecute=function(e){};var Ef={};function wf(e,t){this._layouter=e,this._canvas=t}Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.default=wf,wf.$inject=["layouter","canvas"],wf.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return(0,l.assign)(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},wf.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};var Mf={};function Sf(){}Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.default=Sf,Sf.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldParent=o,e.oldParentIndex=(0,Sn.remove)(o.children,t),(0,Sn.add)(i.children,t,r),t.parent=i,(0,l.forEach)(t.waypoints,function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)}),t},Sf.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,o=e.delta;return(0,Sn.remove)(n.children,t),(0,Sn.add)(i.children,t,r),t.parent=i,(0,l.forEach)(t.waypoints,function(e){e.x-=o.x,e.y-=o.y,e.original&&(e.original.x-=o.x,e.original.y-=o.y)}),t};var Cf={};Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.getNewAttachPoint=function(e,t,n){var i=(0,Wa.center)(t),r=(0,Wa.center)(n),o=(0,Wa.delta)(e,i),a={x:o.x*(n.width/t.width),y:o.y*(n.height/t.height)};return(0,sc.roundPoint)({x:r.x+a.x,y:r.y+a.y})},Cf.getNewAttachShapeDelta=function(e,t,n){var i=(0,Wa.center)(e),r=(0,Wa.center)(t),o=(0,Wa.center)(n),a=(0,Wa.delta)(e,i),s=(0,Wa.delta)(i,r),c={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},u={x:o.x+c.x,y:o.y+c.y};return(0,sc.roundPoint)({x:u.x+a.x-e.x,y:u.y+a.y-e.y})};var Pf={};function Rf(e,t,n){var i=Af(e)[0];return(0,Cf.getNewAttachPoint)(i.original||i,n,t)}function Tf(e,t,n){var i=Af(e),r=i[i.length-1];return(0,Cf.getNewAttachPoint)(r.original||r,n,t)}function kf(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Af(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.getResizedSourceAnchor=Rf,Pf.getResizedTargetAnchor=Tf,Pf.getMovedSourceAnchor=function(e,t,n){return Rf(e,t,kf(t,n))},Pf.getMovedTargetAnchor=function(e,t,n){return Tf(e,t,kf(t,n))};var Of={};function jf(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Object.defineProperty(Of,"__esModule",{value:!0}),Of.default=jf,jf.prototype.add=function(e,t){return this.addAll([e],t)},jf.prototype.addAll=function(e,t){var n=(0,Sr.getClosure)(e,!!t,this);return(0,l.assign)(this,n),this};var Nf={};Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.default=Df;var If=function(e){return e&&e.__esModule?e:{default:e}}(Of);function Df(e){this._modeling=e}Df.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},Df.prototype.moveClosure=function(e,t,n,i,r){var o=this._modeling,a=e.allShapes,s=e.allConnections,c=e.enclosedConnections,u=e.topLevel,d=!1;r&&r.parent===n&&(d=!0),(0,l.forEach)(a,function(e){o.moveShape(e,t,u[e.id]&&!d&&n,{recurse:!1,layout:!1})}),(0,l.forEach)(s,function(e){var i=!!a[e.source.id],r=!!a[e.target.id];c[e.id]&&i&&r?o.moveConnection(e,t,u[e.id]&&!d&&n):o.layoutConnection(e,{connectionStart:i&&(0,Pf.getMovedSourceAnchor)(e,e.source,t),connectionEnd:r&&(0,Pf.getMovedTargetAnchor)(e,e.target,t)})})},Df.prototype.getClosure=function(e){return(new If.default).addAll(e,!0)};var Bf={};Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.default=zf;var Lf=function(e){return e&&e.__esModule?e:{default:e}}(Nf);function zf(e){this._helper=new Lf.default(e)}zf.$inject=["modeling"],zf.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},zf.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)};var Ff={};Object.defineProperty(Ff,"__esModule",{value:!0}),Ff.default=Hf;var $f=function(e){return e&&e.__esModule?e:{default:e}}(Nf);function Hf(e){this._modeling=e,this._helper=new $f.default(e)}Hf.$inject=["modeling"],Hf.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldBounds=(0,l.pick)(t,["x","y","width","height"]),e.oldParent=o,e.oldParentIndex=(0,Sn.remove)(o.children,t),(0,Sn.add)(i.children,t,r),(0,l.assign)(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t},Hf.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;!1!==i.layout&&((0,l.forEach)(t.incoming,function(e){r.layoutConnection(e,{connectionEnd:(0,Pf.getMovedTargetAnchor)(e,t,n)})}),(0,l.forEach)(t.outgoing,function(e){r.layoutConnection(e,{connectionStart:(0,Pf.getMovedSourceAnchor)(e,t,n)})})),!1!==i.recurse&&this.moveChildren(e)},Hf.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return(0,Sn.add)(n.children,t,i),(0,l.assign)(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t},Hf.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)},Hf.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};var Uf={};function Wf(e,t){(0,l.forEach)(t,function(t){e[t]&&delete e[t]})}function Vf(e,t,n,i,r,o){this._eventBus=e,this._canvas=t,this._selection=n,this._elementFactory=i,this._modeling=r,this._rules=o}Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.default=Vf,Vf.$inject=["eventBus","canvas","selection","elementFactory","modeling","rules"],Vf.prototype.preExecute=function(e){var t=this._eventBus,n=this,i=e.tree,r=e.topParent,o=e.position;i.createdElements={},i.labels=[],(0,l.forEach)(i,function(e,a){var s=parseInt(a,10);isNaN(s)||(s||(e=(0,l.map)(e,function(e){return e.parent=r,e})),e=(0,l.sortBy)(e,"priority"),(0,l.forEach)(e,function(e){var a,c=e.id,u=e.parent,d={},p=(0,l.assign)({},e);if(s&&(p.parent=n._getCreatedElement(u,i)),u)if(t.fire("element.paste",{createdElements:i.createdElements,descriptor:p}),u=p.parent,p.waypoints)(p=n._createConnection(p,u,o,i))&&(i.createdElements[c]={element:p,descriptor:e});else{if(p.parent!==r&&(d.root=!1),p.host&&(d.attach=!0,u=n._getCreatedElement(p.host,i)),p.labelTarget)return i.labels.push(p);a={x:Math.round(o.x+p.delta.x+p.width/2),y:Math.round(o.y+p.delta.y+p.height/2)},Wf(p,["id","parent","delta","host","priority"]),(p=n._createShape(p,u,a,d))&&(i.createdElements[c]={element:p,descriptor:e})}}))})},Vf.prototype.postExecute=function(e){var t=this._modeling,n=this._selection,i=this,r=e.tree,o=r.labels,a=[];(0,l.forEach)(o,function(e){var n,o,a,s=i._getCreatedElement(e.labelTarget,r);s&&(n=s.labels)&&n.length&&(o={x:s.x,y:s.y},s.waypoints&&(o=s.waypoints[0]),(0,l.forEach)(n,function(n){a={x:Math.round(o.x-n.x+e.delta.x),y:Math.round(o.y-n.y+e.delta.y)},t.moveShape(n,a,s.parent)}))}),(0,l.forEach)(r[0],function(e){var t=e.id,n=r.createdElements[t];n&&a.push(n.element)}),n.select(a)},Vf.prototype._createConnection=function(e,t,n,i){var r,o,a=this._modeling,s=this._rules;return e.waypoints=(0,l.map)(e.waypoints,function(t,i){return{x:Math.round(n.x+e.delta[i].x),y:Math.round(n.y+e.delta[i].y)}}),r=this._getCreatedElement(e.source,i),o=this._getCreatedElement(e.target,i),r&&o&&s.allowed("element.paste",{source:r,target:o})?(Wf(e,["id","parent","delta","source","target","width","height","priority"]),a.createConnection(r,o,e,t)):null},Vf.prototype._createShape=function(e,t,n,i,r){var o=this._modeling,a=this._elementFactory;if(!this._rules.allowed("element.paste",{element:e,position:n,parent:t}))return null;var s=a.createShape(e);return o.createShape(s,n,t,i,r),s},Vf.prototype._getCreatedElement=function(e,t){return t.createdElements[e]&&t.createdElements[e].element};var Gf={};function qf(e){this._modeling=e}Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.default=qf,qf.$inject=["modeling"],qf.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},(0,l.assign)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},qf.prototype.postExecute=function(e){var t=e.shape,n=e.oldBounds,i=this._modeling;(0,l.forEach)(t.incoming,function(e){i.layoutConnection(e,{connectionEnd:(0,Pf.getResizedTargetAnchor)(e,t,n)})}),(0,l.forEach)(t.outgoing,function(e){i.layoutConnection(e,{connectionStart:(0,Pf.getResizedSourceAnchor)(e,t,n)})})},qf.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return(0,l.assign)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};var Kf={};Object.defineProperty(Kf,"__esModule",{value:!0}),Kf.getDirection=function(e,t){if("x"===e){if(t>0)return"e";if(t<0)return"w"}if("y"===e){if(t>0)return"s";if(t<0)return"n"}return null},Kf.resizeBounds=function(e,t,n){var i=n.x,r=n.y;switch(t){case"n":return{x:e.x,y:e.y+r,width:e.width,height:e.height-r};case"s":return{x:e.x,y:e.y,width:e.width,height:e.height+r};case"w":return{x:e.x+i,y:e.y,width:e.width-i,height:e.height};case"e":return{x:e.x,y:e.y,width:e.width+i,height:e.height};default:throw new Error("unrecognized direction: "+t)}};var Yf={};function Xf(e){this._modeling=e}Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.default=Xf,Xf.$inject=["modeling"],Xf.prototype.preExecute=function(e){var t=this._modeling,n=e.resizingShapes,i=e.delta,r=e.direction;(0,l.forEach)(n,function(e){var n=(0,Kf.resizeBounds)(e,r,i);t.resizeShape(e,n)})},Xf.prototype.postExecute=function(e){var t=this._modeling,n=e.movingShapes,i=e.delta;t.moveElements(n,i,void 0,{autoResize:!1,attach:!1})},Xf.prototype.execute=function(e){},Xf.prototype.revert=function(e){};var Zf={};function Qf(e){this._modeling=e}Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.default=Qf,Qf.$inject=["modeling"],Qf.prototype.execute=function(e){var t,n=e.shape,i=n.children;return e.oldChildrenVisibility=(t={},i.forEach(function(e){t[e.id]=e.hidden}),t),n.collapsed=!n.collapsed,function(e,t){e.forEach(function(e){e.hidden=t})}(i,n.collapsed),[n].concat(i)},Qf.prototype.revert=function(e){var t,n=e.shape,i=e.oldChildrenVisibility,r=n.children;return t=i,r.forEach(function(e){e.hidden=t[e.id]}),n.collapsed=!n.collapsed,[n].concat(r)};var Jf={};function eh(e){this._modeling=e}function th(e,t){return(0,Sn.remove)(e&&e.attachers,t)}function nh(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),(0,Sn.add)(i,t,n)}}Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.default=eh,eh.$inject=["modeling"],eh.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=th(i,t),nh(n,t),t.host=n,t},eh.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,th(n,t),nh(i,t,r),t};var ih={};function rh(){}Object.defineProperty(ih,"__esModule",{value:!0}),ih.default=rh,rh.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},rh.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};var oh={};Object.defineProperty(oh,"__esModule",{value:!0});var ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};oh.default=Th;var sh=Rh(np),ch=Rh(tf),uh=Rh(vf),lh=Rh(Ff),dh=Rh(Gf),ph=Rh(mp),fh=Rh(Zf),hh=Rh(Yf),mh=Rh(of),yh=Rh(Jp),vh=Rh(pf),gh=Rh(Mf),_h=Rh(Ef),xh=Rh(ih),bh=Rh(up),Eh=Rh(Bf),wh=Rh(hf),Mh=Rh(_f),Sh=Rh(Zp),Ch=Rh(Jf),Ph=Rh(Uf);function Rh(e){return e&&e.__esModule?e:{default:e}}function Th(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Th.$inject=["eventBus","elementFactory","commandStack"],Th.prototype.getHandlers=function(){return{"shape.append":sh.default,"shape.create":ch.default,"shape.delete":uh.default,"shape.move":lh.default,"shape.resize":dh.default,"shape.replace":ph.default,"shape.toggleCollapse":fh.default,spaceTool:hh.default,"label.create":mh.default,"connection.create":yh.default,"connection.delete":vh.default,"connection.move":gh.default,"connection.layout":_h.default,"connection.updateWaypoints":xh.default,"connection.reconnectStart":bh.default,"connection.reconnectEnd":bh.default,"elements.move":Eh.default,"elements.delete":wh.default,"elements.distribute":Mh.default,"elements.align":Sh.default,"element.updateAttachment":Ch.default,"elements.paste":Ph.default}},Th.prototype.registerHandlers=function(e){(0,l.forEach)(this.getHandlers(),function(t,n){e.registerHandler(n,t)})},Th.prototype.moveShape=function(e,t,n,i,r){"object"===(void 0===i?"undefined":ah(i))&&(r=i,i=null);var o={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)},Th.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)},Th.prototype.moveElements=function(e,t,n,i){var r,o=(i=i||{}).attach,a=n;!0===o?(r=n,a=n.parent):!1===o&&(r=null);var s={shapes:e,delta:t,newParent:a,newHost:r,hints:i};this._commandStack.execute("elements.move",s)},Th.prototype.moveConnection=function(e,t,n,i,r){"object"===(void 0===i?"undefined":ah(i))&&(r=i,i=void 0);var o={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)},Th.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)},Th.prototype.createConnection=function(e,t,n,i,r,o){"object"===(void 0===n?"undefined":ah(n))&&(o=r,r=i,i=n,n=void 0);var a={source:e,target:t,parent:r,parentIndex:n,connection:i=this._create("connection",i),hints:o};return this._commandStack.execute("connection.create",a),a.connection},Th.prototype.createShape=function(e,t,n,i,r){"number"!=typeof i&&(r=i,i=void 0);var o,a,s=(r=r||{}).attach;e=this._create("shape",e),s?(o=n.parent,a=n):o=n;var c={position:t,shape:e,parent:o,parentIndex:i,host:a,hints:r};return this._commandStack.execute("shape.create",c),c.shape},Th.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape},Th.prototype.appendShape=function(e,t,n,i,r){r=r||{};var o={source:e,position:n,target:i,shape:t=this._create("shape",t),connection:r.connection,connectionParent:r.connectionParent,attach:r.attach};return this._commandStack.execute("shape.append",o),o.shape},Th.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)},Th.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)},Th.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)},Th.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)},Th.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},Th.prototype.pasteElements=function(e,t,n){var i={tree:e,topParent:t,position:n};this._commandStack.execute("elements.paste",i)},Th.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)},Th.prototype.resizeShape=function(e,t,n){var i={shape:e,newBounds:t,minBounds:n};this._commandStack.execute("shape.resize",i)},Th.prototype.createSpace=function(e,t,n,i){var r={movingShapes:e,resizingShapes:t,delta:n,direction:i};this._commandStack.execute("spaceTool",r)},Th.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)},Th.prototype.reconnectStart=function(e,t,n){var i={connection:e,newSource:t,dockingOrPoints:n};this._commandStack.execute("connection.reconnectStart",i)},Th.prototype.reconnectEnd=function(e,t,n){var i={connection:e,newTarget:t,dockingOrPoints:n};this._commandStack.execute("connection.reconnectEnd",i)},Th.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)},Th.prototype._create=function(e,t){return t instanceof B.Base?t:this._elementFactory.create(e,t)},Th.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};var kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ah=l.assign,Oh=oh.default;function jh(e,t,n,i,r){Oh.call(this,e,t,n),this._cmmnRules=i,this._rules=r}u(jh,Oh),jh.$inject=["eventBus","elementFactory","commandStack","cmmnRules","rules"];var Nh=jh;jh.prototype.getHandlers=function(){var e=Oh.prototype.getHandlers.call(this);return e["shape.append"]=ap,e["shape.replace"]=gp,e["connection.reconnectStart"]=hp,e["connection.reconnectEnd"]=hp,e["element.updateProperties"]=Hp,e["element.updateSemanticParent"]=Xp,e["element.updateControls"]=Rp,e["id.updateClaim"]=cp,e},jh.prototype.connect=function(e,t,n){var i=this._rules;return n||(n=i.allowed("connection.create",{source:e,target:t})||{type:"cmmn:Association"}),n.reverse?this.createConnection(t,e,n,t.parent):this.createConnection(e,t,n,e.parent)},jh.prototype.createConnection=function(e,t,n,i,r){"object"===(void 0===n?"undefined":kh(n))&&(r=i,i=n,n=void 0);var o={source:e,target:t,parent:r,parentIndex:n,canExecute:i};return i=this._create("connection",i),Ah(o,{connection:i}),this._commandStack.execute("connection.create",o),o.connection},jh.prototype.reconnectStart=function(e,t,n,i){var r={connection:e,newSource:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectStart",r)},jh.prototype.reconnectEnd=function(e,t,n,i){var r={connection:e,newTarget:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectEnd",r)},jh.prototype.updateProperties=function(e,t,n){this._commandStack.execute("element.updateProperties",{element:e,properties:t,shape:n})},jh.prototype.updateSemanticParent=function(e,t,n,i){this._commandStack.execute("element.updateSemanticParent",{element:e,newParent:t,containment:n,shape:i})},jh.prototype.updateControls=function(e,t){this._commandStack.execute("element.updateControls",{element:e,values:t})},jh.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},jh.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};var Ih=ss.default,Dh=e.is,Bh=e.isCasePlanModel;function Lh(e){Ih.call(this,e),this.preExecute(["shape.create","elements.move"],function(e){var t=e.shape,n=e.shapes,i=e.parent||e.newParent,r=e.host||e.newHost;i&&r&&Bh(r)&&(n&&n.length>1||(t=t||n[0],Dh(t,"cmmn:Criterion")&&(e.parent=e.parent&&r,e.newParent=e.newParent&&r)))},!0)}Lh.$inject=["eventBus"],u(Lh,Ih);var zh=Lh,Fh=ss.default,$h=l.forEach,Hh=l.filter,Uh=l.reduce,Wh=e.getDefinition,Vh=e.getBusinessObject,Gh=e.is,qh=Q.getCase,Kh=Q.getParent,Yh=Q.isSameCase,Xh=Q.isLabel;function Zh(e,t,n,i){this._cmmnFactory=n,this._modeling=i,Fh.call(this,e);var r="caseFileItems";function o(e){var t=qh(e),r=t.caseFileModel;return r||(r=n.createCaseFileModel(t),i.updateProperties(t,{caseFileModel:r})),r}function a(e){var t=e&&e.get(r);if(t&&!t.length){var n="caseFileModel",o=e.$parent;em(e)||(n="children");var a={};a[n]=void 0,i.updateProperties(o,a),i.updateSemanticParent(e)}}function s(e){var t=(e=Vh(e)).sourceRef;t&&(c(t,function(t){return e===t}),i.updateProperties(e,{sourceRef:void 0}))}function c(e,t){var n,r=(e=Vh(e))&&e.get("targetRefs");r&&r.length&&(n=r.slice(),$h(r,function(r){if(!t||t(r)){r.sourceRef===e&&i.updateProperties(r,{sourceRef:void 0});var o=n.indexOf(r);-1!==o&&n.splice(o,1)}}),r.length!==n.length&&i.updateProperties(e,{targetRefs:n}))}function u(e,t,n){var o=(e=Vh(e)).children,s=o&&o.get(r);s&&s.length&&($h(s,function(e){(!n||n(e))&&i.updateSemanticParent(e,t,r)}),a(o))}this.preExecuted("shape.create",function(e){var t,n,a,s=e.shape,c=e.parent,u=Vh(c);Jh(s)&&((n=Wh(s))&&(t=Kh(u,"cmmn:Definitions"),i.updateSemanticParent(n,t,"caseFileItemDefinitions")),a=o(c),i.updateSemanticParent(s,a,r))},!0),this.preExecuted("elements.move",function(e){var t,n=e.newParent,l=e.hints,d=l&&l.primaryShape&&l.primaryShape.parent,p=(e.closure||{}).allShapes;n&&d!==n&&((p=Hh(p,function(e){return Jh(e)&&!Xh(e)&&!Yh(e.parent,n)}))&&p.length&&(t=o(n),p=Uh(p,function(e,t){return e[t.id]=t,e},{}),$h(p,function(e){var n=Vh(e),o=tm(n),l=Kh(n);if(em(l))i.updateSemanticParent(e,t,r);else{var d=Kh(n,"cmmn:CaseFileItem");p[d.id]||i.updateSemanticParent(e,t,r)}var f=n.sourceRef;f&&!p[f.id]&&s(n),c(n,function(e){return!p[e.id]}),u(n,o,function(e){return!p[e.id]}),a(l)})))},!0),this.postExecuted("shape.delete",function(e){var n,o=e.shape,l=Vh(o);if(Jh(o)&&!Xh(o)){var d,p=Kh(l),f=tm(l);i.updateSemanticParent(o,null,r),s(o),c(o),u(l,f),a(p),(d=Wh(o))&&1===t.getReferences(d).length&&(n=Wh(o),i.updateSemanticParent(n,null,"caseFileItemDefinitions"))}},!0)}Zh.$inject=["eventBus","itemRegistry","cmmnFactory","modeling"],u(Zh,Fh);var Qh=Zh;function Jh(e){return Gh(e,"cmmn:CaseFileItem")}function em(e){return Gh(e,"cmmn:CaseFile")}function tm(e){return Kh(Vh(e),"cmmn:CaseFile")}var nm=l.assign,im=e.getBusinessObject,rm=e.getName,om=cn.hasExternalLabel,am=cn.getExternalLabelMid,sm=me.isStandardEventVisible,cm=Q.isAny,um=ss.default;function lm(e,t,n){um.call(this,e),this.postExecuted(["shape.create","connection.create"],200,function(e){var n,i=e.context,r=i.shape||i.connection,o=r.businessObject;om(o)&&(n=am(r),t.createLabel(r,n,{id:o.id+"_label",hidden:!rm(r)&&!sm(o),businessObject:o}))}),this.postExecute(["connection.updateWaypoints"],function(e){var n=e.context.connection,i=n.label;if(i&&i.hidden){var r=am(n),o={x:r.x-i.x-i.width/2,y:r.y-i.y-i.height/2};t.moveShape(i,o)}}),this.postExecute(["shape.replace"],function(e){var t=e.context,n=t.newShape,i=t.oldShape,r=im(n);r&&om(r)&&(n.label.x=i.label.x,n.label.y=i.label.y)}),this.executed(["label.create"],function(e){var t,i,r=e.context.shape;r.labelTarget&&cm(r.labelTarget||r,["cmmn:CMMNElement","cmmndi:CMMNDiagramElement"])&&((i=(t=r.businessObject).di||t).label||(i.label=n.createDiLabel()),i.label.bounds||(i.label.bounds=n.createDiBounds()),nm(i.label.bounds,{x:r.x,y:r.y,width:r.width,height:r.height}))})}u(lm,um),lm.$inject=["eventBus","modeling","cmmnFactory"];var dm=lm,pm=l.forEach,fm=l.unionBy,hm=l.filter,mm=ss.default,ym=e.is,vm=e.getDefinition,gm=e.getBusinessObject,_m=Q.getParents,xm=Q.getParent,bm=Q.getCase,Em=Q.isLabel,wm=Pc.getAllDiscretionaryItems,Mm=Pc.getDirectItemCapables,Sm=Pc.isItemCapable,Cm=Pc.isHumanTask,Pm=400;function Rm(e,t,n,i){this._modeling=t,this._cmmnReplace=n,this._itemRegistry=i;var r=this;mm.call(this,e);this.postExecuted("shape.create",function(e){var n=e.shape;if(Sm(n)){var i=gm(n),r=vm(i),o=km(i);xm(r)||t.updateSemanticParent(r,o,"planItemDefinitions")}},!0),this.postExecuted("shape.replace",function(e){var t=e.newShape;Sm(t)&&r.updatePlanItemDefinitions([t])},!0),this.postExecuted("shape.delete",function(e){var t,n=e.shape,i={};Sm(n)&&!Em(n)&&(i[(t=vm(n)).id]=t,r.deletePlanItemDefinitions(i))},!0),this.preExecuted("shape.delete",function(e){var t=e.shape,n=vm(t);Cm(n)&&!n.$parent&&(e.discretionaryItems=e.discretionaryItems||wm(n))},!0),this.postExecuted("shape.delete",Pm,function(e){var t=e.discretionaryItems,n=[];pm(t,function(e){var t=i.getShape(e.id);t&&n.push(t)}),n&&n.length&&r.updatePlanItemDefinitions(n)},!0),this.preExecuted("elements.move",function(e){var r,o,a=e.closure.allShapes,s=e.newParent,c=e.hints,u=c&&c.primaryShape&&c.primaryShape.parent,l={},d={};s&&u!==s&&(o=bm(s),r=hm(a,function(e){if(Sm(e)&&!Em(e)&&bm(e)!==o){var t=vm(e);return d[t.id]=d[t.id]||[],d[t.id].push(e),!0}return!1}),pm(r,function(e){var r,o,a,s=vm(e);l[s.id]?a=l[s.id]:(r=i.getReferences(s.id),o=d[s.id],r.length>o.length&&(a=l[s.id]=n.replacePlanItemDefinition(s))),a&&a!==s&&t.updateProperties(e,{definitionRef:a})}),e.definitionReplacements=l)},!0),this.postExecuted("elements.move",Pm,function(e){var t=e.shapes,n=e.newParent,i=e.hints&&e.hints.oldParent;n&&i!==n&&(t=hm(t,function(e){return Sm(e)&&!Em(e)}))&&t.length&&r.updatePlanItemDefinitions(t)},!0),this.postExecuted(["connection.create","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Pm,function(e){var t=e.connection,n=(e.newSource||e.source||t.source,e.newTarget||e.target||t.target,[]);(function(e,t,n){return!e.businessObject.cmmnElementRef})(t)&&(t.target&&n.push(t.target),!t.target&&e.target&&n.push(e.target),e.oldTarget&&n.push(e.oldTarget),n&&n.length&&r.updatePlanItemDefinitions(n))},!0),this.deletePlanItemDefinitions=function(e){pm(e,function(e){i.getReferences(e).length||t.updateSemanticParent(e,null,"planItemDefinitions")})},this.updatePlanItemDefinitions=function(e){!function(e,t){var n={};!function e(r,o){pm(r,function(r){if(!function(e){return!!n[e.id]}(r)){!function(e){n[e.id]=e}(r),r=i.getShape(r.id)||r;var a=t(r);a&&a.length&&e(a)}o&&(n={})})}(e,!0)}(e,function(e){var n,r=gm(e),o=vm(r),a=function(e){var t,n;if(e.length)if(n=e.splice(0,1)[0],e.length){var i=Am(n);pm(e,function(e){var t,n;t=i,n=Am(e),i=hm(t,function(e){return-1!==n.indexOf(e)})}),t=i[0]}else t=km(n);return t}(i.getReferences(o));a||(a=(n=xm(r,"cmmn:Case"))&&n.casePlanModel),a&&a!==o.$parent&&t.updateSemanticParent(o,a,"planItemDefinitions");var s=Mm(o),c=[];return ym(o,"cmmn:PlanFragment")&&e.children&&e.children.length&&pm(e.children,function(e){var t=gm(e);Sm(t)&&!Em(t)&&-1===s.indexOf(t)&&c.push(t)}),fm("id",s,c)})}}Rm.$inject=["eventBus","modeling","cmmnReplace","itemRegistry"],u(Rm,mm);var Tm=Rm;function km(e){return e=gm(e),xm(e,"cmmn:Stage")}function Am(e){return e=gm(e),_m(e,"cmmn:Stage")}var Om=ss.default,jm=l.some,Nm=l.forEach,Im=e.is,Dm=e.isCasePlanModel,Bm=e.getDefinition,Lm=e.getBusinessObject,zm=Q.getParent,Fm=Q.isLabel,$m=Q.getParents,Hm=Pc.isDiscretionaryToHumanTask,Um=Pc.isDiscretionaryItem,Wm=Pc.isPlanFragment,Vm=Pc.getAllDiscretionaryItems,Gm=Pc.isHumanTask;function qm(e,t,n,i){this._cmmnFactory=t,this._modeling=n,this._itemRegistry=i;var r=this;Om.call(this,e);function o(e){return!e.businessObject.cmmnElementRef}this.preExecuted(["connection.delete","connection.reconnectEnd","connection.reconnectStart"],function(e){var t=e.context,i="connection.reconnectStart"===e.command,a=t.connection,s=a.target;if(o(a)){if(i){if(!t.newSource||!t.newTarget)return;s=t.newSource,t.oldPlanningTable=Xm(s)}if(t.planningTable=Xm(s),s!==t.newTarget&&!function(e,t){return jm(e.incoming,function(e){return e!==t&&o(e)})}(s,a)){var c=Ym(s.parent),u=r.createPlanningTable(c);n.updateSemanticParent(s,u,"tableItems")}}}),this.postExecuted("connection.delete",function(e){o(e.connection)&&r.deletePlanningTable(e.planningTable)},!0),this.postExecuted("connection.reconnectEnd",function(e){var t=e.connection,i=t.target;if(o(t)){var a=Xm(i);n.updateSemanticParent(i,e.planningTable,"tableItems"),r.deletePlanningTable(a)}},!0),this.postExecuted("connection.reconnectStart",function(e){o(e.connection)&&e.newSource&&e.newTarget&&r.deletePlanningTable(e.oldPlanningTable)},!0),this.preExecuted(["connection.create","connection.reconnectStart"],function(e){var t=e.connection,i=e.newSource||e.source,a=e.target||e.newTarget||t.target;if(o(t)){e.planningTable=Xm(a);var s=Bm(i);if(t.source)if(Bm(t.source)===s)return;var c=r.createPlanningTable(s);n.updateSemanticParent(a,c,"tableItems")}},!0),this.postExecuted(["connection.create","connection.reconnectStart"],function(e){o(e.connection)&&r.deletePlanningTable(e.planningTable)},!0),this.preExecuted("elements.move",500,function(e){var o=e.closure.allShapes,a=e.newParent,s=e.hints,c=s&&s.primaryShape&&s.primaryShape.parent,u=e.definitionReplacements,l=[],d={};a&&c!==a&&Nm(o,function(e){var a,s,c,p,f,h=Lm(e),m=[];if(Um(e)&&!Fm(e)&&(a=zm(h,"cmmn:PlanItemDefinition"),Im(a,"cmmn:HumanTask")&&(s=u[a.id])&&-1===(Vm(s)||[]).indexOf(h))){if(c=Vm(a),!jm(c,function(e){return!o[e.id]})){var y=a.planningTable;return n.updateProperties(s,{planningTable:y},i.getShapes(s)),n.updateSemanticParent(y,s),void n.updateProperties(a,{planningTable:void 0},i.getShapes(a))}if((p=$m(h,"cmmn:PlanningTable"))&&p.length){Nm(p,function(e){var i,r=l.indexOf(e);i=-1===r?function(e){var n=t.create("cmmn:PlanningTable",{applicabilityRules:e.applicabilityRules}),i=l.push(e);return d[i-1]=n,n}(e):d[r],f&&!f.$parent&&n.updateSemanticParent(f,i,"tableItems"),f=i,m.push(i)}),s.planningTable||(n.updateProperties(s,{planningTable:f},i.getShapes(s)),n.updateSemanticParent(f,s));var v=m.splice(0,1)[0],g=Xm(h);n.updateSemanticParent(h,v,"tableItems"),r.deletePlanningTable(g)}}})},!0),this.preExecuted(["shape.create","shape.move"],function(e){var t=e.shape;if(Um(t)&&!Fm(t)&&!Hm(t)){e.planningTable=Xm(t);var i=e.parent||e.newParent;if(i){var o=Ym(i),a=r.createPlanningTable(o);n.updateSemanticParent(t,a,"tableItems")}}},!0),this.postExecuted("shape.move",function(e){var t=e.shape;Um(t)&&!Fm(t)&&(Hm(t)||r.deletePlanningTable(e.planningTable))},!0),this.preExecuted("shape.delete",function(e){var t=e.shape;Um(t)&&!Fm(t)&&(e.planningTable=Xm(t),n.updateSemanticParent(t,null,"tableItems"))},!0),this.postExecuted("shape.delete",function(e){var t=e.shape;Um(t)&&!Fm(t)&&r.deletePlanningTable(e.planningTable)},!0),this.postExecuted("shape.delete",500,function(e){var t=e.shape,o=Bm(t);if(Gm(o)&&!o.$parent){var a=Vm(o);Nm(a,function(e){var t=i.getShape(e.id);if(t){var o=Ym(t.parent),a=r.createPlanningTable(o);n.updateSemanticParent(t,a,"tableItems")}}),o.planningTable&&r.deletePlanningTable(o.planningTable)}},!0),this.createPlanningTable=function(e){var t=e.planningTable;if(!t){t=r._cmmnFactory.create("cmmn:PlanningTable");var o=i.getShapes(e);n.updateProperties(e,{planningTable:t},o),n.updateSemanticParent(t,e)}return t},this.deletePlanningTable=function(e){if(!(e.get("tableItems").length>0)){for(var t=e.$parent;Im(t,"cmmn:PlanningTable")&&!e.get("tableItems").length;)n.updateSemanticParent(e,null,"tableItems"),e=t,t=t.$parent;if(Im(t,"cmmn:PlanItemDefinition")&&e&&!e.get("tableItems").length){var r=zm(e,"cmmn:PlanItemDefinition"),o=i.getShapes(r);n.updateProperties(r,{planningTable:void 0},o),n.updateSemanticParent(e,null,null)}}}}qm.$inject=["eventBus","cmmnFactory","modeling","itemRegistry"],u(qm,Om);var Km=qm;function Ym(e){var t=function e(t){if(t&&!Dm(t)){var n=Bm(t);Wm(n)&&(t=zm(t,["cmmn:Stage","cmmn:PlanItem","cmmn:DiscretionaryItem"]),t=e(t))}return t}(e);return Bm(t)||Lm(t)}function Xm(e){return e=Lm(e),zm(e,"cmmn:PlanningTable")}var Zm=l.forEach,Qm=l.assign,Jm=l.isArray,ey=ss.default,ty=e.is,ny=200,iy=5e3;function ry(e,t,n,i,r){function o(e,t){return n.canConnectPlanItemOnPartConnection(e,t)}function a(e,t){return n.canConnectCaseFileItemOnPartConnection(e,t)}function s(e,t,i){return n.canConnectDiscretionaryConnection(e,t,i)}function c(e,r,c,u){var l=e.parent;if(u=u||{},r=r||e.source,c=c||e.target,l){var d,p,f=sy(e);if(f?(ty(f,"cmmn:PlanItemOnPart")&&(o(r,c)||(d=!0),a(r,c)&&(p={type:"cmmn:CaseFileItemOnPart",name:f.name,isStandardEventVisible:ay(e)}),s(r,c,e)&&(p={type:"cmmndi:CMMNEdge"})),ty(f,"cmmn:CaseFileItemOnPart")&&(a(r,c)||(d=!0),o(r,c)&&(p={type:"cmmn:PlanItemOnPart",name:f.name,isStandardEventVisible:ay(e)})),ty(f,"cmmn:Association")&&!function(e,t){return n.canConnectAssociation(e,t)}(r,c)&&(d=!0)):(s(r,c,e)||(d=!0),o(r,c)&&(p={type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0})),d&&(p||!cy(r)&&!cy(c)||(p={type:"cmmn:Association"}),t.removeConnection(e)),p){var h=Qm({waypoints:e.waypoints.slice()},p),m=t.connect(r,c,h);return!1!==u.select&&i.select(m),m}}}ey.call(this,e),this.postExecuted("elements.move",ny,function(e){var t=e.closure.allConnections;Zm(t,function(e){c(e,null,null,{select:!1})})},!0),this.preExecute(["connection.reconnectEnd","connection.reconnectStart"],iy+ny,function(e){var t=e.command,n="connection.reconnectStart"===t,i=e.context,o=i.connection,a=i.newSource||o.source,s=i.newTarget||o.target,c=i.dockingOrPoints,u=i.canExecute;if(!i.hints||!i.hints.nested){if(void 0===u){var l={connection:o};l[n?"hover":"source"]=a,l[n?"target":"hover"]=s,u=function(e,t){return r.allowed(e,t)}(t,l)}if(u&&u.reverse){if(!Jm(c)){var d=o.waypoints.slice();d.splice(n?0:-1,1,c),c=d}i.newSource=s,i.newTarget=a,i.dockingOrPoints=c.reverse()}}}),this.preExecute(["connection.reconnectStart","connection.reconnectEnd"],iy,function(e){var t=e.connection,n=e.newSource||t.source,i=e.newTarget||t.target,r=e.hints||{};e.connection=c(t,n,i,{select:!r.nested})||t},!0),this.postExecuted("shape.replace",function(e){var n=e.newShape,i=n.businessObject,r=function(e){var t=e.attachers,n=[];return Zm(t,function(e){Zm(e.outgoing,function(e){n.push(e)})}),n}(n);Zm(r,function(e){var n=e.source,r=e.target,a=sy(e);ty(a,"cmmn:PlanItemOnPart")&&(o(n,r)?t.updateProperties(a,{sourceRef:i},e):t.removeConnection(e))})},!0),this.postExecuted("element.updateProperties",function(e){var t=e.properties,n=e.changed;t&&!1===t.isBlocking&&Zm(n,function(e){var t=e.outgoing;Zm(t,function(e){c(e,null,null,{select:!1})})})},!0)}u(ry,ey),ry.$inject=["eventBus","modeling","cmmnRules","selection","rules"];var oy=ry;function ay(e){return e.businessObject.isStandardEventVisible}function sy(e){return e.businessObject&&e.businessObject.cmmnElementRef}function cy(e){return ty(e,"cmmn:TextAnnotation")}var uy=ss.default,ly=yf.saveClear,dy=e.is,py=e.getDefinition,fy=e.getSentry,hy=l.forEach,my=l.filter,yy=l.assign,vy=6e3,gy=500,_y=100;function xy(e,t,n,i,r,o,a,s){uy.call(this,r),this._cmmnReplace=e,this._cmmnRules=t,this._elementFactory=n,this._elementRegistry=i,this._modeling=o,this._selection=a,this._rules=s;var c=this;this.preExecute(["shape.create","shape.append"],vy,function(e){var i=e.shape,r=e.source,o=e.parent||e.target||r&&r.parent,a=e.host,s=e.position;if(!(e.hints||{}).nested&&(a&&Ey(i)&&(o=a),!t.canCreate(i,o,r,s))){var c=t.canReplace([i],o,s,r);if(c&&c.replacements){var u=c.replacements[0],l=py(i),d=fy(i),p=u.newElementType,f=u.newDefinitionType||l&&l.$type,h=yy({},{type:p});f&&yy(h,{definitionType:f}),d&&yy(h,{sentryRef:d}),e.shape=n.createShape(h)}}},!0),this.postExecuted("elements.move",gy,function(e){var n=e.newParent,i=e.newHost,r=e.shapes.slice();if(1===r.length&&i?n=i:r=my(r,function(e){return!Ey(e)}),n&&!t.canMove(r,n)){var o=t.canReplace(r,n);o&&o.replacements&&c.replaceElements(r,o.replacements)}},!0),this.postExecuted(["shape.replace"],1500,function(e){var t=e.context,n=t.oldShape,i=t.newShape;o.unclaimId(n.businessObject.id,n.businessObject),o.updateProperties(i,{id:n.id})}),this.preExecute("connection.create",vy,function(e){var t=e.source,n=e.target,i=e.canExecute||function(e,t){return s.allowed("connection.create",{source:e,target:t})}(t,n);if(i&&i.replacements){var r=c.replaceElements([t,n],i.replacements,{select:!1});e.source=r[t.id]||e.source,e.target=r[n.id]||e.target,yy(i,{replacedBy:i.reverse?e.source:e.target})}},!0),r.on("connect.end",gy+_y,function(e){var t=e.context.canExecute,n=t&&t.replacedBy;n&&(e.context.target=n)}),this.preExecute(["connection.reconnectStart","connection.reconnectEnd"],vy,function(e){var t,n=e.command,i="connection.reconnectStart"===n,r=e.context,o=r.connection,a=r.newSource||o.source,u=r.newTarget||o.target,l={connection:o};if(!r.hints||!r.hints.nested){if(l[i?"hover":"source"]=a,l[i?"target":"hover"]=u,(t=function(e,t){return s.allowed(e,t)}(n,l))&&t.replacements){var d=c.replaceElements([a,u],t.replacements,{select:!1});r.newSource=d[a.id]||r.newSource,r.newTarget=d[u.id]||r.newTarget}r.canExecute=t}}),this.preExecute("shape.delete",vy,function(e){var t=e.shape,n=Ey(t)?t.host:t.parent,i=py(n);dy(i,"cmmn:Stage")||ly(t.incoming,function(e){o.removeConnection(e,{nested:!0,endChanged:!0})})},!0),this.postExecuted(["connection.delete","connection.reconnectEnd"],gy,function(e){var n=e.target||e.oldTarget,i=[n],r=Ey(n)?n.host:n.parent;if(!(e.hints||{}).endChanged&&r&&!t.canMove(i,r)){var o=t.canReplace(i,r);o&&o.replacements&&c.replaceElements(i,o.replacements,{select:!1})}},!0),this.postExecuted("element.updateProperties",function(e){var n=e.properties,i=e.changed;n&&!1===n.isBlocking&&hy(i,function(e){var n=e.attachers,i=t.canReplace(n,e);i&&c.replaceElements(n,i.replacements,{select:!1})})},!0),this.replaceElements=function(e,t,n){var i=this,r=this._elementRegistry,o=this._selection,a={};return n=n||{},hy(t,function(t){var n,o=r.get(t.oldElementId),s=e.indexOf(o);o&&(n=i.replaceElement(o,t),-1!==s&&(e[s]=n),a[o.id]=n)}),t&&!1!==n.select&&o.select(e),a},this.replaceElement=function(e,t){var n=this._cmmnReplace,i=py(e),r=t.newDefinitionType||i&&i.$type;if(e){var o={type:t.newElementType};return r&&yy(o,{definitionType:r}),n.replaceElement(e,o,{select:!1})}}}xy.$inject=["cmmnReplace","cmmnRules","elementFactory","elementRegistry","eventBus","modeling","selection","rules"],u(xy,uy);var by=xy;function Ey(e){return dy(e,"cmmn:Criterion")}var wy={};Object.defineProperty(wy,"__esModule",{value:!0});var My="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};wy.resizeBounds=function(e,t,n){var i=n.x,r=n.y;switch(t){case"nw":return{x:e.x+i,y:e.y+r,width:e.width-i,height:e.height-r};case"sw":return{x:e.x+i,y:e.y,width:e.width-i,height:e.height+r};case"ne":return{x:e.x,y:e.y+r,width:e.width+i,height:e.height-r};case"se":return{x:e.x,y:e.y,width:e.width+i,height:e.height+r};default:throw new Error("unrecognized direction: "+t)}},wy.ensureConstraints=function(e,t){if(!t)return e;var n=(0,sc.asTRBL)(e);return(0,sc.asBounds)({top:Ry("top",n,t),right:Ry("right",n,t),bottom:Ry("bottom",n,t),left:Ry("left",n,t)})},wy.getMinResizeBounds=function(e,t,n,i){var r=(0,sc.asTRBL)(t),o={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},a=i?(0,sc.asTRBL)(i):o,s={top:Cy(o.top,a.top),left:Cy(o.left,a.left),bottom:Sy(o.bottom,a.bottom),right:Sy(o.right,a.right)};return(0,sc.asBounds)(s)},wy.addPadding=ky,wy.computeChildrenBBox=function(e,t){var n;n=void 0===e.length?(0,l.filter)(e.children,Ay):e;if(n.length)return ky((0,Sr.getBBox)(n),t)};var Sy=Math.max,Cy=Math.min,Py=20;function Ry(e,t,n){var i=t[e],r=n.min&&n.min[e],o=n.max&&n.max[e];return(0,l.isNumber)(r)&&(i=(/top|left/.test(e)?Cy:Sy)(i,r)),(0,l.isNumber)(o)&&(i=(/top|left/.test(e)?Sy:Cy)(i,o)),i}function Ty(e,t){return void 0!==e?e:Py}function ky(e,t){var n,i,r,o;return"object"===(void 0===t?"undefined":My(t))?(n=Ty(t.left),i=Ty(t.right),r=Ty(t.top),o=Ty(t.bottom)):n=i=r=o=Ty(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+o}}function Ay(e){return!e.waypoints&&"label"!==e.type}var Oy=e.is,jy=e.getBusinessObject,Ny=e.isCasePlanModel,Iy=l.filter,Dy=Sr.getBBox,By=1001,Ly=10;function zy(e){var t,n,i=e.shape,r=e.direction;return t=e.minDimensions||{width:Ly,height:Ly},n=function(e,t){var n=Iy(e.children,function(t){return function(e,t){if(t.waypoints)return!1;if("label"===t.type)return!1;if(Oy(t,"cmmn:ExitCriterion")){var n=jy(e),i=n.get("exitCriteria"),r=jy(t);if(i.indexOf(r)>=0)return!1}return!0}(e,t)});if(n.length)return wy.addPadding(Dy(n),t)}(i,e.childrenBoxPadding),wy.getMinResizeBounds(r,i,t,n)}function Fy(e,t){e.on("resize.start",By,function(e){var t=e.context,n=t.shape;Ny(n)&&(t.minBounds=zy(t))})}Fy.$inject=["eventBus","modeling"];var $y=Fy,Hy=ss.default,Uy=l.forEach,Wy=l.flatten,Vy=l.groupBy,Gy=l.map,qy=l.some,Ky=e.is,Yy=e.isCasePlanModel,Xy=e.getSentry,Zy=e.getBusinessObject,Qy=e.getDefinition,Jy=e.getStandardEvents,ev=Q.getParent,tv=Pc.isItemCapable,nv=Pc.getAllDiscretionaryItems,iv=Pc.getDirectItemCapables,rv=Pc.isHumanTask,ov=300;function av(e,t,n,i,r){var o=this;Hy.call(this,e);function a(e){var t=uv(e);return s(e,function(e){var n=Qy(e);if(rv(n)){var i=nv(e);return i&&i.length&&(t=t.concat(uv(i))),i}return iv(e)}),Wy(t)}function s(e,t){var i={};!function e(r,o){Uy(r,function(r){if(!function(e){return!!i[e.id]}(r)){!function(e){i[e.id]=e}(r),r=n.getShape(r.id)||r;var a=t(r);a&&a.length&&e(a)}o&&(i={})})}(e,!0)}function c(e){var t=r.createSentry();return u(e,t),t}function u(e,n){t.updateProperties(e,{sentryRef:n})}function l(e,n){t.updateProperties(e,{cmmnElementRef:n})}function d(e){var t={name:e.name,sourceRef:e.sourceRef,standardEvent:e.standardEvent};return Ky(e,"cmmn:PlanItemOnPart")&&(t.exitCriterionRef=e.exitCriterionRef),r.create(e.$type,t)}function p(e){var t=e.businessObject.cmmnElementRef;return Ky(t,"cmmn:OnPart")}this.postExecuted("connection.create",function(e){var n=e.connection;if(p(n)){var i=dv(n),r=n.target,o=r.host,a=Xy(r);a||(a=c(r),t.updateSemanticParent(a,cv(o),"sentries")),t.updateSemanticParent(i,a,"onParts",n)}},!0),this.preExecuted("connection.delete",function(e){var n=e.connection;if(p(n)){var i=n.source,r=dv(n);lv(i,n)&&l(n,r=d(r)),t.updateSemanticParent(r,null,"onParts",n)}},!0),this.preExecuted("connection.reconnectStart",function(e){var n=e.connection,i=n.source;if(p(n)){var r=dv(n),o=n.target,a=Xy(o);lv(i,n)&&(l(n,r=d(r)),t.updateSemanticParent(r,a,"onParts",n))}},!0),this.preExecuted("connection.reconnectEnd",function(e){var n=e.connection,i=n.source;if(p(n)){var r=dv(n),o=n.target,a=Xy(o),s=e.newTarget,u=Xy(s);a!==u&&(u||(u=c(s),t.updateSemanticParent(u,cv(s.host),"sentries")),lv(i,n)&&l(n,r=d(r)),t.updateSemanticParent(r,u,"onParts",n))}},!0),this.postExecuted(["connection.create","connection.reconnectStart"],function(e){var n=e.connection;if(p(n)){var i,r=dv(n);(function(e){var t=dv(e),n=t.standardEvent,i=Jy(t);return n&&-1!==i.indexOf(n)})(n)||(i=function(e){if(e=dv(e),Ky(e.sourceRef,"cmmn:CaseFileItem"))return"update";if(Ky(e.exitCriterionRef,"cmmn:ExitCriterion"))return"exit";if(Ky(e.sourceRef,"cmmn:PlanItem")){var t=Qy(e.sourceRef);return Ky(t,"cmmn:EventListener")||Ky(t,"cmmn:Milestone")?"occur":"complete"}}(n),t.updateProperties(r,{standardEvent:i},n))}},!0),this.postExecuted("element.updateAttachment",function(e){var t=e.shape;Ky(t,"cmmn:Criterion")&&(t.host?o.updateSentriesSemanticParent([t]):o.deleteSentry(t))},!0),this.preExecuted("shape.delete",function(e){var t=Qy(e.shape);rv(t)&&(e.discretionaryItems=e.discretionaryItems||nv(t))},!0),this.postExecuted("shape.delete",ov,function(e){var t;(t=a(e.discretionaryItems))&&t.length&&o.updateSentriesSemanticParent(t)},!0),this.postExecuted(["connection.create","connection.delete","connection.reconnectEnd","connection.reconnectStart"],ov,function(e){var t,n=e.connection,i=(e.newSource||e.source||n.source,e.newTarget||e.target||n.target,[]);(function(e,t,n){return!e.businessObject.cmmnElementRef})(n)&&(n.target&&i.push(n.target),!n.target&&e.target&&i.push(e.target),e.oldTarget&&i.push(e.oldTarget),(t=a(i))&&t.length&&o.updateSentriesSemanticParent(t))},!0),this.postExecuted("elements.move",ov,function(e){var t,n=e.shapes,i=e.newParent;(e.hints&&e.hints.oldParent)!==i&&(t=a(n))&&t.length&&o.updateSentriesSemanticParent(t)},!0),this.deleteSentry=function(e){var i=Xy(e);i&&n.getReferences(i).length<=1&&t.updateSemanticParent(i,null,"sentries")},this.updateSentriesSemanticParent=function(e){var r=function(e){return Vy(e,function(e){var t=Xy(e);return t&&t.id})}(e),o={};function a(e,t){o[e.id]=t}function c(e){return o[e.id]||e}s(e,function(e){var s=Xy(e);if(s){var p=cv(e.host);if(!p){var f=ev(Zy(e));p=f&&cv(f)}if(s.$parent===p)return;if(!o[s.id]&&function(e,t){var i=n.getReferences(e),o=r[e.id]||[];return n.getReferences(e).length>o.length&&(!t||qy(i,function(e){var i=n.getShape(e);return i&&t!==cv(i.host)}))}(s,p)){var h=i.replaceSentry(s);a(s,h),Uy(e.incoming,function(e){var t=e.businessObject.cmmnElementRef;t&&Ky(t,"cmmn:OnPart")&&a(t,d(t))})}s=c(s),Xy(e)!==s&&u(e,s),Uy(e.incoming,function(e){var n=e.businessObject.cmmnElementRef;if(n&&Ky(n,"cmmn:OnPart")){var i=c(n);i&&n!==i&&(l(e,i),t.updateSemanticParent(i,s,"onParts"))}}),t.updateSemanticParent(s,p,"sentries")}})}}av.$inject=["eventBus","modeling","itemRegistry","cmmnReplace","cmmnFactory"],u(av,Hy);var sv=av;function cv(e){if(Yy(e))return Zy(e);if(tv(e)){var t=Zy(e);return ev(t,"cmmn:PlanFragment")}}function uv(e){return Wy(Gy(e,function(e){var t=[];if(e.attachers)t=e.attachers;else{var n=Zy(e),i=n.get("exitCriteria");Uy(i,function(e){t.push(e)});var r=n.get("entryCriteria");Uy(r,function(e){t.push(e)})}return t||[]}))}function lv(e,t){var n=dv(t);return qy(e.outgoing,function(e){return t!==e&&n===dv(e)})}function dv(e){return(e=Zy(e)).cmmnElementRef}var pv=l.forEach,fv=ss.default;function hv(e,t){fv.call(this,e),this.preExecute("elements.delete",function(e){var n=e.context.elements;pv(n,function(e){t.unclaimId(e.businessObject.id,e.businessObject)})})}u(hv,fv),hv.$inject=["eventBus","modeling"];var mv={__init__:["attachCriterionBehavior","caseFileItemUpdater","labelBehavior","planItemDefinitionUpdater","planningTableUpdater","replaceConnectionBehavior","replaceElementBehavior","resizeCasePlanModelBehavior","sentryUpdater","unclaimIdBehavior"],attachCriterionBehavior:["type",zh],caseFileItemUpdater:["type",Qh],labelBehavior:["type",dm],planItemDefinitionUpdater:["type",Tm],planningTableUpdater:["type",Km],replaceConnectionBehavior:["type",oy],replaceElementBehavior:["type",by],resizeCasePlanModelBehavior:["type",$y],sentryUpdater:["type",sv],unclaimIdBehavior:["type",hv]},yv={};Object.defineProperty(yv,"__esModule",{value:!0}),yv.default=xv;var vv=_v(u),gv=_v(ss);function _v(e){return e&&e.__esModule?e:{default:e}}function xv(e){gv.default.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(e){var n=e.context,i=n.shape||n.connection,r=n.parent,o=t.getOrdering(i,r);o&&(void 0!==o.parent&&(n.parent=o.parent),n.parentIndex=o.index)}),this.preExecute(["shape.move","connection.move"],function(e){var n=e.context,i=n.shape||n.connection,r=n.newParent||i.parent,o=t.getOrdering(i,r);o&&(void 0!==o.parent&&(n.newParent=o.parent),n.newParentIndex=o.index)})}xv.prototype.getOrdering=function(e,t){return null},(0,vv.default)(xv,gv.default);var bv=yv.default,Ev=l.findIndex,wv=l.find,Mv=e.is,Sv=Q.isAny;function Cv(e){bv.call(this,e);var t=[{type:"label",order:{level:10}},{type:"cmmn:Criterion",order:{level:6}},{type:"cmmn:OnPart",order:{level:9,containers:["cmmn:Stage"]}},{type:"cmmn:Association",order:{level:9,containers:["cmmndi:CMMNDiagram"]}},{type:"cmmndi:CMMNEdge",order:{level:9,containers:["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:Stage"]}}];function n(e){var n=e.order;return n||(e.order=n=function(e){Pv(e)&&(e=e.businessObject.cmmnElementRef||e);var n=wv(t,function(t){return Mv(e,t.type)});return n&&n.order||{level:1}}(e)),n}this.getOrdering=function(e,t){var i=n(e);i.containers&&(t=function(e,t,n){var i=t;for(Pv(e)&&e.source&&(i=e.source.parent);i&&!Sv(i,n);)i=i.parent;if(!i)throw new Error("no parent for "+e.id+" in "+t.id);return i}(e,t,i.containers));var r=t.children.indexOf(e),o=Ev(t.children,function(t){return!(!e.labelTarget&&t.labelTarget)&&i.level<n(t).level});return-1!==o&&-1!==r&&r<o&&(o-=1),{index:o,parent:t}}}function Pv(e){return Mv(e,"cmmndi:CMMNEdge")}Cv.$inject=["eventBus"],u(Cv,bv);var Rv={__init__:["cmmnOrderingProvider"],cmmnOrderingProvider:["type",Cv]},Tv=e.is,kv=e.getDefinition,Av=e.isAutoComplete,Ov=me.isCollapsed,jv=me.isPlanningTableCollapsed,Nv=Pc.isPlanningTableCapable,Iv=Pc.isItemCapable;function Dv(e,t,n,i){function r(t,n){var i;return t&&(n=n||t.$type,i=e.createCriterion(n,{sentryRef:t.sentryRef,name:t.name})),i}function o(t,n){n=n||t.$type;var i=e.create(n,{name:t.name});if(Hv(i)&&t.defaultControl){var r=s(t.defaultControl,i);l(r,i),i.defaultControl=r}return $v(i)&&t.autoComplete&&(i.autoComplete=t.autoComplete),zv(t)&&zv(i)&&(i.isBlocking=t.isBlocking),i}function a(t,n,i){n=n||t.$type,i=i||kv(t);var r=e.create(n,{name:t.name,definitionRef:i});if(Hv(r)&&t.itemControl){var o=s(t.itemControl,r);l(o,r),r.itemControl=o}return r}function s(t,n){var r;if(t){r=e.create("cmmn:PlanItemControl");var o=t.repetitionRule;!o||n&&!i.canSetRepetitionRule(n)||(l(o=c(o),r),r.repetitionRule=o);var a=t.requiredRule;!a||n&&!i.canSetRequiredRule(n)||(l(a=c(a),r),r.requiredRule=a);var s=t.manualActivationRule;!s||n&&!i.canSetManualActivationRule(n)||(l(s=c(s),r),r.manualActivationRule=s)}return r}function c(t){var n;if(t){var i=t.$type,r=u(t.condition);l(r,n=e.create(i,{condition:r}))}return n}function u(t){var n;return t&&(n=e.create("cmmn:Expression",{language:t.language,body:t.body})),n}function l(e,t){e&&(e.$parent=t)}this.replaceElement=function(i,s,c){c=c||{};var u,l=s.type,d=i.businessObject,p={type:l};if(function(e){return Tv(e,"cmmn:Criterion")}(d)&&(u=r(d,l)),Iv(d)){var f=kv(d),h=s.definitionType,m=f;f.$type!==h&&(m=o(f,h)),u=a(d,l,m),Fv(f)&&Fv(m)&&!1!==s.isCollapsed&&(p.isCollapsed=Ov(d)),zv(f)&&!0===s.isCollapsed&&(p.isCollapsed=!0),zv(m)&&!1===s.isBlocking&&(p.isBlocking=!1),Nv(f)&&Nv(m)&&(p.isPlanningTableCollapsed=jv(d)),$v(f)&&$v(m)&&(p.autoComplete=Av(d)),Ov(d)||s.isCollapsed||zv(f)||(p.width=i.width,p.height=i.height)}return p.businessObject=u||e.create(l),p=t.replaceElement(i,p,c),!1!==c.select&&n.select(p),p},this.replaceCriterion=r,this.replaceSentry=function(t){var n;if(t&&(n=e.createSentry({name:t.name}),t.ifPart)){var i=e.create("cmmn:IfPart");l(i,n),n.ifPart=i;var r=u(t.ifPart.condition);l(r,i),i.condition=r}return n},this.replacePlanItemDefinition=o,this.replaceItemCapable=a,this.replacePlanItemControl=s,this.replaceRule=c,this.replaceCondition=u}Dv.$inject=["cmmnFactory","replace","selection","cmmnRules"];var Bv=Dv;function Lv(e,t){return e=kv(e),Tv(e,t)}function zv(e){return Lv(e,"cmmn:Task")}function Fv(e){return Lv(e,"cmmn:PlanFragment")}function $v(e){return Lv(e,"cmmn:Stage")}function Hv(e){return zv(e)||$v(e)||function(e){return Lv(e,"cmmn:Milestone")}(e)}var Uv={};Object.defineProperty(Uv,"__esModule",{value:!0}),Uv.default=Wv;function Wv(e,t,n){var i=(0,l.isDefined)(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}Wv.$inject=["config.popupMenu","eventBus","canvas"],Wv.prototype.registerProvider=function(e,t){this._providers[e]=t},Wv.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._providers[t],i=n.getEntries(e),r=n.getHeaderEntries&&n.getHeaderEntries(e),o=i.length>0,a=r&&r.length>0;return!o&&!a},Wv.prototype.open=function(e,t,n){var i=this._providers[t];if(!e)throw new Error("Element is missing");if(!i)throw new Error("Provider is not registered: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var r=this._current={provider:i,className:t,element:e,position:n};i.getHeaderEntries&&(r.headerEntries=i.getHeaderEntries(e)),r.entries=i.getEntries(e),r.container=this._createContainer();var o=r.headerEntries||[],a=r.entries||[];o.length&&r.container.appendChild(this._createEntries(r.headerEntries,"djs-popup-header")),a.length&&r.container.appendChild(this._createEntries(r.entries,"djs-popup-body"));var s=this._canvas.getContainer();this._attachContainer(r.container,s,n.cursor)},Wv.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindHandlers(),(0,at.remove)(this._current.container),this._current.container=null)},Wv.prototype.isOpen=function(){return!!this._current.container},Wv.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=(0,at.attr)(t,"data-id"),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)},Wv.prototype._getEntry=function(e){var t=(0,l.matchPattern)({id:e}),n=(0,l.find)(this._current.entries,t)||(0,l.find)(this._current.headerEntries,t);if(!n)throw new Error("entry not found");return n},Wv.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)},Wv.prototype._createContainer=function(){var e=(0,at.domify)('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return(0,l.assign)(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),(0,at.classes)(e).add(n),e},Wv.prototype._attachContainer=function(e,t,n){var i=this;at.delegate.bind(e,".entry","click",function(e){i.trigger(e)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n),this._bindHandlers()},Wv.prototype._updateScale=function(e){var t,n,i,r,o=this._canvas.zoom(),a=this._config.scale,s=o;!0!==a&&(!1===a?(t=1,n=1):(t=a.min,n=a.max),(0,l.isDefined)(t)&&o<t&&(s=t),(0,l.isDefined)(n)&&o>n&&(s=n)),r="scale("+s+")",(i=e).style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(e){i.style[e+"transform"]=r})},Wv.prototype._assureIsInbounds=function(e,t){var n,i,r=this._canvas._container.getBoundingClientRect(),o=e.offsetLeft,a=e.offsetTop,s=e.scrollWidth,c=e.scrollHeight,u={},d=t.x-r.left,p=t.y-r.top;o+s>r.width&&(u.x=!0),a+c>r.height&&(u.y=!0),u.x&&u.y?(n=d-s+"px",i=p-c+"px"):u.x?(n=d-s+"px",i=p+"px"):u.y&&p<c?(n=d+"px",i="10px"):u.y&&(n=d+"px",i=p-c+"px"),(0,l.assign)(e.style,{left:n,top:i},{visibility:"visible","z-index":1e3})},Wv.prototype._createEntries=function(e,t){var n=(0,at.domify)("<div>"),i=this;return(0,at.classes)(n).add(t),(0,l.forEach)(e,function(e){var t=i._createEntry(e,n);n.appendChild(t)}),n},Wv.prototype._createEntry=function(e){if(!e.id)throw new Error("every entry must have the id property set");var t=(0,at.domify)("<div>"),n=(0,at.classes)(t);if(n.add("entry"),e.className&&e.className.split(" ").forEach(function(e){n.add(e)}),(0,at.attr)(t,"data-id",e.id),e.label){var i=(0,at.domify)("<span>");i.textContent=e.label,t.appendChild(i)}return e.imageUrl&&t.appendChild((0,at.domify)('<img src="'+e.imageUrl+'" />')),!0===e.active&&n.add("active"),!0===e.disabled&&n.add("disabled"),e.title&&(t.title=e.title),t},Wv.prototype._bindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.once("contextPad.close",n),e.once("canvas.viewbox.changing",n),e.once("commandStack.changed",n)},Wv.prototype._unbindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.off("contextPad.close",n),e.off("canvas.viewbox.changed",n),e.off("commandStack.changed",n)};var Vv={};Object.defineProperty(Vv,"__esModule",{value:!0});var Gv=function(e){return e&&e.__esModule?e:{default:e}}(Uv);Vv.default={__init__:["popupMenu"],popupMenu:["type",Gv.default]};var qv={};Object.defineProperty(qv,"__esModule",{value:!0}),qv.default=Yv;var Kv=Math.round;function Yv(e){this._modeling=e}Yv.$inject=["modeling"],Yv.prototype.replaceElement=function(e,t,n){var i=this._modeling,r=null;return e.waypoints||(t.x=Kv(e.x+(t.width||e.width)/2),t.y=Kv(e.y+(t.height||e.height)/2),r=i.replaceShape(e,t,n)),r};var Xv={};Object.defineProperty(Xv,"__esModule",{value:!0});var Zv=function(e){return e&&e.__esModule?e:{default:e}}(qv);Xv.default={__init__:["replace"],replace:["type",Zv.default]};var Qv={__depends__:[Vv.default,Xv.default,ga.default],cmmnReplace:["type",Bv]},Jv={},eg=sc.getOrientation,tg=e.is,ng=e.getDefinition;function ig(e,t,n,i){return e.x-i<t.x&&e.y-i<t.y?"corner":e.x+i>t.x+t.width&&e.y-i<t.y?"corner":e.x-i<t.x&&e.y+i>t.y+t.height?"corner":e.x+i>t.x+t.width&&e.y+i>t.y+t.height?"corner":eg(e,t,n)}Jv.getCriterionAttachment=function(e,t){var n,i=ng(t);return"intersect"!==(n=tg(t,"cmmn:PlanItem")&&tg(i,"cmmn:Stage")?ig(e,t,-15,20):tg(i,"cmmn:Milestone")?ig(e,t,-3,7):eg(e,t,-15))?n:null};var rg=l.some,og=l.forEach,ag=l.assign,sg=l.filter,cg=e.is,ug=e.isCasePlanModel,lg=e.getDefinition,dg=e.getBusinessObject,pg=me.isCollapsed,fg=Q.isAny,hg=Q.isSame,mg=Q.isSameCase,yg=Q.getParent,vg=Q.getParents,gg=Pc.isDiscretionaryToHumanTask,_g=Pc.isHumanTask,xg=Pc.isDiscretionaryItem,bg=Jv.getCriterionAttachment,Eg=us.default;function wg(e){Eg.call(this,e)}u(wg,Eg),wg.$inject=["eventBus"];var Mg=wg;function Sg(e,t){return-1!==vg(t).indexOf(e)}function Cg(e){return Ig(e)||Ng(e)||cg(lg(e),"cmmn:Stage")}function Pg(e){return!e||Rg(e)}function Rg(e){return e.labelTarget}function Tg(e){return e.waypoints}function kg(e){return!e.businessObject.cmmnElementRef}function Ag(e){return rg(e.incoming,function(e){return cg(e.businessObject.cmmnElementRef,"cmmn:OnPart")})}function Og(e,t){var n=lg(e)||e;return!!cg(n,"cmmn:PlanFragment")&&!(!t&&cg(n,"cmmn:Stage"))}function jg(e){return cg(lg(e),"cmmn:EventListener")}function Ng(e){return cg(lg(e),"cmmn:Milestone")}function Ig(e){return cg(lg(e),"cmmn:Task")}function Dg(e){return!(!(e=lg(e))||!e.isBlocking)}function Bg(e){return cg(e,"cmmn:Criterion")}function Lg(e){return cg(e,"cmmn:EntryCriterion")}function zg(e){return cg(e,"cmmn:ExitCriterion")}function Fg(e){return cg(e,"cmmn:TextAnnotation")}function $g(e){return cg(e,"cmmn:CaseFileItem")}function Hg(e){return cg(e,"cmmn:PlanItem")}wg.prototype.init=function(){var e=this;this.addRule("connection.start",function(e){return function(e){if(Pg(e))return null;return fg(e,["cmmn:CaseFileItem","cmmn:Criterion","cmmn:DiscretionaryItem","cmmn:PlanItem"])}(e.source)}),this.addRule("connection.create",function(t){var n=t.source,i=t.target,r=!1,o=t.hints||{},a=o.targetParent;if(o.targetAttach)return!1;a&&(i.parent=a);try{(r=e.canConnect(n,i)||e.canReplaceConnectionEnd(n,i,"target"))||(r=e.canConnect(i,n)||e.canReplaceConnectionEnd(i,n,"source"))&&ag(r,{reverse:!0})}finally{a&&(i.parent=null)}return r}),this.addRule("connection.reconnectStart",function(t){var n=t.connection,i=t.hover,r=i||t.source,o=n.target,a=!1;return!(a=e.canConnect(r,o,n))&&i&&((a=e.canReplaceConnectionEnd(i,o,"source"))||(a=e.canConnect(o,i,n)||e.canReplaceConnectionEnd(o,i,"target"))&&ag(a,{reverse:!0})),a}),this.addRule("connection.reconnectEnd",function(t){var n=t.connection,i=n.source,r=t.hover,o=r||t.target,a=!1;return!(a=e.canConnect(i,o,n))&&r&&((a=e.canReplaceConnectionEnd(i,r,"target"))||(a=e.canConnect(r,i,n)||e.canReplaceConnectionEnd(r,i,"source"))&&ag(a,{reverse:!0})),a}),this.addRule("shape.attach",function(t){return e.canAttach(t.shape,t.target,null,t.position)}),this.addRule("shape.create",function(t){var n=t.target,i=t.shape,r=t.source,o=t.position,a=[i];return e.canCreate(i,n,r,o)||e.canReplace(a,n,o,r)}),this.addRule("shape.resize",function(t){var n=t.shape,i=t.newBounds;return e.canResize(n,i)}),this.addRule("elements.move",function(t){var n=t.target,i=t.shapes,r=t.position;return e.canAttach(i,n,null,r)||e.canMove(i,n,r)||e.canReplace(i,n,r)}),this.addRule("shape.replace",function(e){var t,n=e.element;if(Bg(n)){if(t=n.host,ug(t))return!1;if(Ig(t)&&!Dg(t))return!1;if(Ng(t)||jg(t))return!1}}),this.addRule(["elements.delete"],function(t){return e.canRemove(t.elements)})},wg.prototype.canRemove=function(e){return sg(e,function(e){return!Rg(e)})},wg.prototype.canMove=function(e,t){var n=this;return!t||e.every(function(i){return!(xg(i)&&!n.canMoveDiscretionaryItem(i,e,t))&&n.canDrop(i,t)})},wg.prototype.canMoveDiscretionaryItem=function(e,t,n){return!Og(n)||rg(e.incoming,function(e){var i=e.source;if(kg(e))return Sg(n,i)||-1!==t.indexOf(i)})},wg.prototype.canCreate=function(e,t,n,i){return!!t&&(Rg(t)?null:!hg(n,t)&&((!n||!Sg(n,t))&&(!(xg(e)&&!this.canCreateDiscretionaryItem(e,t,n))&&this.canDrop(e,t,i))))},wg.prototype.canCreateDiscretionaryItem=function(e,t,n){return!Og(t)||Sg(t,n)},wg.prototype.canDrop=function(e,t){return!(!Rg(e)||Tg(t))||(function(e){Tg(e)&&(e=e.businessObject.cmmnElementRef);return cg(e,"cmmn:Artifact")}(e)?cg(t,"cmmndi:CMMNDiagram")||Og(t,!0):!Bg(e)&&(ug(e)?cg(t,"cmmndi:CMMNDiagram"):!!Og(t,!0)&&!pg(t)))},wg.prototype.canResize=function(e,t){return Og(e,!0)?!pg(e)&&(!t||t.width>=100&&t.height>=80):!!Fg(e)},wg.prototype.canConnect=function(e,t,n){return Pg(e)||Pg(t)?null:!hg(e,t)&&(this.canConnectPlanItemOnPartConnection(e,t)?{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0}:this.canConnectCaseFileItemOnPartConnection(e,t)?{type:"cmmn:CaseFileItemOnPart",isStandardEventVisible:!0}:this.canConnectDiscretionaryConnection(e,t,n)?{type:"cmmndi:CMMNEdge"}:n&&cg(n.businessObject.cmmnElementRef,"cmmn:Association")&&this.canConnectAssociation(e,t)?{type:"cmmn:Association"}:!(!Fg(e)&&!Fg(t))&&{type:"cmmn:Association"})},wg.prototype.canConnectDiscretionaryConnection=function(e,t,n){if(!_g(lg(e)))return!1;if(!Dg(e))return!1;if(!xg(t))return!1;var i=lg(e),r=lg(t);if(hg(i,r))return!1;var o=yg(e),a=yg(t);if(!hg(o,a))return!1;if(gg(t)){if(!function(e,t,n){return!rg(t.incoming,function(i){return i!==n&&kg(i)&&i.source===e&&i.target===t})}(e,t,n))return!1;var s=yg(dg(t),"cmmn:HumanTask");if(!hg(lg(e),s)&&function(e,t){return rg(e.incoming,function(e){return e!==t&&kg(e)})}(t,n))return!1}return!0},wg.prototype.canConnectPlanItemOnPartConnection=function(e,t){return!!mg(e,t)&&(zg(e)&&(e=e.host),!hg(e,t.host)&&(!Sg(e,t.host)&&((!Lg(t)||!Sg(t.host,e))&&(Hg(e)&&Bg(t)))))},wg.prototype.canConnectCaseFileItemOnPartConnection=function(e,t){return!!(mg(e,t)&&$g(e)&&Bg(t))},wg.prototype.canConnectAssociation=function(e,t){return!Tg(e)&&!Tg(t)&&(!Sg(t,e)&&!Sg(e,t))},wg.prototype.canAttach=function(e,t,n,i){if(hg(n,t))return!1;if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var r=e[0];return!Rg(r)&&(!!Bg(r)&&(!t||!!this.canAttachCriterion(r,t,i,n)&&"attach"))},wg.prototype.canAttachEntryCriterion=function(e,t,n,i){return!!this.canAttachCriterion(e,t,n,i)&&((!i||!Sg(t,i))&&(!ug(t)&&(!Og(t,!0)||!rg(e.incoming,function(e){if(cg(e.businessObject.cmmnElementRef,"cmmn:PlanItemOnPart"))return Sg(t,e.source)}))))},wg.prototype.canAttachExitCriterion=function(e,t,n,i){return!!this.canAttachCriterion(e,t,n,i)&&(!Ng(t)&&!(Ig(t)&&!Dg(t)))},wg.prototype.canAttachCriterion=function(e,t,n,i){return(!i||!Sg(i,t))&&(!Bg(t)&&(!jg(t)&&(!Og(t)&&(!Fg(t)&&(!$g(t)&&!(n&&!bg(n,t)))))))},wg.prototype.canReplace=function(e,t,n,i){if(!t)return!1;if(hg(i,t))return!1;var r={replacements:[]},o=this;return og(e,function(a){if(Lg(a)&&!o.canAttachEntryCriterion(a,t,n,i)&&o.canAttachExitCriterion(a,t,n,i)&&r.replacements.push({oldElementId:a.id,newElementType:"cmmn:ExitCriterion"}),zg(a)&&!o.canAttachExitCriterion(a,t,n,i)&&o.canAttachEntryCriterion(a,t,n,i)&&r.replacements.push({oldElementId:a.id,newElementType:"cmmn:EntryCriterion"}),Og(t)&&xg(a)&&o.canDrop(a,t)&&!o.canMoveDiscretionaryItem(a,e,t)){var s={oldElementId:a.id,newElementType:"cmmn:PlanItem"};Og(a)&&ag(s,{newDefinitionType:"cmmn:Stage"}),r.replacements.push(s)}}),!!r.replacements.length&&r},wg.prototype.canReplaceConnectionEnd=function(e,t,n){return!(!e||!t)&&(!hg(e,t)&&(!!mg(e,t)&&("source"===n?this.canReplaceSource(e,t):this.canReplaceTarget(e,t))))},wg.prototype.canReplaceSource=function(e,t){return xg(e)&&Bg(t)?!hg(e,t.host)&&(!Og(e)&&(!Sg(e,t.host)&&((!Lg(t)||!Sg(t.host,e))&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:e.id,newElementType:"cmmn:PlanItem"}]}))):!(!Lg(e)||!Lg(t))&&(!hg(e.host,t.host)&&(!Sg(t.host,e.host)&&!Sg(e.host,t.host)&&(!Ag(e)&&(!!this.canAttachExitCriterion(e,e.host)&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:e.id,newElementType:"cmmn:ExitCriterion"}]}))))},wg.prototype.canReplaceTarget=function(e,t){return _g(lg(e))&&Hg(t)?!!Dg(e)&&(!jg(t)&&!Ng(t)&&(n=t,!hg(lg(e),lg(n))&&(!!function(e,t){return hg(yg(e),yg(t))}(e,t)&&{type:"cmmndi:CMMNEdge",replacements:[{oldElementId:t.id,newElementType:"cmmn:DiscretionaryItem"}]}))):!(!Hg(e)&&!zg(e)||!Lg(t))&&(!hg(e.host||e,t.host)&&(!!Sg(t.host,e.host||e)&&(!Ag(t)&&(!!this.canAttachExitCriterion(t,t.host)&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:t.id,newElementType:"cmmn:ExitCriterion"}]}))));var n},wg.prototype.canSetRepetitionRule=function(e){return Cg(e)},wg.prototype.canSetRequiredRule=function(e){return Cg(e)},wg.prototype.canSetManualActivationRule=function(e){return!Ng(e)&&Cg(e)};var Ug={__depends__:[Mu.default],__init__:["cmmnRules"],cmmnRules:["type",Mg]},Wg={};Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.default=Xg;var Vg=qg(u),Gg=qg(ss);function qg(e){return e&&e.__esModule?e:{default:e}}var Kg=251,Yg=1401;function Xg(e,t,n,i){Gg.default.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",Yg,function(e){var t,n,i=e.context,r=i.shapes,o=i.validatedShapes;i.shapes=(n=Zg(t=r),(0,l.unionBy)("id",t,n)),i.validatedShapes=function(e){var t=(0,l.groupBy)(e,"id");return(0,l.filter)(e,function(e){for(;e;){if(e.host&&t[e.host.id])return!1;e=e.parent}return!0})}(o)}),r&&t.on("shape.move.start",Kg,function(e){var t=e.context,n=Zg(t.shapes);(0,l.forEach)(n,function(e){r.makeDraggable(t,e,!0),(0,l.forEach)(e.labels,function(e){r.makeDraggable(t,e,!0)})})}),this.preExecuted("elements.move",Yg,function(e){var t=e.context,n=t.closure,i=Zg(t.shapes);(0,l.forEach)(i,function(e){n.add(e,n.topLevel[e.host.id])})}),this.postExecuted("elements.move",function(e){var t,n=e.context,r=n.shapes,o=n.newHost;r.length>1||(t=o?r:(0,l.filter)(r,function(e){return!!e.host}),(0,l.forEach)(t,function(e){i.updateAttachment(e,o)}))}),this.postExecuted("elements.move",function(e){var t=e.context.shapes;(0,l.forEach)(t,function(e){(0,l.forEach)(e.attachers,function(e){(0,l.forEach)(e.outgoing.slice(),function(e){n.allowed("connection.reconnectStart",{connection:e,source:e.source,target:e.target})||i.removeConnection(e)}),(0,l.forEach)(e.incoming.slice(),function(e){n.allowed("connection.reconnectEnd",{connection:e,source:e.source,target:e.target})||i.removeConnection(e)})})})}),this.postExecute("shape.create",function(e){var t=e.context,n=t.shape,r=t.host;r&&i.updateAttachment(n,r)}),this.postExecute("shape.replace",function(e){var t=e.context,r=t.oldShape,o=t.newShape;(0,yf.saveClear)(r.attachers,function(e){"attach"===n.allowed("elements.move",{target:o,shapes:[e]})?i.updateAttachment(e,o):i.removeShape(e)}),o.attachers.length&&(0,l.forEach)(o.attachers,function(e){var t=(0,Cf.getNewAttachShapeDelta)(e,r,o);i.moveShape(e,t,e.parent)})}),this.postExecute("shape.resize",function(e){var t=e.context,n=t.shape,r=t.oldBounds,o=t.newBounds,a=n.attachers;(0,l.forEach)(a,function(e){var t=(0,Cf.getNewAttachShapeDelta)(e,r,o);i.moveShape(e,t,e.parent),(0,l.forEach)(e.labels,function(e){i.moveShape(e,t,e.parent)})})}),this.preExecute("shape.delete",function(e){var t=e.context.shape;(0,yf.saveClear)(t.attachers,function(e){i.removeShape(e)}),t.host&&i.updateAttachment(t,null)}),t.on("spaceTool.move",function(e){var t=e.context,n=t.initialized,i=t.attachSupportInitialized;if(n&&!i){var r=t.movingShapes,o=(0,l.filter)(r,function(e){var t=e.host;return t&&-1===r.indexOf(t)});(0,l.forEach)(o,function(e){(0,Sn.remove)(r,e),(0,l.forEach)(e.labels,function(t){(0,Sn.remove)(r,e.label)})}),t.attachSupportInitialized=!0}})}function Zg(e){return(0,l.flatten)((0,l.map)(e,function(e){return e.attachers||[]}))}(0,Vg.default)(Xg,Gg.default),Xg.$inject=["injector","eventBus","rules","modeling"];var Qg={};Object.defineProperty(Qg,"__esModule",{value:!0});var Jg=t_(Mu),e_=t_(Wg);function t_(e){return e&&e.__esModule?e:{default:e}}Qg.default={__depends__:[Jg.default],__init__:["attachSupport"],attachSupport:["type",e_.default]};var n_={};Object.defineProperty(n_,"__esModule",{value:!0}),n_.default=c_;var i_=o_(u),r_=o_(ss);function o_(e){return e&&e.__esModule?e:{default:e}}var a_=250,s_=1400;function c_(e,t,n){r_.default.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",s_,function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=u_(n),t.validatedShapes=u_(i)}),i&&t.on("shape.move.start",a_,function(e){var t=e.context,n=t.shapes,r=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(n){n.hidden||-1!==t.shapes.indexOf(n)||r.push(n),e.labelTarget&&r.push(e)})}),(0,l.forEach)(r,function(e){i.makeDraggable(t,e,!0)})}),this.preExecuted("elements.move",s_,function(e){var t=e.context.closure,n=t.enclosedElements,i=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(e){n[e.id]||i.push(e)})}),t.addAll(i)}),this.preExecute(["connection.delete","shape.delete"],function(e){var t=e.context,i=t.connection||t.shape;(0,yf.saveClear)(i.labels,function(e){n.removeShape(e,{nested:!0})})}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=n.labelTarget;i&&(t.labelTargetIndex=(0,Sn.indexOf)(i.labels,n),t.labelTarget=i,n.labelTarget=null)}),this.revert("shape.delete",function(e){var t=e.context,n=t.shape,i=t.labelTarget,r=t.labelTargetIndex;i&&((0,Sn.add)(i.labels,n,r),n.labelTarget=i)})}function u_(e){return(0,l.filter)(e,function(t){return-1===e.indexOf(t.labelTarget)})}(0,i_.default)(c_,r_.default),c_.$inject=["injector","eventBus","modeling"];var l_={};Object.defineProperty(l_,"__esModule",{value:!0});var d_=function(e){return e&&e.__esModule?e:{default:e}}(n_);l_.default={__init__:["labelSupport"],labelSupport:["type",d_.default]};var p_={};function f_(e){return(0,l.assign)({original:e.point.original||e.point},e.actual)}function h_(e,t){this._elementRegistry=e,this._graphicsFactory=t}Object.defineProperty(p_,"__esModule",{value:!0}),p_.default=h_,h_.$inject=["elementRegistry","graphicsFactory"],h_.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),o=e.waypoints.slice(i.idx+1,r.idx);return o.unshift(f_(i)),o.push(f_(r)),o},h_.prototype.getDockingPoint=function(e,t,n){var i,r,o=e.waypoints;return{point:r=o[i=n?0:o.length-1],actual:this._getIntersection(t,e,n)||r,idx:i}},h_.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return(0,sc.getElementLineIntersection)(i,r,n)},h_.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},h_.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},h_.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var m_={__init__:["modeling","cmmnUpdater"],__depends__:[mv,Rv,Qv,Ug,Jl.default,ga.default,l_.default,Qg.default,id.default],cmmnFactory:["type",dd],cmmnUpdater:["type",Vd],elementFactory:["type",tp],modeling:["type",Nh],layouter:["type",Nd],connectionDocking:["type",p_.default]},y_=oa.default,v_=e.isCasePlanModel,g_=Ee.attr;function __(e,t,n){y_.call(this,e,t,n)}u(__,y_),__.$inject=["eventBus","styles","elementRegistry"],__.prototype.baseUpdateShapeOutline=y_.prototype.updateShapeOutline,__.prototype.updateShapeOutline=function(e,t){v_(t)?g_(e,{x:-this.offset,y:-this.offset-18,width:t.width+2*this.offset,height:t.height+18+2*this.offset}):this.baseUpdateShapeOutline(e,t)};var x_={__init__:["outline"],outline:["type",__]},b_=l.assign;function E_(e,t,n,i,r,o,a){this._create=e,this._elementFactory=t,this._globalConnect=n,this._handTool=i,this._palette=o,this._lassoTool=r,this._spaceTool=a,o.registerProvider(this)}var w_=E_;E_.$inject=["create","elementFactory","globalConnect","handTool","lassoTool","palette","spaceTool"],E_.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,r=this._spaceTool,o=this._lassoTool,a=this._globalConnect,s=this._handTool;function c(e,t,r,o){function a(t){n.start(t,i.createPlanItemShape(e))}var s=e.replace(/^cmmn:/,"");return{group:t,className:r,title:o||"Create "+s,action:{dragstart:a,click:a}}}function u(e){n.start(e,i.createCasePlanModelShape())}function l(e){n.start(e,i.createCriterionShape("cmmn:EntryCriterion"))}function d(e){n.start(e,i.createCaseFileItemShape())}return b_(t,{"hand-tool":{group:"tools",className:"cmmn-icon-hand-tool",title:"Activate the hand tool",action:{click:function(e){s.activateHand(e)}}},"lasso-tool":{group:"tools",className:"cmmn-icon-lasso-tool",title:"Activate the lasso tool",action:{click:function(e){o.activateSelection(e)}}},"space-tool":{group:"tools",className:"cmmn-icon-space-tool",title:"Activate the create/remove space tool",action:{click:function(e){r.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"cmmn-icon-connection",title:"Activate the global connect tool",action:{click:function(e){a.toggle(e)}}},"tool-separator":{group:"tools",separator:!0},"create.task":c("cmmn:Task","planItem","cmmn-icon-task"),"create.stage":c("cmmn:Stage","planItem","cmmn-icon-stage-expanded","Create expanded Stage"),"create.milestone":c("cmmn:Milestone","planItem","cmmn-icon-milestone"),"create.eventListener":c("cmmn:EventListener","planItem","cmmn-icon-event-listener"),"create.criterion":{group:"criterion",className:"cmmn-icon-entry-criterion",title:"Create Criterion",action:{dragstart:l,click:l}},"create.casePlanModel":{group:"casePlanModel",className:"cmmn-icon-case-plan-model",title:"Create CasePlanModel",action:{dragstart:u,click:u}},"create.caseFileItem":{group:"caseFileItem",className:"cmmn-icon-case-file-item",title:"Create Case File Item",action:{dragstart:d,click:d}}}),t};var M_={};Object.defineProperty(M_,"__esModule",{value:!0}),M_.default=P_;var S_="connect-ok",C_="connect-not-ok";function P_(e,t,n,i,r,o){var a=this;this._dragging=t,this._rules=o,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(e){var t=e.context,n=e.hover,r=t.canStartConnect=a.canStartConnect(n);null!==r&&(t.startTarget=n,i.addMarker(n,r?S_:C_))}),e.on(["global-connect.out","global-connect.cleanup"],function(e){var t=e.context.startTarget,n=e.context.canStartConnect;t&&i.removeMarker(t,n?S_:C_)}),e.on(["global-connect.ended"],function(t){var i=t.context.startTarget,r={x:t.x,y:t.y};if(a.canStartConnect(i))return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,i,r)}),!1})}P_.$inject=["eventBus","dragging","connect","canvas","toolManager","rules"],P_.prototype.start=function(e){this._dragging.init(e,"global-connect",{trapClick:!1,data:{context:{}}})},P_.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.start()},P_.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)},P_.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};var R_={};Object.defineProperty(R_,"__esModule",{value:!0}),R_.default=T_;function T_(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}T_.$inject=["eventBus","dragging"],T_.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},T_.prototype.isActive=function(e){return e&&this._active===e},T_.prototype.length=function(e){return this._tools.length},T_.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},T_.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(t){if(!t.context.reactivate&&this.isActive(e))return this.setActive(null),void i.cancel();this.setActive(e)},this),(0,l.forEach)(t,function(e){r.push(e+".ended"),r.push(e+".canceled")}),n.on(r,250,function(e){var t=e.originalEvent;this._active&&(t&&(0,at.closest)(t.target,'.group[data-group="tools"]')||this.setActive(null))},this)};var k_={};Object.defineProperty(k_,"__esModule",{value:!0});var A_=j_(vu),O_=j_(R_);function j_(e){return e&&e.__esModule?e:{default:e}}k_.default={__depends__:[A_.default],__init__:["toolManager"],toolManager:["type",O_.default]};var N_={};Object.defineProperty(N_,"__esModule",{value:!0});var I_=F_(Cu),D_=F_(Mu),B_=F_(vu),L_=F_(k_),z_=F_(M_);function F_(e){return e&&e.__esModule?e:{default:e}}N_.default={__depends__:[I_.default,D_.default,B_.default,L_.default],globalConnect:["type",z_.default]};var $_={};Object.defineProperty($_,"__esModule",{value:!0});var H_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};$_.default=W_;var U_=1500;function W_(e,t,n,i){this._dragging=n,i.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",U_,function(e){if((0,Zo.hasPrimaryModifier)(e))return this.activateMove(e.originalEvent),!1},this),e.on("hand.end",function(t){var n=t.originalEvent.target;if(!(t.hover||n instanceof SVGElement))return!1;e.once("hand.ended",function(){this.activateMove(t.originalEvent,{reactivate:!0})},this)},this),e.on("hand.move.move",function(e){var n=t.viewbox().scale;t.scroll({dx:e.dx*n,dy:e.dy*n})}),e.on("hand.move.end",function(t){var n=t.context.reactivate;return!(0,Zo.hasPrimaryModifier)(t)&&n&&e.once("hand.move.ended",function(e){this.activateHand(e.originalEvent,!0,!0)},this),!1},this)}W_.$inject=["eventBus","canvas","dragging","toolManager"],W_.prototype.activateMove=function(e,t,n){"object"===(void 0===t?"undefined":H_(t))&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:"grab",data:{context:n||{}}})},W_.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:"grab",data:{context:{reactivate:n}}})},W_.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateHand()},W_.prototype.isActive=function(){var e=this._dragging.context();return e&&/^hand/.test(e.prefix)};var V_={};Object.defineProperty(V_,"__esModule",{value:!0});var G_=K_(k_),q_=K_($_);function K_(e){return e&&e.__esModule?e:{default:e}}V_.default={__depends__:[G_.default],__init__:["handTool"],handTool:["type",q_.default]};var Y_={};Object.defineProperty(Y_,"__esModule",{value:!0}),Y_.default=X_;function X_(e,t,n,i,r,o){this._selection=r,this._dragging=n;var a=this,s=function(e){var n,i=t.getDefaultLayer();n=e.frame=(0,Ee.create)("rect"),(0,Ee.attr)(n,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),(0,Ee.append)(i,n)},c=function(e){var t=e.frame,n=e.bbox;(0,Ee.attr)(t,{x:n.x,y:n.y,width:n.width,height:n.height})},u=function(e){e.frame&&(0,Ee.remove)(e.frame)};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("lasso.selection.ended",function(){a.activateLasso(t.originalEvent,!0)})}),e.on("lasso.end",function(e){var t=Z_(e),n=i.filter(function(e){return e});a.select(n,t)}),e.on("lasso.start",function(e){var t=e.context;t.bbox=Z_(e),s(t)}),e.on("lasso.move",function(e){var t=e.context;t.bbox=Z_(e),c(t)}),e.on("lasso.cleanup",function(e){var t=e.context;u(t)}),e.on("element.mousedown",1500,function(e){if((0,Zo.hasSecondaryModifier)(e))return a.activateLasso(e.originalEvent),!0})}function Z_(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y};return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?{x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?{x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?{x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}X_.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager"],X_.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:"crosshair",data:{context:{}}})},X_.prototype.activateSelection=function(e){this._dragging.init(e,"lasso.selection",{trapClick:!1,cursor:"crosshair",data:{context:{}}})},X_.prototype.select=function(e,t){var n=(0,Sr.getEnclosedElements)(e,t);this._selection.select((0,l.values)(n))},X_.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},X_.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};var Q_={};Object.defineProperty(Q_,"__esModule",{value:!0});var J_=tx(k_),ex=tx(Y_);function tx(e){return e&&e.__esModule?e:{default:e}}Q_.default={__depends__:[J_.default],__init__:["lassoTool"],lassoTool:["type",ex.default]};var nx={};Object.defineProperty(nx,"__esModule",{value:!0}),nx.default=ix;function ix(e,t){this._eventBus=e,this._canvas=t,this._providers=[];var n=this;e.on("tool-manager.update",function(e){var t=e.tool;n.updateToolHighlight(t)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._providers.length&&(n._init(),n._update())})}ix.$inject=["eventBus","canvas"],ix.prototype.registerProvider=function(e){this._providers.push(e),this._diagramInitialized&&(this._container||this._init(),this._update())},ix.prototype.getEntries=function(){var e={};return(0,l.forEach)(this._providers,function(t){var n=t.getPaletteEntries();(0,l.forEach)(n,function(t,n){e[n]=t})}),e},ix.prototype._init=function(){var e=this._canvas,t=this._eventBus,n=e.getContainer(),i=this._container=(0,at.domify)(ix.HTML_MARKUP),r=this;n.appendChild(i),at.delegate.bind(i,".djs-palette-toggle, .entry","click",function(e){var t=e.delegateTarget;if((0,at.matches)(t,".djs-palette-toggle"))return r.toggle();r.trigger("click",e)}),at.event.bind(i,"mousedown",function(e){e.stopPropagation()}),at.delegate.bind(i,".entry","dragstart",function(e){r.trigger("dragstart",e)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})},ix.prototype._toggleState=function(e){e=e||{};var t,n=this._getParentContainer(),i=this._container,r=this._eventBus,o=(0,at.classes)(i);t="twoColumn"in e?e.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),o.toggle("two-column",t),"open"in e&&o.toggle("open",e.open),r.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},ix.prototype._update=function(){var e=(0,at.query)(".djs-palette-entries",this._container),t=this._entries=this.getEntries();(0,at.clear)(e),(0,l.forEach)(t,function(t,n){var i=t.group||"default",r=(0,at.query)("[data-group="+i+"]",e);r||(r=(0,at.domify)('<div class="group" data-group="'+i+'"></div>'),e.appendChild(r));var o,a,s,c=t.html||(t.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),u=(0,at.domify)(c);r.appendChild(u),t.separator||((0,at.attr)(u,"data-action",n),t.title&&(0,at.attr)(u,"title",t.title),t.className&&(o=u,a=t.className,s=(0,at.classes)(o),((0,l.isArray)(a)?a:a.split(/\s+/g)).forEach(function(e){s.add(e)})),t.imageUrl&&u.appendChild((0,at.domify)('<img src="'+t.imageUrl+'">')))}),this.open()},ix.prototype.trigger=function(e,t,n){var i,r,o,a=this._entries,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();(i=a[(0,at.attr)(s,"data-action")])&&(r=i.action,o=t.originalEvent||t,(0,l.isFunction)(r)?"click"===e&&r(o,n):r[e]&&r[e](o,n),t.preventDefault())},ix.prototype._layoutChanged=function(){this._toggleState({})},ix.prototype._needsCollapse=function(e,t){return e<46*Object.keys(t).length+50},ix.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},ix.prototype.open=function(){this._toggleState({open:!0})},ix.prototype.toggle=function(e){this.isOpen()?this.close():this.open()},ix.prototype.isActiveTool=function(e){return e&&this._activeTool===e},ix.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=(0,at.query)(".djs-palette-entries",this._container),this._toolsContainer=(0,at.query)("[data-group=tools]",t)),n=this._toolsContainer,(0,l.forEach)(n.children,function(t){var n=t.getAttribute("data-action");if(n){var i=(0,at.classes)(t);n=n.replace("-tool",""),i.contains("entry")&&n===e?i.add("highlighted-entry"):i.remove("highlighted-entry")}})},ix.prototype.isOpen=function(){return(0,at.classes)(this._container).has("open")},ix.prototype._getParentContainer=function(){return this._canvas.getContainer()},ix.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';var rx={};Object.defineProperty(rx,"__esModule",{value:!0});var ox=function(e){return e&&e.__esModule?e:{default:e}}(nx);rx.default={__init__:["palette"],palette:["type",ox.default]};var ax={};function sx(e,t,n){this._elementRegistry=e,this._canvas=t,this._styles=n}Object.defineProperty(ax,"__esModule",{value:!0}),ax.default=sx,sx.$inject=["elementRegistry","canvas","styles"],sx.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},sx.prototype.addDragger=function(e,t){var n=this.getGfx(e),i=(0,Ee.clone)(n),r=n.getBoundingClientRect();return e.waypoints&&function e(t){t.children&&(0,l.forEach)(t.children,function(t){e(t)});t.style.markerStart="";t.style.markerEnd=""}(i),(0,Ee.attr)(i,this._styles.cls("djs-dragger",[],{x:r.top,y:r.left})),(0,Ee.append)(t,i),i},sx.prototype.addFrame=function(e,t){var n=(0,Ee.create)("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return(0,Ee.append)(t,n),n};var cx={};Object.defineProperty(cx,"__esModule",{value:!0});var ux=function(e){return e&&e.__esModule?e:{default:e}}(ax);cx.default={__init__:["previewSupport"],previewSupport:["type",ux.default]};var lx={};Object.defineProperty(lx,"__esModule",{value:!0}),lx.default=yx;var dx=Math.abs,px=Math.round,fx=1500,hx={x:"width",y:"height"},mx={x:"y",y:"x"};function yx(e,t,n,i,r,o){this._canvas=n,this._dragging=t,this._modeling=i,this._rules=r,this._toolManager=o;var a=this;o.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),e.on("spaceTool.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("spaceTool.selection.ended",function(){a.activateMakeSpace(t.originalEvent)})}),e.on("spaceTool.move",fx,function(e){var t=e.context;t.initialized||(t.initialized=a.initializeMakeSpace(e,t))}),e.on("spaceTool.end",function(t){var n=t.context,i=n.axis,r=n.direction,o=n.movingShapes,s=n.resizingShapes;if(n.initialized){var c={x:px(t.dx),y:px(t.dy)};c[mx[i]]=0;var u=!0;(0,l.forEach)(s,function(e){("w"===r&&t.x>e.x+e.width||"e"===r&&t.x<e.x||"n"===r&&t.y>e.y+e.height||"s"===r&&t.y<e.y)&&(u=!1)}),u&&a.makeSpace(o,s,c,r),e.once("spaceTool.ended",function(e){a.activateSelection(e.originalEvent,!0,!0)})}})}yx.$inject=["eventBus","dragging","canvas","modeling","rules","toolManager"],yx.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{trapClick:!1,cursor:"crosshair",autoActivate:t,data:{context:{reactivate:n}}})},yx.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:"crosshair",data:{context:{}}})},yx.prototype.makeSpace=function(e,t,n,i){return this._modeling.createSpace(e,t,n,i)},yx.prototype.initializeMakeSpace=function(e,t){var n=dx(e.dx)>dx(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(dx(i)<5)return!1;i<0&&(i*=-1),(0,Zo.hasPrimaryModifier)(e)&&(i*=-1);var o=this._canvas.getRootElement(),a=(0,Sr.selfAndAllChildren)(o,!0),s=this.calculateAdjustments(a,n,i,r);return(0,l.assign)(t,s,{axis:n,direction:(0,Kf.getDirection)(n,i)}),(0,$a.set)("resize-"+("x"===n?"ew":"ns")),!0},yx.prototype.calculateAdjustments=function(e,t,n,i){var r=[],o=[],a=this._rules;return e.forEach(function(e){var s=e[t],c=s+e[hx[t]];if(e.parent&&!e.waypoints)return n>0&&s>i?r.push(e):n<0&&c<i?r.push(e):s<i&&c>i&&a.allowed("shape.resize",{shape:e})?o.push(e):void 0}),{movingShapes:r,resizingShapes:o}},yx.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},yx.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};var vx={};Object.defineProperty(vx,"__esModule",{value:!0}),vx.default=bx;var gx="djs-dragging",_x="djs-resizing",xx=250;function bx(e,t,n,i,r){function o(e,t){(0,l.forEach)(e,function(e){r.addDragger(e,t),n.addMarker(e,gx)})}e.on("spaceTool.selection.start",function(e){var t=n.getLayer("space"),r=e.context,o="M 0,-10000 L 0,10000",a="M -10000,0 L 10000,0",s=(0,Ee.create)("g");(0,Ee.attr)(s,i.cls("djs-crosshair-group",["no-events"])),(0,Ee.append)(t,s);var c=(0,Ee.create)("path");(0,Ee.attr)(c,"d",o),(0,Ee.classes)(c).add("djs-crosshair"),(0,Ee.append)(s,c);var u=(0,Ee.create)("path");(0,Ee.attr)(u,"d",a),(0,Ee.classes)(u).add("djs-crosshair"),(0,Ee.append)(s,u),r.crosshairGroup=s}),e.on("spaceTool.selection.move",function(e){var t=e.context.crosshairGroup;(0,Ze.translate)(t,e.x,e.y)}),e.on("spaceTool.selection.cleanup",function(e){var t=e.context.crosshairGroup;t&&(0,Ee.remove)(t)}),e.on("spaceTool.move",xx,function(e){var a=e.context,s=a.line,c=a.axis,u=a.movingShapes,d=a.resizingShapes;if(a.initialized){if(!a.dragGroup){var p=n.getLayer("space");s=(0,Ee.create)("path"),(0,Ee.attr)(s,"d","M0,0 L0,0"),(0,Ee.classes)(s).add("djs-crosshair"),(0,Ee.append)(p,s),a.line=s;var f=(0,Ee.create)("g");(0,Ee.attr)(f,i.cls("djs-drag-group",["no-events"])),(0,Ee.append)(n.getDefaultLayer(),f),o(u,f),o(a.movingConnections=t.filter(function(e){var t=!1;(0,l.forEach)(u,function(n){(0,l.forEach)(n.outgoing,function(n){e===n&&(t=!0)})});var n=!1;(0,l.forEach)(u,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(n=!0)})});var i=!1;(0,l.forEach)(d,function(t){(0,l.forEach)(t.outgoing,function(t){e===t&&(i=!0)})});var r=!1;return(0,l.forEach)(d,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(r=!0)})}),function(e){return e.waypoints}(e)&&(t||i)&&(n||r)}),f),a.dragGroup=f}if(!a.frameGroup){var h=(0,Ee.create)("g");(0,Ee.attr)(h,i.cls("djs-frame-group",["no-events"])),(0,Ee.append)(n.getDefaultLayer(),h);var m=[];(0,l.forEach)(d,function(e){var t=r.addFrame(e,h);m.push({element:t,initialWidth:t.getBBox().width,initialHeight:t.getBBox().height}),n.addMarker(e,_x)}),a.frameGroup=h,a.frames=m}var y={x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y};(0,Ee.attr)(s,{path:y[c],display:""});var v={x:e.dx,y:e.dy};v[{x:"y",y:"x"}[a.axis]]=0,(0,Ze.translate)(a.dragGroup,v.x,v.y),(0,l.forEach)(a.frames,function(e){e.initialWidth+v.x>5&&(0,Ee.attr)(e.element,{width:e.initialWidth+v.x}),e.initialHeight+v.y>5&&(0,Ee.attr)(e.element,{height:e.initialHeight+v.y})})}}),e.on("spaceTool.cleanup",function(e){var t=e.context,i=t.movingShapes,r=t.movingConnections,o=t.resizingShapes,a=t.line,s=t.dragGroup,c=t.frameGroup;(0,l.forEach)(i,function(e){n.removeMarker(e,gx)}),(0,l.forEach)(r,function(e){n.removeMarker(e,gx)}),s&&((0,Ee.remove)(a),(0,Ee.remove)(s)),(0,l.forEach)(o,function(e){n.removeMarker(e,_x)}),c&&(0,Ee.remove)(c)})}bx.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];var Ex={};Object.defineProperty(Ex,"__esModule",{value:!0});var wx=Tx(vu),Mx=Tx(Mu),Sx=Tx(k_),Cx=Tx(cx),Px=Tx(lx),Rx=Tx(vx);function Tx(e){return e&&e.__esModule?e:{default:e}}Ex.default={__init__:["spaceToolPreview"],__depends__:[wx.default,Mx.default,Sx.default,Cx.default],spaceTool:["type",Px.default],spaceToolPreview:["type",Rx.default]};var kx={__depends__:[rx.default,Gu.default,Ex.default,Q_.default,V_.default,N_.default],__init__:["paletteProvider"],paletteProvider:["type",w_]},Ax={};(function(e){"use strict";var t,n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=void 0!==e?e:void 0,n=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,n=String(e),i=n.length,r=-1,o="",a=n.charCodeAt(0);++r<i;)0!=(t=n.charCodeAt(r))?o+=t>=1&&t<=31||127==t||0==r&&t>=48&&t<=57||1==r&&t>=48&&t<=57&&45==a?"\\"+t.toString(16)+" ":(0!=r||1!=i||45!=t)&&(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?n.charAt(r):"\\"+n.charAt(r):o+="�";return o};return e.CSS||(e.CSS={}),e.CSS.escape=t,t},"object"==(void 0===Ax?"undefined":i(Ax))?Ax=n(t):n(t)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Ox=ss.default,jx=l.assign,Nx=l.forEach,Ix=Yr.getVisual,Dx=Pc.isItemCapable,Bx=e.getBusinessObject,Lx=e.getDefinition,zx=at.query,Fx=Ee.append,$x=Ee.classes,Hx=Ee.create,Ux=Ee.remove,Wx=250;function Vx(e,t,n,i,r,o){function a(e){return e.visualReplacements||(e.visualReplacements={}),e.visualReplacements}function s(e){var n=e.context,i=n.canExecute||n.allowed;if("attach"===i){var r=n.position||{x:e.x,y:e.y},o=n.shapes||[n.shape],a=n.target;i=t.canReplace(o,a,r,n.source)}return i}function c(e,t){var n=e&&Ix(e);n&&(Ux(n),n=Hx("g"),$x(n).add("djs-visual"),Fx(e,n),o.drawShape(n,t))}function u(t,r,o){Nx(r,function(r){var a=r.oldElementId,s=i.get(a)||t.shape;if(!t.visualReplacements[a]){var u=function(t,i){var r={type:i.newElementType,x:t.x,y:t.y,width:t.width,height:t.height};if(Dx(t)){var o,a=Bx(t),s=Lx(t),c=i.newElementType,u=i.newDefinitionType;u&&(s=e.replacePlanItemDefinition(s,u)),o=e.replaceItemCapable(a,c,s),jx(r,{businessObject:o})}return n.createShape(r)}(s,r);c(o(s),u),t.visualReplacements[a]=s}})}function l(e,t){var n=e.visualReplacements;Nx(n,function(e,i){c(t(e),e),delete n[i]})}Ox.call(this,r),r.on(["shape.move.move","create.move"],Wx,function(e){var t=e.context,n=t.dragGroup,i=t.visual,r=s(e),o=r&&r.replacements;a(t);var c=function(e){var t,r;return n?(t='[data-element-id="'+Ax(e.id)+'"]',r=n):i&&(t=".djs-dragger",r=i),r&&zx(t,r)};o&&o.length?u(t,o,c):l(t,c)}),r.on(["bendpoint.move.move","connect.move"],Wx,function(e){var t=e.context,n=s(e),r=n&&n.replacements;a(t),r&&r.length&&u(t,r,function(e){return i.getGraphics(e)})}),r.on(["bendpoint.move.cancel","bendpoint.move.cleanup","bendpoint.move.end","bendpoint.move.out","connect.cleanup","connect.end","connect.out"],Wx,function(e){l(e.context,function(e){return i.getGraphics(e)})})}Vx.$inject=["cmmnReplace","cmmnRules","elementFactory","elementRegistry","eventBus","graphicsFactory"],u(Vx,Ox);var Gx=Vx,qx={};Object.defineProperty(qx,"__esModule",{value:!0}),qx.default=Qx;var Kx=500,Yx=1250,Xx=1500,Zx=Math.round;function Qx(e,t,n,i,r){function o(e,t,n,i){return r.allowed("elements.move",{shapes:e,delta:t,position:n,target:i})}function a(e,n,i){if(!n.waypoints&&n.parent){var r=function(e){return{x:e.x+Zx(e.width/2),y:e.y+Zx(e.height/2)}}(n);return t.init(e,r,"shape.move",{cursor:"grabbing",autoActivate:i,data:{shape:n,context:{}}}),!0}}e.on("shape.move.start",Xx,function(e){var t,n,r=e.context,o=e.shape,a=i.get().slice();-1===a.indexOf(o)&&(a=[o]),t=a,n=(0,l.groupBy)(t,"id"),a=(0,l.filter)(t,function(e){for(;e=e.parent;)if(n[e.id])return!1;return!0}),(0,l.assign)(r,{shapes:a,validatedShapes:a,shape:o})}),e.on("shape.move.start",Yx,function(e){var t=e.context,n=t.validatedShapes;if(!(t.canExecute=o(n)))return!1}),e.on("shape.move.move",Kx,function(e){var t,n=e.context,i=n.validatedShapes,r=e.hover,a={x:e.dx,y:e.dy};t=o(i,a,{x:e.x,y:e.y},r),n.delta=a,n.canExecute=t,n.target=null!==t?r:null}),e.on("shape.move.end",function(e){var t=e.context,i=t.delta,r=t.canExecute,o="attach"===r,a=t.shapes;if(!r)return!1;i.x=Zx(i.x),i.y=Zx(i.y),n.moveElements(a,i,t.target,{primaryShape:t.shape,attach:o})}),e.on("element.mousedown",function(e){var t=(0,qo.getOriginal)(e);if(!t)throw new Error("must supply DOM mousedown event");return a(t,e.element)}),this.start=a}Qx.$inject=["eventBus","dragging","modeling","selection","rules"];var Jx={};Object.defineProperty(Jx,"__esModule",{value:!0}),Jx.default=ab;var eb=499,tb="djs-dragging",nb="drop-ok",ib="drop-not-ok",rb="new-parent",ob="attach-ok";function ab(e,t,n,i,r){function o(e){return function(e){return(0,l.filter)(e,function(t){return!function(e){return e.waypoints}(t)||(0,l.find)(e,(0,l.matchPattern)({id:t.source.id}))&&(0,l.find)(e,(0,l.matchPattern)({id:t.target.id}))})}(a(e))}function a(e){var t=(0,Sr.selfAndAllChildren)(e,!0),n=(0,l.map)(t,function(e){return(e.incoming||[]).concat(e.outgoing||[])});return(0,l.flatten)(t.concat(n))}function s(e,t){[ob,nb,ib,rb].forEach(function(i){i===t?n.addMarker(e,i):n.removeMarker(e,i)})}e.on("shape.move.start",eb,function(e){var t,s=e.context,c=s.shapes,u=s.allDraggedElements,d=o(c);if(!s.dragGroup){var p=(0,Ee.create)("g");(0,Ee.attr)(p,i.cls("djs-drag-group",["no-events"]));var f=n.getDefaultLayer();(0,Ee.append)(f,p),s.dragGroup=p}d.forEach(function(e){r.addDragger(e,s.dragGroup)}),u=u?(0,l.flatten)([u,a(c)]):a(c),(0,l.forEach)(u,function(e){n.addMarker(e,tb)}),s.allDraggedElements=u,s.differentParents=(t=c,1!==(0,l.size)((0,l.groupBy)(t,function(e){return e.parent&&e.parent.id})))}),e.on("shape.move.move",eb,function(e){var t=e.context,n=t.dragGroup,i=t.target,r=t.shape.parent,o=t.canExecute;i&&("attach"===o?s(i,ob):t.canExecute&&i&&i.id!==r.id?s(i,rb):s(i,t.canExecute?nb:ib)),(0,Ze.translate)(n,e.dx,e.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(e){var t=e.context.target;t&&s(t,null)}),e.on("shape.move.cleanup",function(e){var t=e.context,i=t.allDraggedElements,r=t.dragGroup;(0,l.forEach)(i,function(e){n.removeMarker(e,tb)}),r&&(0,Ee.clear)(r)}),this.makeDraggable=function(e,t,i){r.addDragger(t,e.dragGroup),i&&n.addMarker(t,tb),e.allDraggedElements?e.allDraggedElements.push(t):e.allDraggedElements=[t]}}ab.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];var sb={};Object.defineProperty(sb,"__esModule",{value:!0});var cb=yb(ia),ub=yb(ga),lb=yb(ca),db=yb(Mu),pb=yb(vu),fb=yb(cx),hb=yb(qx),mb=yb(Jx);function yb(e){return e&&e.__esModule?e:{default:e}}sb.default={__depends__:[cb.default,ub.default,lb.default,db.default,pb.default,fb.default],__init__:["move","movePreview"],move:["type",hb.default],movePreview:["type",mb.default]};var vb={__depends__:[sb.default],__init__:["cmmnReplacePreview"],cmmnReplacePreview:["type",Gx]},gb=l.map,_b=l.filter,xb=l.sortBy;function bb(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}var Eb=bb;function wb(e){return _b(e,function(e){return!!e.matched}).length>0}function Mb(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(0!==r&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}bb.$inject=["elementRegistry","searchPad","canvas"],bb.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(e){return!e.labelTarget});return n=_b(n,function(e){return e!==t}),n=gb(n,function(t){return{primaryTokens:Mb(El.getLabel(t),e),secondaryTokens:Mb(t.id,e),element:t}}),n=_b(n,function(e){return wb(e.primaryTokens)||wb(e.secondaryTokens)}),n=xb(n,function(e){return El.getLabel(e.element)+e.element.id})};var Sb={};Object.defineProperty(Sb,"__esModule",{value:!0}),Object.defineProperty(Sb,"escapeCSS",{enumerable:!0,get:function(){return(e=Ax,e&&e.__esModule?e:{default:e}).default;var e}}),Sb.escapeHTML=function(e){return e.replace(/[<>]/g,function(e){return Cb[e]})};var Cb={"<":"&lt",">":"&gt"};var Pb={};function Rb(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=(0,at.domify)(Rb.BOX_HTML),this._searchInput=(0,at.query)(Rb.INPUT_SELECTOR,this._container),this._resultsContainer=(0,at.query)(Rb.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}function Tb(e,t,n){var i=function(e){var t="";return e.forEach(function(e){e.matched?t+='<strong class="'+Rb.RESULT_HIGHLIGHT_CLASS+'">'+(0,Sb.escapeHTML)(e.matched)+"</strong>":t+=(0,Sb.escapeHTML)(e.normal)}),""!==t?t:null}(t),r=(0,at.domify)(n);r.innerHTML=i,e.appendChild(r)}Object.defineProperty(Pb,"__esModule",{value:!0}),Pb.default=Rb,Rb.$inject=["canvas","eventBus","overlays","selection"],Rb.prototype._bindEvents=function(){var e=this;function t(t,n,i,r){e._eventMaps.push({el:t,type:i,listener:at.delegate.bind(t,n,i,r)})}t(document,"html","click",function(t){e.close()}),t(this._container,Rb.INPUT_SELECTOR,"click",function(e){e.stopPropagation(),e.delegateTarget.focus()}),t(this._container,Rb.RESULT_SELECTOR,"mouseover",function(t){t.stopPropagation(),e._scrollToNode(t.delegateTarget),e._preselect(t.delegateTarget)}),t(this._container,Rb.RESULT_SELECTOR,"click",function(t){t.stopPropagation(),e._select(t.delegateTarget)}),t(this._container,Rb.INPUT_SELECTOR,"keydown",function(e){38===e.keyCode&&e.preventDefault(),40===e.keyCode&&e.preventDefault()}),t(this._container,Rb.INPUT_SELECTOR,"keyup",function(t){if(27===t.keyCode)return e.close();if(13===t.keyCode){var n=e._getCurrentResult();return n?e._select(n):e.close()}return 38===t.keyCode?e._scrollToDirection(!0):40===t.keyCode?e._scrollToDirection():void(37!==t.keyCode&&39!==t.keyCode&&e._search(t.delegateTarget.value))})},Rb.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){at.delegate.unbind(e.el,e.type,e.listener)})},Rb.prototype._search=function(e){var t=this;if(this._clearResults(),e&&""!==e){var n=this._searchProvider.find(e);if(n.length){n.forEach(function(e){var n=e.element.id,i=t._createResultNode(e,n);t._results[n]={element:e.element,node:i}});var i=(0,at.query)(Rb.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}},Rb.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}},Rb.prototype._scrollToNode=function(e){if(e&&e!==this._getCurrentResult()){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}},Rb.prototype._clearResults=function(){(0,at.clear)(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")},Rb.prototype._getCurrentResult=function(){return(0,at.query)(Rb.RESULT_SELECTED_SELECTOR,this._resultsContainer)},Rb.prototype._createResultNode=function(e,t){var n=(0,at.domify)(Rb.RESULT_HTML);return e.primaryTokens.length>0&&Tb(n,e.primaryTokens,Rb.RESULT_PRIMARY_HTML),Tb(n,e.secondaryTokens,Rb.RESULT_SECONDARY_HTML),(0,at.attr)(n,Rb.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n},Rb.prototype.registerProvider=function(e){this._searchProvider=e},Rb.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,(0,at.classes)(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},Rb.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,(0,at.classes)(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))},Rb.prototype.toggle=function(){this.isOpen()?this.close():this.open()},Rb.prototype.isOpen=function(){return this._open},Rb.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&(0,at.classes)(t).remove(Rb.RESULT_SELECTED_CLASS);var n=(0,at.attr)(e,Rb.RESULT_ID_ATTRIBUTE),i=this._results[n].element;(0,at.classes)(e).add(Rb.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._centerViewbox(i),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}},Rb.prototype._select=function(e){var t=(0,at.attr)(e,Rb.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._centerViewbox(n),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)},Rb.prototype._centerViewbox=function(e){var t=this._canvas.viewbox(),n=(0,Sr.getBBox)(e),i={x:n.x+n.width/2-t.outer.width/2,y:n.y+n.height/2-t.outer.height/2,width:t.outer.width,height:t.outer.height};this._canvas.viewbox(i),this._canvas.zoom(t.scale)},Rb.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=function(e){var t=e.width+12,n=e.height+12,i=["width: "+t+"px","height: "+n+"px"].join("; ");return{position:{bottom:n-6,right:t-6},show:!0,html:'<div style="'+i+'" class="'+Rb.OVERLAY_CLASS+'"></div>'}}((0,Sr.getBBox)(e));this._overlayId=this._overlays.add(e,t)}},Rb.CONTAINER_SELECTOR=".djs-search-container",Rb.INPUT_SELECTOR=".djs-search-input input",Rb.RESULTS_CONTAINER_SELECTOR=".djs-search-results",Rb.RESULT_SELECTOR=".djs-search-result",Rb.RESULT_SELECTED_CLASS="djs-search-result-selected",Rb.RESULT_SELECTED_SELECTOR="."+Rb.RESULT_SELECTED_CLASS,Rb.RESULT_ID_ATTRIBUTE="data-result-id",Rb.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",Rb.OVERLAY_CLASS="djs-search-overlay",Rb.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>',Rb.RESULT_HTML='<div class="djs-search-result"></div>',Rb.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',Rb.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';var kb={};Object.defineProperty(kb,"__esModule",{value:!0});var Ab=Nb(Vo),Ob=Nb(ga),jb=Nb(Pb);function Nb(e){return e&&e.__esModule?e:{default:e}}kb.default={__depends__:[Ab.default,Ob.default],searchPad:["type",jb.default]};var Ib={__depends__:[kb.default],__init__:["cmmnSearch"],cmmnSearch:["type",Eb]},Db={};Object.defineProperty(Db,"__esModule",{value:!0}),Db.snapTo=function(e,t,n){var i,r;for(n=void 0===n?10:n,i=0;i<t.length;i++)if(r=t[i],Bb(r-e)<=n)return r},Db.mid=function(e,t){if(!e||isNaN(e.x)||isNaN(e.y))return t;return{x:Lb(e.x+e.width/2),y:Lb(e.y+e.height/2)}},Db.isSnapped=function(e,t){var n=e.snapped;if(!n)return!1;if("string"==typeof t)return n[t];return n.x&&n.y},Db.setSnapped=function(e,t,n){if("string"!=typeof t)throw new Error("axis must be in [x, y]");if("number"!=typeof n&&!1!==n)throw new Error("value must be Number or false");var i,r=e[t],o=e.snapped=e.snapped||{};!1===n?o[t]=!1:(o[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i);return r};var Bb=Math.abs,Lb=Math.round;var zb={};function Fb(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function $b(e){this._snapValues={}}Object.defineProperty(zb,"__esModule",{value:!0}),zb.default=Fb,Fb.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]},Fb.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,-1===this._snapLocations.indexOf(e)&&this._snapLocations.push(e)},Fb.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)},Fb.prototype.getSnapLocations=function(){return this._snapLocations},Fb.prototype.setSnapLocations=function(e){this._snapLocations=e},Fb.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new $b).initDefaults(this._defaultSnaps),n},$b.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),-1===n.x.indexOf(t.x)&&n.x.push(t.x),-1===n.y.indexOf(t.y)&&n.y.push(t.y)},$b.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&(0,Db.snapTo)(e[n],r[n],i)},$b.prototype.initDefaults=function(e){var t=this;(0,l.forEach)(e||{},function(e,n){(0,l.forEach)(e,function(e){t.add(n,e)})})};var Hb={};Object.defineProperty(Hb,"__esModule",{value:!0});var Ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Hb.default=Gb;var Wb=function(e){return e&&e.__esModule?e:{default:e}}(zb);var Vb=1250;function Gb(e,t){this._canvas=t;var n=this;e.on(["shape.move.start","create.start"],function(e){n.initSnap(e)}),e.on(["shape.move.move","shape.move.end","create.move","create.end"],Vb,function(e){e.originalEvent&&e.originalEvent.ctrlKey||(0,Db.isSnapped)(e)||n.snap(e)}),e.on(["shape.move.cleanup","create.cleanup"],function(e){n.hide()}),this._asyncHide=(0,l.debounce)((0,l.bind)(this.hide,this),1e3)}Gb.$inject=["eventBus","canvas"],Gb.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.snapContext;i||(i=t.snapContext=new Wb.default);var r=(0,Db.mid)(n,e);return i.setSnapOrigin("mid",{x:r.x-e.x,y:r.y-e.y}),i},Gb.prototype.snap=function(e){var t=e.context,n=t.snapContext,i=t.shape,r=t.target,o=n.getSnapLocations();if(r){var a=n.pointsForTarget(r);a.initialized||(this.addTargetSnaps(a,i,r),a.initialized=!0);var s={x:(0,Db.isSnapped)(e,"x"),y:(0,Db.isSnapped)(e,"y")};(0,l.forEach)(o,function(t){var i=n.getSnapOrigin(t),r={x:e.x+i.x,y:e.y+i.y};if((0,l.forEach)(["x","y"],function(e){var n;s[e]||void 0!==(n=a.snap(r,t,e,7))&&(s[e]={value:n,originValue:n-i[e]})}),s.x&&s.y)return!1}),this.showSnapLine("vertical",s.x&&s.x.value),this.showSnapLine("horizontal",s.y&&s.y.value),(0,l.forEach)(["x","y"],function(t){var n=s[t];"object"===(void 0===n?"undefined":Ub(n))&&(0,Db.setSnapped)(e,t,n.originValue)})}},Gb.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=(0,Ee.create)("path");return(0,Ee.attr)(n,{d:"M0,0 L0,0"}),(0,Ee.classes)(n).add("djs-snap-line"),(0,Ee.append)(t,n),{update:function(t){"number"!=typeof t?(0,Ee.attr)(n,{display:"none"}):"horizontal"===e?(0,Ee.attr)(n,{d:"M-100000,"+t+" L+100000,"+t,display:""}):(0,Ee.attr)(n,{d:"M "+t+",-100000 L "+t+", +100000",display:""})}}},Gb.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},Gb.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()},Gb.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]},Gb.prototype.hide=function(){(0,l.forEach)(this._snapLines,function(e){e.update()})},Gb.prototype.addTargetSnaps=function(e,t,n){var i=this.getSiblings(t,n);(0,l.forEach)(i,function(t){e.add("mid",(0,Db.mid)(t))})},Gb.prototype.getSiblings=function(e,t){return t&&(0,l.filter)(t.children,function(t){return!t.hidden&&!t.labelTarget&&t.host!==e&&t!==e})};var qb=e.is,Kb=e.getDefinition,Yb=me.isCollapsed,Xb=Hb.default,Zb=Db.mid,Qb=Db.isSnapped,Jb=Db.setSnapped,eE=sc.asTRBL,tE=1001,nE=l.forEach,iE=Jv.getCriterionAttachment;function rE(e,t,n){Xb.call(this,e,t),e.on("resize.start",tE+500,function(e){var t=e.context,n=t.shape;qb(Kb(n),"cmmn:PlanFragment")&&!Yb(n)&&(t.minDimensions={width:140,height:120}),qb(n,"cmmn:TextAnnotation")&&(t.minDimensions={width:50,height:30})}),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,function(e){var t=e.context,i=t.target,r=t.shape;i&&!Qb(e)&&function(e,t,i){return"attach"===n.canAttach([e],t,null,i)}(r,i,e)&&function(e,t,n){var i=eE(n),r=iE(e,n);/top/.test(r)?Jb(e,"y",i.top):/bottom/.test(r)&&Jb(e,"y",i.bottom);/left/.test(r)?Jb(e,"x",i.left):/right/.test(r)&&Jb(e,"x",i.right)}(e,0,i)})}u(rE,Xb),rE.$inject=["eventBus","canvas","cmmnRules"];var oE=rE;rE.prototype.addTargetSnaps=function(e,t,n){var i=this.getSiblings(t,n)||[];nE(i,function(t){t.waypoints||e.add("mid",Zb(t))}),nE(t.incoming,function(t){-1===i.indexOf(t.source)&&e.add("mid",Zb(t.source));var n=t.waypoints[0];e.add(t.id+"-docking",n.original||n)}),nE(t.outgoing,function(t){-1===i.indexOf(t.target)&&e.add("mid",Zb(t.target));var n=t.waypoints[t.waypoints.length-1];e.add(t.id+"-docking",n.original||n)})};var aE={__init__:["snapping"],snapping:["type",oE]},sE={};function cE(e,t,n,i){this._canvas=n,this._mouseTracking=i,this._opts=(0,l.assign)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var r=this;t.on("drag.move",function(e){var t=r._toBorderPoint(e);r.startScroll(t)}),t.on(["drag.cleanup"],function(){r.stopScroll()})}function uE(e,t,n){return t<e&&e<n}Object.defineProperty(sE,"__esModule",{value:!0}),sE.default=cE,cE.$inject=["config.autoScroll","eventBus","canvas","mouseTracking"],cE.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),o=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var a=0,s=0,c=0;c<4;c++)uE(o[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(0===c?a=n.scrollStep:1==c?s=n.scrollStep:2==c?a=-n.scrollStep:3==c&&(s=-n.scrollStep));0===a&&0===s||(t.scroll({dx:a,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))},cE.prototype.stopScroll=function(){clearTimeout(this._scrolling)},cE.prototype.setOptions=function(e){this._opts=(0,l.assign)({},this._opts,e)},cE.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=(0,qo.toPoint)(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};var lE={};function dE(e,t){this._eventBus=e,this._canvas=t,this._init()}Object.defineProperty(lE,"__esModule",{value:!0}),lE.default=dE,dE.$inject=["eventBus","canvas"],dE.prototype.getHoverContext=function(){var e=this._canvas.viewbox();return{element:this._hoverElement,point:{x:e.x+Math.round(this._mouseX/e.scale),y:e.y+Math.round(this._mouseY/e.scale)}}},dE.prototype._init=function(){var e=this._eventBus,t=this._canvas.getContainer();this._setMousePosition=(0,l.bind)(this._setMousePosition,this),t.addEventListener("mousemove",this._setMousePosition),e.on("diagram.destroy",function(){t.removeEventListener("mousemove",this._setMousePosition)},this),e.on("element.hover",this._setHoverElement,this)},dE.prototype._setHoverElement=function(e){this._hoverElement=e.element},dE.prototype._setMousePosition=function(e){this._mouseX=e.layerX,this._mouseY=e.layerY};var pE={};Object.defineProperty(pE,"__esModule",{value:!0});var fE=function(e){return e&&e.__esModule?e:{default:e}}(lE);pE.default={__init__:["mouseTracking"],mouseTracking:["type",fE.default]};var hE={};Object.defineProperty(hE,"__esModule",{value:!0});var mE=gE(vu),yE=gE(pE),vE=gE(sE);function gE(e){return e&&e.__esModule?e:{default:e}}hE.default={__depends__:[mE.default,yE.default],__init__:["autoScroll"],autoScroll:["type",vE.default]};var _E={};Object.defineProperty(_E,"__esModule",{value:!0}),_E.SEGMENT_DRAGGER_CLS=_E.BENDPOINT_CLS=void 0,_E.toCanvasCoordinates=function(e,t){var n,i=(0,qo.toPoint)(t),r=e._container.getBoundingClientRect();n={x:r.left,y:r.top};var o=e.viewbox();return{x:o.x+(i.x-n.x)/o.scale,y:o.y+(i.y-n.y)/o.scale}},_E.addBendpoint=function(e,t){var n=(0,Ee.create)("g");(0,Ee.classes)(n).add(xE),(0,Ee.append)(e,n);var i=(0,Ee.create)("circle");(0,Ee.attr)(i,{cx:0,cy:0,r:4}),(0,Ee.classes)(i).add("djs-visual"),(0,Ee.append)(n,i);var r=(0,Ee.create)("circle");(0,Ee.attr)(r,{cx:0,cy:0,r:10}),(0,Ee.classes)(r).add("djs-hit"),(0,Ee.append)(n,r),t&&(0,Ee.classes)(n).add(t);return n},_E.addSegmentDragger=function(e,t,n){var i=(0,Ee.create)("g"),r=(0,Ss.getMidPoint)(t,n),o=(0,Ss.pointsAligned)(t,n);return(0,Ee.append)(e,i),function(e,t,n){var i=(0,Ee.create)("g");(0,Ee.append)(e,i);var r=(0,Ee.create)("rect");(0,Ee.attr)(r,{x:-7,y:-1.5,width:14,height:3}),(0,Ee.classes)(r).add("djs-visual"),(0,Ee.append)(i,r);var o=(0,Ee.create)("rect");(0,Ee.attr)(o,{x:-10,y:-4.5,width:20,height:9}),(0,Ee.classes)(o).add("djs-hit"),(0,Ee.append)(i,o),(0,Ze.rotate)(i,"h"===n?90:0,0,0)}(i,0,o),(0,Ee.classes)(i).add(bE),(0,Ee.classes)(i).add("h"===o?"vertical":"horizontal"),(0,Ze.translate)(i,r.x,r.y),i};var xE=_E.BENDPOINT_CLS="djs-bendpoint",bE=_E.SEGMENT_DRAGGER_CLS="djs-segment-dragger";var EE={};Object.defineProperty(EE,"__esModule",{value:!0}),EE.default=AE;var wE="connect-ok",ME="connect-not-ok",SE="connect-hover",CE="djs-updating",PE="connection.updateWaypoints",RE="connection.reconnectStart",TE="connection.reconnectEnd",kE=Math.round;function AE(e,t,n,i,r,o,a){var s=e.get("connectionDocking",!1);function c(e){r.update("connection",e.connection,e.connectionGfx)}this.start=function(e,t,r,o){var a,s=t.waypoints,c=n.getGraphics(t);a={connection:t,bendpointIndex:r,insert:o,type:o||0!==r?o||r!==s.length-1?PE:TE:RE},i.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:c,context:a}})},t.on("bendpoint.move.start",function(e){var t=e.context,i=t.connection,r=i.waypoints,o=r.slice(),a=t.insert,s=t.bendpointIndex;t.originalWaypoints=r,a&&o.splice(s,0,null),i.waypoints=o,t.draggerGfx=(0,_E.addBendpoint)(n.getLayer("overlays")),(0,Ee.classes)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,CE)}),t.on("bendpoint.move.hover",function(e){var t=e.context;if(t.hover=e.hover,e.hover){n.addMarker(e.hover,SE);var i=t.allowed=o.allowed(t.type,t);i?(n.removeMarker(t.hover,ME),n.addMarker(t.hover,wE),t.target=t.hover):!1===i&&(n.removeMarker(t.hover,wE),n.addMarker(t.hover,ME),t.target=null)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(e){var t=e.context.hover;t&&(n.removeMarker(t,SE),n.removeMarker(t,e.context.target?wE:ME))}),t.on("bendpoint.move.move",function(e){var t,n,i=e.context,r=i.type,o=e.connection;o.waypoints[i.bendpointIndex]={x:e.x,y:e.y},s&&(i.hover&&(r===RE&&(t=i.hover),r===TE&&(n=i.hover)),o.waypoints=s.getCroppedWaypoints(o,t,n)),(0,Ze.translate)(i.draggerGfx,e.x,e.y),c(e)}),t.on(["bendpoint.move.end","bendpoint.move.cancel"],function(e){var t=e.context,i=t.hover,r=t.connection;(0,Ee.remove)(t.draggerGfx),t.newWaypoints=r.waypoints.slice(),r.waypoints=t.originalWaypoints,n.removeMarker(r,CE),i&&(n.removeMarker(i,wE),n.removeMarker(i,ME))}),t.on("bendpoint.move.end",function(e){var t,n=e.context,i=n.newWaypoints,r=n.bendpointIndex,o=i[r],s=n.allowed;if(o.x=kE(o.x),o.y=kE(o.y),s&&n.type===RE)a.reconnectStart(n.connection,n.target,o);else if(s&&n.type===TE)a.reconnectEnd(n.connection,n.target,o);else{if(!1===s||n.type!==PE)return c(e),!1;t={bendpointMove:{insert:e.context.insert,bendpointIndex:r}},a.updateWaypoints(n.connection,function(e){e=e.slice();for(var t,n,i,r=0;e[r];)t=e[r],n=e[r-1],i=e[r+1],0===(0,Ss.pointDistance)(t,i)||(0,Ss.pointsOnLine)(n,i,t)?e.splice(r,1):r++;return e}(i),t)}}),t.on("bendpoint.move.cancel",function(e){c(e)})}AE.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","rules","modeling"];var OE={};Object.defineProperty(OE,"__esModule",{value:!0}),OE.default=DE;var jE=Math.abs,NE=Math.round,IE=10;function DE(e){function t(e,t){if((0,l.isArray)(e)){for(var n=e.length;n--;)if(jE(e[n]-t)<=IE)return e[n]}else{var i=t%(e=+e);if(i<IE)return t-i;if(i>e-IE)return t-i+e}return t}function n(e){if(e.width)return{x:NE(e.width/2+e.x),y:NE(e.height/2+e.y)}}e.on("connectionSegment.move.move",1500,function(e){var i,r,o=function(e){var t=e.snapPoints,i=e.connection,r=i.waypoints,o=e.segmentStart,a=e.segmentStartIndex,s=e.segmentEnd,c=e.segmentEndIndex,u=e.axis;if(t)return t;var d=[r[a-1],o,s,r[c+1]];return a<2&&d.unshift(n(i.source)),c>r.length-3&&d.unshift(n(i.target)),e.snapPoints=t={horizontal:[],vertical:[]},(0,l.forEach)(d,function(e){e&&(e=e.original||e,"y"===u&&t.horizontal.push(e.y),"x"===u&&t.vertical.push(e.x))}),t}(e.context),a=e.x,s=e.y;if(o){var c=a-(i=t(o.vertical,a)),u=s-(r=t(o.horizontal,s));(0,l.assign)(e,{dx:e.dx-c,dy:e.dy-u,x:i,y:r})}}),e.on("bendpoint.move.move",1500,function(e){var i=e.context,r=function(e){var t=e.snapPoints,n=e.connection.waypoints,i=e.bendpointIndex;if(t)return t;var r=[n[i-1],n[i+1]];return e.snapPoints=t={horizontal:[],vertical:[]},(0,l.forEach)(r,function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))}),t}(i),o=i.target,a=o&&n(o),s=e.x,c=e.y;if(r){var u=s-t(a?r.vertical.concat([a.x]):r.vertical,s),d=c-t(a?r.horizontal.concat([a.y]):r.horizontal,c);(0,l.assign)(e,{dx:e.dx-u,dy:e.dy-d,x:e.x-u,y:e.y-d})}})}DE.$inject=["eventBus"];var BE={};Object.defineProperty(BE,"__esModule",{value:!0}),BE.getApproxIntersection=function(e,t){return function(e,t){var n,i;for(n=0;i=e[n];n++)if((0,Ss.pointDistance)(i,t)<=$E)return{point:e[n],bendpoint:!0,index:n};return null}(e,t)||function(e,t){var n,i=(0,LE.default)((c=t,u=$E,l=c.x,d=c.y,[["M",l,d],["m",0,-u],["a",u,u,0,1,1,0,2*u],["a",u,u,0,1,1,0,-2*u],["z"]]),(a=e,s=[],a.forEach(function(e,t){s.push([0===t?"M":"L",e.x,e.y])}),s)),r=i[0],o=i[i.length-1];var a,s;var c,u,l,d;if(!r)return null;if(r!==o)return r.segment2!==o.segment2?(n=FE(r.segment2,o.segment2)-1,{point:e[n],bendpoint:!0,index:n}):{point:{x:zE(r.x+o.x)/2,y:zE(r.y+o.y)/2},index:r.segment2};return{point:{x:zE(r.x),y:zE(r.y)},index:r.segment2}}(e,t)};var LE=function(e){return e&&e.__esModule?e:{default:e}}(ac);var zE=Math.round,FE=Math.max;var $E=10;var HE={};function UE(e,t,n,i,r){function o(e,n){var i=(0,_E.toCanvasCoordinates)(t,n);return(0,BE.getApproxIntersection)(e,i)}function a(e,t){var n=t.waypoints,a=o(n,e);if(a)return!function(e,t,n){var i,r,o,a,s,c,u=e.index,l=e.point;return!(u<=0||e.bendpoint)&&(i=t[u-1],r=t[u],o=(0,Ss.getMidPoint)(i,r),a=(0,Ss.pointsAligned)(i,r),s=Math.abs(l.x-o.x),c=Math.abs(l.y-o.y),a&&s<=n&&c<=n)}(a,n,10)?i.start(e,t,a.index,!a.bendpoint):r.start(e,t,a.index),!0}function s(e,t,i){at.event.bind(e,t,function(e){n.triggerMouseEvent(t,e,i),e.stopPropagation()})}function c(e,n){var i=t.getLayer("overlays"),r=(0,at.query)('.djs-bendpoints[data-element-id="'+(0,Sb.escapeCSS)(e.id)+'"]',i);return!r&&n&&(r=(0,Ee.create)("g"),(0,Ee.attr)(r,{"data-element-id":e.id}),(0,Ee.classes)(r).add("djs-bendpoints"),(0,Ee.append)(i,r),s(r,"mousedown",e),s(r,"click",e),s(r,"dblclick",e)),r}function u(e,t){t.waypoints.forEach(function(t,n){var i=(0,_E.addBendpoint)(e);(0,Ee.append)(e,i),(0,Ze.translate)(i,t.x,t.y)}),(0,_E.addBendpoint)(e,"floating")}function d(e,t){for(var n,i,r=t.waypoints,o=1;o<r.length;o++)n=r[o-1],i=r[o],(0,Ss.pointsAligned)(n,i)&&(0,_E.addSegmentDragger)(e,n,i)}function p(e){var t=c(e);return t||(u(t=c(e,!0),e),d(t,e)),t}function f(e){var t=c(e);t&&(!function(e){(0,l.forEach)((0,at.queryAll)("."+_E.SEGMENT_DRAGGER_CLS,e),function(e){(0,Ee.remove)(e)})}(t),function(e){(0,l.forEach)((0,at.queryAll)("."+_E.BENDPOINT_CLS,e),function(e){(0,Ee.remove)(e)})}(t),d(t,e),u(t,e))}e.on("connection.changed",function(e){f(e.element)}),e.on("connection.remove",function(e){var t=c(e.element);t&&(0,Ee.remove)(t)}),e.on("element.marker.update",function(e){var t,n=e.element;n.waypoints&&(t=p(n),e.add?(0,Ee.classes)(t).add(e.marker):(0,Ee.classes)(t).remove(e.marker))}),e.on("element.mousemove",function(e){var t,n,i,r=e.element,a=r.waypoints;if(a){if(t=c(r,!0),!(n=(0,at.query)(".floating",t)))return;(i=o(a,e.originalEvent))&&(0,Ze.translate)(n,i.point.x,i.point.y)}}),e.on("element.mousedown",function(e){var t=e.originalEvent,n=e.element,i=n.waypoints;if(i)return a(t,n)}),e.on("selection.changed",function(e){var t=e.newSelection[0];t&&t.waypoints&&p(t)}),e.on("element.hover",function(e){var t=e.element;t.waypoints&&(p(t),n.registerEvent(e.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(e){n.unregisterEvent(e.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(e){var t=e.element,n=e.newId;if(t.waypoints){var i=c(t);i&&(0,Ee.attr)(i,{"data-element-id":n})}}),this.addHandles=p,this.updateHandles=f,this.getBendpointsContainer=c}Object.defineProperty(HE,"__esModule",{value:!0}),HE.default=UE,UE.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var WE={};Object.defineProperty(WE,"__esModule",{value:!0}),WE.default=ZE;var VE="connect-hover",GE="djs-updating";function qE(e,t,n){return KE(e,t,e[t]+n)}function KE(e,t,n){return{x:"x"===t?n:e.x,y:"y"===t?n:e.y}}function YE(e){return"x"===e?"y":"x"}function XE(e,t,n){var i,r;return e.original?e.original:(i=(0,sc.getMid)(t),KE(e,r=YE(n),i[r]))}function ZE(e,t,n,i,r,o,a){var s=e.get("connectionDocking",!1);function c(e,t){if(!s)return t;var n,i=e.waypoints;return e.waypoints=t,n=s.getCroppedWaypoints(e),e.waypoints=i,n}function u(e){r.update("connection",e.connection,e.connectionGfx)}function l(e,t,n){var i=e.newWaypoints,r=function(e,t,n,i){var r=Math.max(t[i],n[i]),o=Math.min(t[i],n[i]);return KE(t,i,Math.min(Math.max(o+20,e[i]),r-20))}(n,i[e.segmentStartIndex+t],i[e.segmentEndIndex+t],YE(e.axis));(0,Ze.translate)(e.draggerGfx,r.x,r.y)}this.start=function(e,t,r){var o,a,s,c=n.getGraphics(t),u=r-1,l=r,d=t.waypoints,p=d[u],f=d[l];(a=(0,Ss.pointsAligned)(p,f))&&(s="v"===a?"y":"x",0===u&&(p=XE(p,t.source,s)),l===d.length-1&&(f=XE(f,t.target,s)),o={connection:t,segmentStartIndex:u,segmentEndIndex:l,segmentStart:p,segmentEnd:f,axis:s},i.init(e,{x:(p.x+f.x)/2,y:(p.y+f.y)/2},"connectionSegment.move",{cursor:"x"===s?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:c,context:o}}))},t.on("connectionSegment.move.start",function(e){var t=e.context,i=e.connection,r=n.getLayer("overlays");t.originalWaypoints=i.waypoints.slice(),t.draggerGfx=(0,_E.addSegmentDragger)(r,t.segmentStart,t.segmentEnd),(0,Ee.classes)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,GE)}),t.on("connectionSegment.move.move",function(e){var t,n,i=e.context,r=i.connection,o=i.segmentStartIndex,a=i.segmentEndIndex,s=i.segmentStart,d=i.segmentEnd,p=i.axis,f=i.originalWaypoints.slice(),h=qE(s,p,e["d"+p]),m=qE(d,p,e["d"+p]),y=f.length,v=0;f[o]=h,f[a]=m,o<2&&(t=(0,sc.getOrientation)(r.source,h),1===o?"intersect"===t&&(f.shift(),f[0]=h,v--):"intersect"!==t&&(f.unshift(s),v++)),a>y-3&&(n=(0,sc.getOrientation)(r.target,m),a===y-2?"intersect"===n&&(f.pop(),f[f.length-1]=m):"intersect"!==n&&f.push(d)),i.newWaypoints=r.waypoints=c(r,f),l(i,v,e),i.newSegmentStartIndex=o+v,u(e)}),t.on("connectionSegment.move.hover",function(e){e.context.hover=e.hover,n.addMarker(e.hover,VE)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(e){var t=e.context.hover;t&&n.removeMarker(t,VE)}),t.on("connectionSegment.move.cleanup",function(e){var t=e.context,i=t.connection;t.draggerGfx&&(0,Ee.remove)(t.draggerGfx),n.removeMarker(i,GE)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,u(e)}),t.on("connectionSegment.move.end",function(e){var t=e.context,n=t.connection,i=t.newWaypoints,r=t.newSegmentStartIndex,o=function(e,t){var n=0;return{waypoints:e.filter(function(i,r){return!(0,Ss.pointsOnLine)(e[r-1],e[r+1],i)||(n=r<=t?n-1:n,!1)}),segmentOffset:n}}(i=i.map(function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}}),r),s=c(n,o.waypoints),u=o.segmentOffset,l={segmentMove:{segmentStartIndex:t.segmentStartIndex,newSegmentStartIndex:r+u}};a.updateWaypoints(n,s,l)})}ZE.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","rules","modeling"];var QE={};Object.defineProperty(QE,"__esModule",{value:!0});var JE=ow(vu),ew=ow(Mu),tw=ow(HE),nw=ow(EE),iw=ow(WE),rw=ow(OE);function ow(e){return e&&e.__esModule?e:{default:e}}QE.default={__depends__:[JE.default,ew.default],__init__:["bendpoints","bendpointSnapping"],bendpoints:["type",tw.default],bendpointMove:["type",nw.default],connectionSegmentMove:["type",iw.default],bendpointSnapping:["type",rw.default]};var aw={};Object.defineProperty(aw,"__esModule",{value:!0}),aw.default=dw;var sw={moveSpeed:1,moveSpeedAccelerated:10},cw=1500,uw={ArrowLeft:"left",Left:"left",ArrowUp:"up",Up:"up",ArrowRight:"right",Right:"right",ArrowDown:"down",Down:"down"},lw={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function dw(e,t,n,i){var r=this;this._config=(0,l.assign)({},sw,e||{}),t.addListener(cw,function(e){var n=e.keyEvent,i=uw[n.key];if(i&&!t.isCmd(n)){var o=t.isShift(n);return r.moveSelection(i,o),!0}}),this.moveSelection=function(e,t){var r=i.get();if(r.length){var o=this._config[t?"moveSpeedAccelerated":"moveSpeed"],a=lw[e](o);n.moveElements(r,a)}}}dw.$inject=["config.keyboardMoveSelection","keyboard","modeling","selection"];var pw={};Object.defineProperty(pw,"__esModule",{value:!0});var fw=yw(vl),hw=yw(ga),mw=yw(aw);function yw(e){return e&&e.__esModule?e:{default:e}}pw.default={__depends__:[fw.default,hw.default],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",mw.default]};var vw={};Object.defineProperty(vw,"__esModule",{value:!0}),vw.default=gw;function gw(e,t,n,i){this._dragging=i,this._rules=t;var r=this;e.on("resize.start",function(e){var t,n,i;t=e.context,n=t.resizeConstraints,i=t.minBounds,void 0===n&&(void 0===i&&(i=r.computeMinResizeBox(t)),t.resizeConstraints={min:(0,sc.asTRBL)(i)})}),e.on("resize.move",function(e){var t={x:e.dx,y:e.dy};!function(e,t){var n,i=e.shape,o=e.direction,a=e.resizeConstraints;e.delta=t,n=(0,wy.resizeBounds)(i,o,t),e.newBounds=(0,wy.ensureConstraints)(n,a),e.canExecute=r.canResize(e)}(e.context,t)}),e.on("resize.end",function(e){var t,i,r,o;t=e.context,i=t.shape,r=t.canExecute,o=t.newBounds,r&&(o=(0,sc.roundBounds)(o),n.resizeShape(i,o))})}gw.prototype.canResize=function(e){var t=this._rules,n=(0,l.pick)(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)},gw.prototype.activate=function(e,t,n){var i,r,o=this._dragging;if("string"==typeof n&&(n={direction:n}),!(r=(i=(0,l.assign)({shape:t},n)).direction))throw new Error("must provide a direction (nw|se|ne|sw)");var a={x:/w/.test(r)?t.x:t.x+t.width,y:/n/.test(r)?t.y:t.y+t.height};o.init(e,a,"resize",{autoActivate:!0,cursor:"resize-"+(/nw|se/.test(r)?"nwse":"nesw"),data:{shape:t,context:i}})},gw.prototype.computeMinResizeBox=function(e){var t,n,i=e.shape,r=e.direction;return t=e.minDimensions||{width:10,height:10},n=(0,wy.computeChildrenBBox)(i,e.childrenBoxPadding),(0,wy.getMinResizeBounds)(r,i,t,n)},gw.$inject=["eventBus","rules","modeling","dragging"];var _w={};Object.defineProperty(_w,"__esModule",{value:!0}),_w.default=xw;function xw(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(e){var t=e.newSelection;r.removeResizers(),1===t.length&&(0,l.forEach)(t,(0,l.bind)(r.addResizer,r))}),e.on("shape.changed",function(e){var t=e.element;n.isSelected(t)&&(r.removeResizers(),r.addResizer(t))})}xw.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(t){(0,Zo.isPrimaryButton)(t)&&i.activate(t,e,n)}at.event.bind(t,"mousedown",r),at.event.bind(t,"touchstart",r)},xw.prototype._createResizer=function(e,t,n,i,r){var o=this._getResizersParent(),a=(0,Ee.create)("g");(0,Ee.classes)(a).add("djs-resizer"),(0,Ee.classes)(a).add("djs-resizer-"+e.id),(0,Ee.classes)(a).add("djs-resizer-"+r),(0,Ee.append)(o,a);var s=(0,Ee.create)("rect");(0,Ee.attr)(s,{x:-7,y:-7,width:5,height:5}),(0,Ee.classes)(s).add("djs-resizer-visual"),(0,Ee.append)(a,s);var c=(0,Ee.create)("rect");return(0,Ee.attr)(c,{x:-7,y:-7,width:20,height:20}),(0,Ee.classes)(c).add("djs-resizer-hit"),(0,Ee.append)(a,c),(0,Ze.transform)(a,t,n,i),a},xw.prototype.createResizer=function(e,t){var n,i=(0,sc.asTRBL)(e);n="nw"===t?this._createResizer(e,i.left,i.top,0,t):"ne"===t?this._createResizer(e,i.right,i.top,90,t):"se"===t?this._createResizer(e,i.right,i.bottom,180,t):this._createResizer(e,i.left,i.bottom,270,t),this.makeDraggable(e,n,t)},xw.prototype.addResizer=function(e){this._resize.canResize({shape:e})&&(this.createResizer(e,"nw"),this.createResizer(e,"ne"),this.createResizer(e,"se"),this.createResizer(e,"sw"))},xw.prototype.removeResizers=function(){var e=this._getResizersParent();(0,Ee.clear)(e)},xw.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},xw.$inject=["eventBus","canvas","selection","resize"];var bw={};Object.defineProperty(bw,"__esModule",{value:!0}),bw.default=Sw;var Ew="djs-resizing",ww="resize-not-ok",Mw=500;function Sw(e,t,n){e.on("resize.move",Mw,function(e){var i,r,o,a;i=e.context,r=i.shape,o=i.newBounds,(a=i.frame)||(a=i.frame=n.addFrame(r,t.getDefaultLayer()),t.addMarker(r,Ew)),o.width>5&&(0,Ee.attr)(a,{x:o.x,width:o.width}),o.height>5&&(0,Ee.attr)(a,{y:o.y,height:o.height}),i.canExecute?(0,Ee.classes)(a).remove(ww):(0,Ee.classes)(a).add(ww)}),e.on("resize.cleanup",function(e){var n,i;n=e.context,i=n.shape,n.frame&&(0,Ee.remove)(n.frame),t.removeMarker(i,Ew)})}Sw.$inject=["eventBus","canvas","previewSupport"];var Cw={};Object.defineProperty(Cw,"__esModule",{value:!0});var Pw=jw(Mu),Rw=jw(vu),Tw=jw(cx),kw=jw(vw),Aw=jw(bw),Ow=jw(_w);function jw(e){return e&&e.__esModule?e:{default:e}}Cw.default={__depends__:[Pw.default,Rw.default,Tw.default],__init__:["resize","resizePreview","resizeHandles"],resize:["type",kw.default],resizePreview:["type",Aw.default],resizeHandles:["type",Ow.default]};var Nw={};Object.defineProperty(Nw,"__esModule",{value:!0}),Nw.default=Dw;var Iw={moveSpeed:50,moveSpeedAccelerated:200};function Dw(e,t,n){var i=this;this._config=(0,l.assign)({},Iw,e||{}),t.addListener(function(e){var n=e.keyEvent,r=i._config;if(!t.isCmd(n))return;if(t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],n)){var o,a=t.isShift(n)?r.moveSpeedAccelerated:r.moveSpeed;switch(n.key){case"ArrowLeft":case"Left":o="left";break;case"ArrowUp":case"Up":o="up";break;case"ArrowRight":case"Right":o="right";break;case"ArrowDown":case"Down":o="down"}return i.moveCanvas({speed:a,direction:o}),!0}}),this.moveCanvas=function(e){var t=0,i=0,r=e.speed/Math.min(Math.sqrt(n.viewbox().scale),1);switch(e.direction){case"left":t=r;break;case"up":i=r;break;case"right":t=-r;break;case"down":i=-r}n.scroll({dx:t,dy:i})}}Dw.$inject=["config.keyboardMove","keyboard","canvas"];var Bw={};Object.defineProperty(Bw,"__esModule",{value:!0});var Lw=Fw(vl),zw=Fw(Nw);function Fw(e){return e&&e.__esModule?e:{default:e}}Bw.default={__depends__:[Lw.default],__init__:["keyboardMove"],keyboardMove:["type",zw.default]};var $w={},Hw=$w=function(e,t){if(t||(t=16),void 0===e&&(e=128),e<=0)return"0";for(var n=Math.log(Math.pow(2,e))/Math.log(t),i=2;n===1/0;i*=2)n=Math.log(Math.pow(2,e/i))/Math.log(t)*i;var r=n-Math.floor(n),o="";for(i=0;i<Math.floor(n);i++){o=Math.floor(Math.random()*t).toString(t)+o}if(r){var a=Math.pow(t,r);o=Math.floor(Math.random()*a).toString(t)+o}var s=parseInt(o,t);return s!==1/0&&s>=Math.pow(2,e)?Hw(e,t):o};function Uw(e){if(!(this instanceof Uw))return new Uw(e);e=e||[128,36,1],this._seed=e.length?$w.rack(e[0],e[1],e[2]):e}Hw.rack=function(e,t,n){var i=function(i){var o=0;do{if(o++>10){if(!n)throw new Error("too many ID collisions, use more bits");e+=n}var a=Hw(e,t)}while(Object.hasOwnProperty.call(r,a));return r[a]=i,a},r=i.hats={};return i.get=function(e){return i.hats[e]},i.set=function(e,t){return i.hats[e]=t,i},i.bits=e||128,i.base=t||16,i};var Ww=Uw;Uw.prototype.next=function(e){return this._seed(e||!0)},Uw.prototype.nextPrefixed=function(e,t){var n;do{n=e+this.next(!0)}while(this.assigned(n));return this.claim(n,t),n},Uw.prototype.claim=function(e,t){this._seed.set(e,t||!0)},Uw.prototype.assigned=function(e){return this._seed.get(e)||!1},Uw.prototype.unclaim=function(e){delete this._seed.hats[e]},Uw.prototype.clear=function(){var e,t=this._seed.hats;for(e in t)this.unclaim(e)};var Vw={};function Gw(e){Ba.call(this,e),this.on("import.parse.complete",function(e){e.error||this._collectIds(e.definitions,e.context)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}return u(Gw,Ba),(Vw=Gw).Viewer=Ba,Vw.NavigatedViewer=as,Gw.prototype.createDiagram=function(e){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><cmmn:definitions xmlns:dc="http://www.omg.org/spec/CMMN/20151109/DC" xmlns:di="http://www.omg.org/spec/CMMN/20151109/DI" xmlns:cmmndi="http://www.omg.org/spec/CMMN/20151109/CMMNDI" xmlns:cmmn="http://www.omg.org/spec/CMMN/20151109/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Test" targetNamespace="http://bpmn.io/schema/cmmn"><cmmn:case id="Case_1"><cmmn:casePlanModel id="CasePlanModel_1" name="A CasePlanModel"><cmmn:planItem id="PlanItem_1" definitionRef="Task_1" /><cmmn:task id="Task_1" /></cmmn:casePlanModel></cmmn:case><cmmndi:CMMNDI><cmmndi:CMMNDiagram id="CMMNDiagram_1"><cmmndi:Size width="500" height="500" /><cmmndi:CMMNShape id="DI_CasePlanModel_1" cmmnElementRef="CasePlanModel_1"><dc:Bounds x="114" y="63" width="534" height="389" /><cmmndi:CMMNLabel /></cmmndi:CMMNShape><cmmndi:CMMNShape id="PlanItem_1_di" cmmnElementRef="PlanItem_1"><dc:Bounds x="150" y="96" width="100" height="80" /><cmmndi:CMMNLabel /></cmmndi:CMMNShape></cmmndi:CMMNDiagram></cmmndi:CMMNDI></cmmn:definitions>',e)},Gw.prototype._createModdle=function(e){var t=Ba.prototype._createModdle.call(this,e);return t.ids=new Ww([32,36,1]),t},Gw.prototype._collectIds=function(e,t){var n,i=e.$model.ids;for(n in i.clear(),t.elementsById)i.claim(n,t.elementsById[n])},Gw.prototype._interactionModules=[hE.default,Bw.default,Ka.default,is.default,x_],Gw.prototype._modelingModules=[QE.default,pw.default,sb.default,Cw.default,_c,Qu,sl,bl,od,m_,kx,aE,Ib,vb],Gw.prototype._modules=[].concat(Gw.prototype._modules,Gw.prototype._interactionModules,Gw.prototype._modelingModules),Vw});